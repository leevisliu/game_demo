window.__require=function e(t,n,o){function r(i,c){if(!n[i]){if(!t[i]){var s=i.split("/");if(s=s[s.length-1],!t[s]){var u="function"==typeof __require&&__require;if(!c&&u)return u(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){return r(t[i][1][e]||e)},l,l.exports,e,t,n,o)}return n[i].exports}for(var a="function"==typeof __require&&__require,i=0;i<o.length;i++)r(o[i]);return r}({ProtocolXLCH:[function(e,t,n){"use strict";cc._RF.push(t,"d22canlVnlD0aqVp43/PPSK","ProtocolXLCH");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../../net/ProtocolBase"),a=e("../../../manager/NetManager"),i=e("../../../manager/UIManager"),c=e("../../../Define"),s=e("./XLCHCmd"),u=e("../../../manager/DataManager"),l=function(e){function t(){var t=e.call(this,"game/xlch/pb")||this;return t.cmd=s.XLCHCmd,t.type=c.SocketType.Game,t.pbName="XLCH",t.PLAYER_DATAS=[],t.MY_DATA=[],t.MY_SEAT=0,t.BANKER_POS=-1,t.DingQueCode=-1,t.DingQueCards=[],t.ResetData=function(){t.PLAYER_DATAS=[],t.MY_DATA=[],t.MY_SEAT=0,t.DingQueCode=-1,t.DingQueCards=[]},t}return o(t,e),t.prototype.sendOperReq=function(e,t,n){var o={seat_id:e,oper_type:t,oper_cards:n};this.send(o,"oper_req")},t.prototype.sendPlayerChangeCard=function(e){var t={player_id:u.DataManager.userInfo.userid,cards:e};this.send(t,"player_change_card")},t.prototype.sendPlayerDingQue=function(e){var t={player_id:u.DataManager.userInfo.userid,code:e};this.send(t,"player_ding_que")},t.prototype.dealError=function(e){i.UIManager.showTipsPopup(e.err_msg)},t}(r.default);n.default=l,a.NetManager.protocolCache.ProtocolXLCH=l,cc._RF.pop()},{"../../../Define":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../../net/ProtocolBase":void 0,"./XLCHCmd":"XLCHCmd"}],XLCHCPGArea:[function(e,t,n){"use strict";cc._RF.push(t,"2e565yTs8VOCbBLEujKQhsw","XLCHCPGArea");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../mahjong/MJCPGAreaBase"),i=cc._decorator,c=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t=r([c],t)}(a.default));n.default=s,cc._RF.pop()},{"../../mahjong/MJCPGAreaBase":void 0}],XLCHChangeTips:[function(e,t,n){"use strict";cc._RF.push(t,"5d7d4onZTZO2L4s4ZUNKhIS","XLCHChangeTips");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../common/log/LogWrap"),i=e("../../../common/utils/Utils"),c=e("../../../manager/EventManager"),s=e("../../../manager/NetManager"),u=e("../../../manager/UIManager"),l=e("../../mahjong/MJDefine"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view_choose=null,t.btn_change_confirm=null,t.view_tips=null,t.change_text=null,t.changeWay=[],t.card=[],t.changeCard=[],t.node_card=[],t}return o(t,e),t.prototype.onLoad=function(){var e=this;i.default.addClickEventEND(this.btn_change_confirm,this.onChangeConfirmEvent.bind(this)),c.EventManager.on(this,l.XLCHEventDef.PushChangeCard,function(t){if(a.LogWrap.log("\u6536\u5230\u63a8\u5165\u6362\u724c\u7684\u724c\u4e8b\u4ef6",t),t.is_increase)e.changeCard.push(t.cardValue),e.node_card.push(t.card);else{var n=e.changeCard.indexOf(t.cardValue);-1!=n&&(e.changeCard.splice(n,1),e.node_card.splice(n,1))}})},t.prototype.onChangeConfirmEvent=function(){3==this.changeCard.length?s.NetManager.getGameProtocol().sendPlayerChangeCard(this.changeCard):u.UIManager.showTips("\u8bf7\u9009\u62e9\u4e09\u5f20\u724c")},t.prototype.showChangeTips=function(e){this.view_choose.active=e,this.changeCard=[],this.changeWay.forEach(function(e){e.active=!1})},t.prototype.showChangeWay=function(e){this.changeWay[e-1].active=!0;var t="\u672c\u5c40"+(1==e?"\u987a\u65f6\u9488":2==e?"\u9006\u65f6\u9488":"\u5bf9\u5bb6")+"\u6362\u724c";this.change_text.string=t,this.view_tips.active=!0},t.prototype.hideChangeWay=function(){this.view_tips.active=!1},t.prototype.showCard=function(e){this.card[e].active=!0},t.prototype.hideCard=function(){this.card.forEach(function(e){e.active=!1})},t.prototype.resetView=function(){this.hideCard(),this.hideChangeWay,this.showChangeTips(!1)},t.prototype.onDestroy=function(){c.EventManager.off(this)},r([d(cc.Node)],t.prototype,"view_choose",void 0),r([d(cc.Node)],t.prototype,"btn_change_confirm",void 0),r([d(cc.Node)],t.prototype,"view_tips",void 0),r([d(cc.Label)],t.prototype,"change_text",void 0),r([d(cc.Node)],t.prototype,"changeWay",void 0),r([d(cc.Node)],t.prototype,"card",void 0),t=r([h],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../../../common/log/LogWrap":void 0,"../../../common/utils/Utils":void 0,"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../mahjong/MJDefine":void 0}],XLCHCmd:[function(e,t,n){"use strict";cc._RF.push(t,"10ed4zUwPdIloACVFSIxMWy","XLCHCmd"),Object.defineProperty(n,"__esModule",{value:!0}),n.XLCHCmd="226_0",n.ProtocolXLCHCmd={GameStartNotify:n.XLCHCmd+"_game_start_notify",SendBankNotify:n.XLCHCmd+"_send_bank_notify",SendCardsNotify:n.XLCHCmd+"_send_cards_notify",TurnOperNotify:n.XLCHCmd+"_turn_oper_notify",PlayerCanOperNotify:n.XLCHCmd+"_can_oper_notify",OperRes:n.XLCHCmd+"_oper_res",GameConcludeNotify:n.XLCHCmd+"_game_conclude_notify",GameReconnectInfo:n.XLCHCmd+"_game_reconnect_info",GetCardNotify:n.XLCHCmd+"_get_card_notify",CanTingNotify:n.XLCHCmd+"_can_ting_notify",SendTingNotify:n.XLCHCmd+"_send_ting_notify",ChangeCardNotify:n.XLCHCmd+"_change_card_notify",PlayerChangeCardRes:n.XLCHCmd+"_player_change_card_res",SendChangeCard:n.XLCHCmd+"_send_change_card",DingQueNotify:n.XLCHCmd+"_ding_que_notify",PlayerDingQueRes:n.XLCHCmd+"_player_ding_que_res",GuaFengXiaYuNotify:n.XLCHCmd+"_guafeng_xiayu_notify",HujiaoNotify:n.XLCHCmd+"_hujiao_notify",LiujuNotify:n.XLCHCmd+"_liu_ju_notify",DingQueRes:n.XLCHCmd+"_ding_que_res"},cc._RF.pop()},{}],XLCHDefine:[function(e,t,n){"use strict";var o,r,a,i;cc._RF.push(t,"791a5BtVvtGyb9MEZaqNlMS","XLCHDefine"),Object.defineProperty(n,"__esModule",{value:!0}),n.XLCHDefine={GAME_PLAYER:4},n.XLCHEvent={CloseResultView:"close_result_view",ResultClickStart:"result_click_start"},function(e){e[e.ziMo=1]="ziMo",e[e.beiZimo=2]="beiZimo",e[e.dianPao=3]="dianPao",e[e.beiDianPao=4]="beiDianPao",e[e.buGang=5]="buGang",e[e.beiBuGang=6]="beiBuGang",e[e.pengGang=7]="pengGang",e[e.beiPengGang=8]="beiPengGang",e[e.anGang=9]="anGang",e[e.beiAnGang=10]="beiAnGang"}(a=n.concludeType||(n.concludeType={})),n.concludeStr=((o={})[a.ziMo]="\u81ea\u6478",o[a.beiZimo]="\u88ab\u81ea\u6478",o[a.dianPao]="\u70b9\u70ae",o[a.beiDianPao]="\u88ab\u70b9\u70ae",o[a.buGang]="\u8865\u6760",o[a.beiBuGang]="\u88ab\u8865\u6760",o[a.pengGang]="\u78b0\u6760",o[a.beiPengGang]="\u88ab\u78b0\u6760",o[a.anGang]="\u6697\u6760",o[a.beiAnGang]="\u88ab\u6697\u6760",o),function(e){e[e.pingHu=1]="pingHu",e[e.duiduiHu=2]="duiduiHu",e[e.qingYiSe=3]="qingYiSe",e[e.daiJiuYao=4]="daiJiuYao",e[e.qiDui=5]="qiDui",e[e.jinDiaoDiao=6]="jinDiaoDiao",e[e.qingDui=7]="qingDui",e[e.longQiDui=8]="longQiDui",e[e.qingQiDui=9]="qingQiDui",e[e.qingJiuYao=10]="qingJiuYao",e[e.qingJinDiaoDiao=11]="qingJinDiaoDiao",e[e.qingLongQiDui=12]="qingLongQiDui",e[e.shiBaLuoHan=13]="shiBaLuoHan",e[e.qingShiBaLuoHan=14]="qingShiBaLuoHan",e[e.ziMo=15]="ziMo",e[e.gangHua=16]="gangHua",e[e.gangPao=17]="gangPao",e[e.gangHu=18]="gangHu",e[e.gen=19]="gen",e[e.tianHu=20]="tianHu",e[e.diHu=21]="diHu"}(i=n.FanXingType||(n.FanXingType={})),n.FanXingStr=((r={})[i.pingHu]="\u5e73\u80e1",r[i.duiduiHu]="\u5bf9\u5bf9\u80e1",r[i.qingYiSe]="\u6e05\u4e00\u8272",r[i.daiJiuYao]="\u5927\u4e5d\u5e7a",r[i.qiDui]="\u4e03\u5bf9",r[i.jinDiaoDiao]="\u91d1\u9493\u9493",r[i.qingDui]="\u6e05\u5bf9",r[i.longQiDui]="\u9f99\u4e03\u5bf9",r[i.qingQiDui]="\u6e05\u4e03\u5bf9",r[i.qingJiuYao]="\u6e05\u4e5d\u5e7a",r[i.qingJinDiaoDiao]="\u6e05\u91d1\u9493\u9493",r[i.qingLongQiDui]="\u6e05\u9f99\u4e03\u5bf9",r[i.shiBaLuoHan]="\u5341\u516b\u7f57\u6c49",r[i.qingShiBaLuoHan]="\u6e05\u5341\u516b\u7f57\u6c49",r[i.ziMo]="\u81ea\u6478",r[i.gangHua]="\u6760\u4e0a\u5f00\u82b1",r[i.gangPao]="\u6760\u4e0a\u70ae",r[i.gangHu]="\u6760\u4e0a\u80e1",r[i.gen]="\u6839",r[i.tianHu]="\u5929\u80e1",r[i.diHu]="\u5730\u80e1",r),cc._RF.pop()},{}],XLCHDingQue:[function(e,t,n){"use strict";cc._RF.push(t,"f3aadKGHfpM2IZXfol3brp/","XLCHDingQue");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../common/utils/Utils"),i=e("../../../manager/NetManager"),c=cc._decorator,s=c.ccclass,u=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view_dingque=null,t.btn_dingque=[],t}return o(t,e),t.prototype.start=function(){var e=this;this.btn_dingque.forEach(function(t,n){var o=n+1;a.default.addClickEventEND(t,e.onClickDingQueEvent.bind(e),o)})},t.prototype.onClickDingQueEvent=function(e,t){i.NetManager.getGameProtocol().sendPlayerDingQue(t),this.view_dingque.active=!1},t.prototype.showDingQueView=function(e){this.view_dingque.active=e},r([u(cc.Node)],t.prototype,"view_dingque",void 0),r([u(cc.Node)],t.prototype,"btn_dingque",void 0),t=r([s],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0}],XLCHDot:[function(e,t,n){"use strict";cc._RF.push(t,"a201bFkuYVMHbxBI6j645NT","XLCHDot");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,i=a.ccclass,c=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spr_text=null,t.dingque_frame=null,t.change_frame=null,t}return o(t,e),t.prototype.showDot=function(e){this.spr_text.spriteFrame=1==e?this.change_frame:this.dingque_frame},r([c(cc.Sprite)],t.prototype,"spr_text",void 0),r([c(cc.SpriteFrame)],t.prototype,"dingque_frame",void 0),r([c(cc.SpriteFrame)],t.prototype,"change_frame",void 0),t=r([i],t)}(cc.Component);n.default=s,cc._RF.pop()},{}],XLCHGameScene:[function(e,t,n){"use strict";cc._RF.push(t,"501e8CKUe5E84KZ3IndXZMg","XLCHGameScene");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./XLCHGameView"),i=e("../../../manager/EventManager"),c=e("../../../net/NetCmd"),s=e("../../../common/log/LogWrap"),u=e("../../../manager/UIManager"),l=e("../protocol/XLCHCmd"),p=e("../../../Define"),h=cc._decorator,d=h.ccclass,f=h.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameView=null,t}return o(t,e),t.prototype.onLoad=function(){this.GameView.GameScene=this,this.initEvent()},t.prototype.onDestroy=function(){i.EventManager.off(this)},t.prototype.initEvent=function(){i.EventManager.on(this,c.ProtocolGameCmd.GameLoginResp,this.onGameLoginResp.bind(this)),i.EventManager.on(this,c.ProtocolGameCmd.MatchResp,this.onMatchResp.bind(this)),i.EventManager.on(this,c.ProtocolGameCmd.CancelMatchResp,this.onCancelMatchResp.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.GameStartNotify,this.onGameStartNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.SendBankNotify,this.onSendBankNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.SendCardsNotify,this.onSendCardsNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.TurnOperNotify,this.onTurnOperNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.PlayerCanOperNotify,this.onPlayerCanOperNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.OperRes,this.OperRes.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.GameConcludeNotify,this.onGameConcludeNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.GameReconnectInfo,this.onGameReconnectInfo.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.GetCardNotify,this.onGetCardNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.CanTingNotify,this.onCanTingNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.SendTingNotify,this.onSendTingNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.ChangeCardNotify,this.onChangeCardNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.PlayerChangeCardRes,this.onPlayerChangeCardRes.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.SendChangeCard,this.onSendChangeCard.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.DingQueNotify,this.onDingQueNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.PlayerDingQueRes,this.onPlayerDingQueRes.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.GuaFengXiaYuNotify,this.onGuaFengXiaYuNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.HujiaoNotify,this.onHujiaoNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.LiujuNotify,this.onLiujuNotify.bind(this)),i.EventManager.on(this,l.ProtocolXLCHCmd.DingQueRes,this.onDingQueRes.bind(this)),i.EventManager.on(this,p.EventDef.UpdateUserGold,this.onUpdateUserScore.bind(this))},t.prototype.onGameLoginResp=function(e){s.LogWrap.log("\u6548\u9a8c\u6210\u529f====>",e),this.GameView.resetGameView(),this.GameView.initUserInfo(),0==e.state&&this.GameView.XLCHTable.showReady(!0)},t.prototype.onMatchResp=function(e){1==e.status?(s.LogWrap.log("\u5339\u914d\u6210\u529f====>",e),u.UIManager.hideLoading()):2==e.status||4==e.status?(u.UIManager.showTips(2==e.status?"\u5339\u914d\u8d85\u65f6":"\u91d1\u5e01\u4e0d\u8db3"),this.GameView.XLCHTable.showReady(!0),u.UIManager.hideLoading()):3==e.status?(s.LogWrap.log("\u5339\u914d\u88ab\u53d6\u6d88"),u.UIManager.hideLoading()):100==e.status&&(u.UIManager.showTips("\u5339\u914d\u5931\u8d25"),this.GameView.XLCHTable.showReady(!0),u.UIManager.hideLoading())},t.prototype.onCancelMatchResp=function(e){u.UIManager.showTips(e.ok?"\u53d6\u6d88\u5339\u914d\u6210\u529f":"\u53d6\u6d88\u5339\u914d\u5931\u8d25"),e.ok&&this.GameView.XLCHTable.showReady(!0)},t.prototype.onGameStartNotify=function(e){s.LogWrap.log("%c \u6e38\u620f\u5f00\u59cb","font-size:30px;color:red;",e),this.GameView.onSubGameStart(e)},t.prototype.onSendBankNotify=function(e){this.GameView.onSubConfirmBank(e)},t.prototype.onSendCardsNotify=function(e){s.LogWrap.log("%c \u53d1\u624b\u724c\u6d88\u606f","font-size:30px;color:red;",e),this.GameView.onSubSendCards(e)},t.prototype.onTurnOperNotify=function(e){this.GameView.onSubTurnOper(e)},t.prototype.onPlayerCanOperNotify=function(e){s.LogWrap.log("%c \u901a\u77e5\u5403\u78b0\u6760\u64cd\u4f5c\u6d88\u606f","color:#BE0834",e),this.GameView.onSubPlayerCanOper(e)},t.prototype.OperRes=function(e){s.LogWrap.log("%c \u64cd\u4f5c\u56de\u5e94","color:#75E479;font-size:26px;",e),this.GameView.onSubPlayerOper(e)},t.prototype.onGameConcludeNotify=function(e){var t=this;s.LogWrap.log("%c \u7ed3\u7b97\u56de\u5e94","color:#88C96A;font-size:26px;",e),setTimeout(function(){t.GameView.onSubGameEnd(e)},200)},t.prototype.onGameReconnectInfo=function(e){s.LogWrap.log("%c \u91cd\u8fde\u52a0\u5165\u623f\u95f4\u56de\u5e94","color:#88C96A;font-size:26px;",e),this.GameView.onSubGameReconnect(e)},t.prototype.onGetCardNotify=function(e){s.LogWrap.log("\u83b7\u53d6\u624b\u724c\u6d88\u606f",e),this.GameView.onSubGetCard(e)},t.prototype.onCanTingNotify=function(e){s.LogWrap.log("%c \u53ef\u4ee5\u542c\u724c\u56de\u5e94","font-size:30px;color:red",e),this.GameView.onSubCanTing(e)},t.prototype.onSendTingNotify=function(e){s.LogWrap.log("%c \u901a\u77e5\u73a9\u5bb6\u8fdb\u5165\u542c\u724c",e),this.GameView.onSendTingNotify(e)},t.prototype.onChangeCardNotify=function(e){s.LogWrap.log("%c \u901a\u77e5\u73a9\u5bb6\u6362\u4e09\u5f20\u73af\u8282","font-size:28px;color:#1BBB35",e),this.GameView.onChangeCardNotify(e)},t.prototype.onPlayerChangeCardRes=function(e){s.LogWrap.log("%c \u73a9\u5bb6\u6362\u4e09\u5f20\u6d88\u606f\u8fd4\u56de",e),this.GameView.onPlayerChangeCardRes(e)},t.prototype.onSendChangeCard=function(e){s.LogWrap.log("%c \u670d\u52a1\u5668\u53d1\u9001\u6362\u724c\u6d88\u606f",e),this.GameView.onSendChangeCardResult(e)},t.prototype.onDingQueNotify=function(e){s.LogWrap.log("%c \u901a\u77e5\u73a9\u5bb6\u5b9a\u7f3a\u73af\u8282",e),this.GameView.onDingQueNotify(e)},t.prototype.onPlayerDingQueRes=function(e){s.LogWrap.err("\u670d\u52a1\u5668\u5c4f\u853d\u4e86, \u4e0d\u5e94\u8be5\u6536\u5230!!!!!"),this.GameView.onPlayerDingQueRes(e)},t.prototype.onDingQueRes=function(e){s.LogWrap.log("%c \u6240\u6709\u73a9\u5bb6\u5b9a\u7f3a\u6d88\u606f\u8fd4\u56de",e),this.GameView.onPlayerDingQueRes(e)},t.prototype.onGuaFengXiaYuNotify=function(e){s.LogWrap.log("%c \u522e\u98ce\u6d88\u606f\u901a\u77e5",e),this.GameView.onGuaFengXiaYuNotify(e)},t.prototype.onHujiaoNotify=function(e){s.LogWrap.log("%c \u547c\u53eb\u8f6c\u79fb\u6d88\u606f\u901a\u77e5",e),this.GameView.onHujiaoNotify(e)},t.prototype.onLiujuNotify=function(e){s.LogWrap.log("%c \u6d41\u5c40\u65f6\u6d88\u606f\u901a\u77e5",e),this.GameView.onLiujuNotify(e)},t.prototype.onUpdateUserScore=function(){this.GameView.onUpdateUserScore()},r([f(a.default)],t.prototype,"GameView",void 0),t=r([d],t)}(cc.Component);n.default=g,cc._RF.pop()},{"../../../Define":void 0,"../../../common/log/LogWrap":void 0,"../../../manager/EventManager":void 0,"../../../manager/UIManager":void 0,"../../../net/NetCmd":void 0,"../protocol/XLCHCmd":"XLCHCmd","./XLCHGameView":"XLCHGameView"}],XLCHGameView:[function(e,t,n){"use strict";cc._RF.push(t,"5606baDQvVCh4uw8SAlQX7d","XLCHGameView");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../../manager/UIManager"),s=e("../../../manager/NetManager"),u=e("../../../common/utils/Utils"),l=e("../../../manager/DataManager"),p=e("./XLCHPlayer"),h=e("./XLCHTool"),d=e("./XLCHOper"),f=e("./XLCHTable"),g=e("../../../manager/AudioManager"),y=e("./XLCHTop"),C=e("./XLCHHandArea"),v=e("../../mahjong/MJData"),_=e("./XLCHChangeTips"),m=e("./XLCHDingQue"),L=e("../../../common/log/LogWrap"),H=e("../../../manager/EventManager"),M=e("../../mahjong/MJDefine"),b=e("../../../manager/ResManager"),w=e("./XLCHOutArea"),X=e("./XLCHCPGArea"),O=e("./XLCHShowArea"),P=e("../../mahjong/MJOutEffect"),D=e("./XLCHTingTipsView"),T=e("../XLCHDefine"),A=e("./XLCHHuArea"),R=cc._decorator,S=R.ccclass,G=R.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.XLCHPlayer=[],t.XLCHHandArea=[],t.XLCHCPGArea=[],t.XLCHOutArea=[],t.XLCHShowArea=[],t.XLCHHuArea=[],t.XLCHTop=null,t.XLCHTable=null,t.XLCHOper=null,t.XLCHTingTipsView=null,t.XLCHChangeTips=null,t.XLCHDingQue=null,t.XLCHOutEffect=null,t.user_spine=[],t.ljframe=[],t.hujiaoFrame=null,t.xlch_arrow=null,t.GameScene=null,t.lastOutCard=null,t.lastOutPos=null,t.tingStateReady=!1,t.tingStateRun=!1,t.isStartGame=!1,t}return o(t,e),t.prototype.onLoad=function(){g.AudioManager.playGameBGM("bgm"),this.XLCHTable.GameView=this,this.XLCHOper.GameView=this,this.initGameEvent()},t.prototype.initGameEvent=function(){var e=this;H.EventManager.on(this,M.MJEventDef.MjShootEvent,function(e){L.LogWrap.log("\u53d1\u9001\u6253\u724c\u64cd\u4f5c",e);var t=s.NetManager.getGameProtocol().MY_SEAT,n=M.MJOperType.Shoot,o=e;s.NetManager.getGameProtocol().sendOperReq(t,n,o)}),H.EventManager.on(this,M.MJEventDef.MjChiEvent,function(e){L.LogWrap.log("\u53d1\u9001\u5403\u724c\u64cd\u4f5c",e.cards);var t=s.NetManager.getGameProtocol().MY_SEAT,n=M.MJOperType.Chi,o=e.cards;s.NetManager.getGameProtocol().sendOperReq(t,n,o)}),H.EventManager.on(this,M.MJEventDef.MjPengEvent,function(e){L.LogWrap.log("\u53d1\u9001\u78b0\u724c\u64cd\u4f5c",e);var t=s.NetManager.getGameProtocol().MY_SEAT,n=M.MJOperType.Peng,o=e;s.NetManager.getGameProtocol().sendOperReq(t,n,o)}),H.EventManager.on(this,M.MJEventDef.MjGangEvent,function(e){var t=e.cards;L.LogWrap.log("\u53d1\u9001\u6760\u724c\u64cd\u4f5c",t);var n=s.NetManager.getGameProtocol().MY_SEAT,o=e.oper_type;L.LogWrap.log("\u6760\u7684\u7c7b\u578b\u4e3a",o);var r=t;s.NetManager.getGameProtocol().sendOperReq(n,o,r)}),H.EventManager.on(this,M.MJEventDef.MjHuEvent,function(e){var t=e.cards;L.LogWrap.log("\u53d1\u9001\u80e1\u724c\u64cd\u4f5c",t);var n=s.NetManager.getGameProtocol().MY_SEAT,o=e.oper_type;L.LogWrap.log("\u80e1\u7684\u7c7b\u578b\u4e3a",o);var r=t;s.NetManager.getGameProtocol().sendOperReq(n,o,r)}),H.EventManager.on(this,M.MJEventDef.MjTingEvent,function(e){L.LogWrap.log("\u53d1\u9001\u542c\u724c\u64cd\u4f5c");var t=s.NetManager.getGameProtocol().MY_SEAT,n=M.MJOperType.Ting;s.NetManager.getGameProtocol().sendOperReq(t,n,[])}),H.EventManager.on(this,M.MJEventDef.MjCheckEvent,function(e){L.LogWrap.log("\u53d1\u9001\u8fc7\u724c\u64cd\u4f5c");var t=s.NetManager.getGameProtocol().MY_SEAT,n=M.MJOperType.Check;s.NetManager.getGameProtocol().sendOperReq(t,n,[])}),H.EventManager.on(this,M.MJEventDef.MjBrightEvent,function(t){if(null==t)e.XLCHOutArea.forEach(function(e){e.hideCardBright()});else{var n=t.cardValue;e.XLCHOutArea.forEach(function(e){e.addCardBright(n)})}}),H.EventManager.on(this,M.MJEventDef.TingTipsEvent,function(t){if(null!=t)for(var n=v.MJData.tingCombo,o=0;o<n.length;o++){var r=n[o];if(r.out_card==t.cardValue){var a=r.ting_cards;e.XLCHTingTipsView.showTingTipsView(a);break}e.XLCHTingTipsView.hideTingTipsView()}else e.XLCHTingTipsView.hideTingTipsView()}),H.EventManager.on(this,T.XLCHEvent.ResultClickStart,function(){e.XLCHTable.onClickStartEvent()})},t.prototype.onDestroy=function(){H.EventManager.off(this)},t.prototype.resetGameView=function(){this.XLCHHandArea[0].hideMJGrey(),this.XLCHHandArea[0].removeArrowTing(),this.XLCHPlayer.forEach(function(e){e.initUser()}),this.XLCHHandArea.forEach(function(e){e.removeAllHand()}),this.XLCHOutArea.forEach(function(e){e.removeAllOut()}),this.XLCHCPGArea.forEach(function(e){e.clearCPGMJ()}),this.XLCHShowArea.forEach(function(e){e.removeMingCard()}),this.XLCHHuArea.forEach(function(e){e.removeCard()}),this.XLCHChangeTips.resetView(),this.XLCHDingQue.showDingQueView(!1),this.XLCHTable.resetClockDi(),this.XLCHOper.resetView(),this.XLCHOper.hideOption(),this.XLCHOper.showBtnHuList(!1),this.XLCHTop.resetView(),H.EventManager.emit(T.XLCHEvent.CloseResultView),this.initUserInfo(),s.NetManager.getGameProtocol().ResetData(),v.MJData.ResetData(),this.tingStateReady=!1,this.tingStateRun=!1,this.hideShotArrow(),this.XLCHTingTipsView.hideTingTipsView()},t.prototype.initUserInfo=function(){var e={username:u.default.getSubStringLengTxt(l.DataManager.userInfo.nickname)||u.default.getReplaceStrToStar(l.DataManager.userInfo.userid),gold:l.DataManager.userInfo.gold,headimg_id:l.DataManager.userInfo.headimgurl};this.XLCHPlayer[0].setUserInfo(e)},t.prototype.hideShotArrow=function(){this.xlch_arrow.stopAllActions(),this.xlch_arrow.active=!1},t.prototype.onSubGameReconnect=function(e){var t=this;this.resetGameView(),this.XLCHTable.showReady(!1),s.NetManager.getGameProtocol().PLAYER_DATAS=e.player_list;for(var n=0;n<e.player_list.length;n++){var o=e.player_list[n];o.player_id==l.DataManager.userInfo.userid&&(s.NetManager.getGameProtocol().MY_DATA=o,s.NetManager.getGameProtocol().MY_SEAT=o.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",o))}s.NetManager.getGameProtocol().PLAYER_DATAS.forEach(function(e){var n=h.default.getLocalIndex(e.seat_id);t.XLCHPlayer[n].setUserInfo(e)});var r=e.room_info;this.XLCHTable.setLimitBetNum(r.room_base_note),this.XLCHTable.resetClockDi();var a=e.windPos,i=(1-a+4)%4;this.XLCHTable.setClockDi(a,i);var c=e.oper_seat_id;if(0!=c){var u=h.default.getLocalIndex(c);v.MJData.turnMeOperate=0==u,this.XLCHTable.showArrowLight(u)}var p=e.bankUser_seat_id,d=h.default.getLocalIndex(p);v.MJData.bankerPos=d,this.XLCHPlayer[d].setBankerIcon(!0);var f=e.last_outcard_seat_id,g=h.default.getLocalIndex(f),y=e.player_combos,C=function(e){var n=y[e].seat_id,o=h.default.getLocalIndex(n);y[e].combos.forEach(function(e){var r=e.oper_type,a=e.cards,i=e.oper_seat_id,c=h.default.getDir(n,i);t.XLCHCPGArea[o].createCPGMJ(r,a,c)}),y[e].outCards.forEach(function(e){e>0&&t.XLCHOutArea[o].createOutMJ(e),o==g&&e>0&&t.XLCHOutArea[o].showShotArrow()})};for(n=0;n<y.length;n++)C(n);var _=e.left_card;this.XLCHTop.setRemainCard(_);var m=e.handCards;v.MJData.userCardArr=m,e.player_handcards_nums.forEach(function(e,n){if(0!=e){var o=n+1,r=h.default.getLocalIndex(o);v.MJData.handCardNum[r]=e,t.XLCHHandArea[r].createHandMJ(e)}}),h.default.sortCardList(v.MJData.userCardArr),this.XLCHHandArea[0].setHandValue();var H=e.combos;null!=H&&this.onSubPlayerCanOper(H),e.code.forEach(function(e,n){var o=n+1,r=h.default.getLocalIndex(o);0!=e&&(t.XLCHPlayer[r].setDingQueIcon(e),0==r&&(s.NetManager.getGameProtocol().DingQueCode=e,h.default.sortCardList(v.MJData.userCardArr),L.LogWrap.log("\u6700\u65b0\u5b9a\u7f3a\u540e\u7684\u724c\u578b\u6570\u636e",v.MJData.userCardArr),t.XLCHHandArea[0].setHandValue(),t.XLCHHandArea[0].setHandMJGrey(s.NetManager.getGameProtocol().DingQueCards,!1)))});var M=e.gameStatus,b=e.playerStatus;6==M?(v.MJData.MultipleHandClick=!0,this.XLCHChangeTips.showChangeTips(!0),b.forEach(function(n,o){var r=o+1,a=h.default.getLocalIndex(r);if(2==n){if(0==a){var i=e.cards;t.XLCHHandArea[0].setBounceMJ(i)}}else 3==n&&(t.XLCHChangeTips.showCard(a),0==a&&(v.MJData.MultipleHandClick=!1,t.XLCHChangeTips.showChangeTips(!1)));t.XLCHPlayer[a].showChangeDot(2==n)})):7==M&&(this.XLCHChangeTips.resetView(),b.forEach(function(e,n){var o=n+1,r=h.default.getLocalIndex(o);t.XLCHPlayer[r].showDingQueDot(!0),0==r&&t.XLCHDingQue.showDingQueView(4==e)})),e.playerTingStatus.forEach(function(e,n){var o=h.default.getLocalIndex(n+1);2==e&&t.XLCHPlayer[o].setTingIcon(!0),0==o&&(1==e?(t.tingStateReady=!0,t.XLCHOper.hideOption(),t.XLCHOper.showOption("guo")):2==e?(t.tingStateRun=!0,t.XLCHHandArea[0].setMJGrey([])):3==e&&t.XLCHOper.showOption("ting"))});var w=e.ting_combo;if(null!=w&&0!=w.length){v.MJData.tingCombo=w;var X=[];for(n=0;n<w.length;n++){var O=w[n].out_card;X.push(O),this.XLCHHandArea[0].addArrowTing(O)}this.tingStateReady&&this.XLCHHandArea[0].setMJGrey(X)}var P=e.player_ting_cards;null!=P&&0!=P.length&&(v.MJData.HuCardList=P,this.XLCHOper.showBtnHuList(!0)),e.huCardsArry.forEach(function(e){var n=h.default.getLocalIndex(e.seat_id);e.hucard.forEach(function(e){t.XLCHHuArea[n].createHuMJ(e)})});var D=e.leftTime;this.XLCHTable.setClockTime(D),this.isStartGame=!0},t.prototype.onSubGameStart=function(e){var t=this;c.UIManager.hideLoading(),this.isStartGame=!0,this.resetGameView(),this.XLCHTable.showReady(!1),s.NetManager.getGameProtocol().PLAYER_DATAS=e.player_list;for(var n=0;n<e.player_list.length;n++){var o=e.player_list[n];o.player_id==l.DataManager.userInfo.userid&&(s.NetManager.getGameProtocol().MY_DATA=o,s.NetManager.getGameProtocol().MY_SEAT=o.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",o))}s.NetManager.getGameProtocol().PLAYER_DATAS.forEach(function(e){var n=h.default.getLocalIndex(e.seat_id);t.XLCHPlayer[n].setUserInfo(e)});var r=e.room_info;this.XLCHTable.setLimitBetNum(r.room_base_note),this.XLCHTable.resetClockDi()},t.prototype.onSubConfirmBank=function(e){var t=e.bankUser_seat_id,n=h.default.getLocalIndex(t);v.MJData.bankerPos=n,this.XLCHPlayer[n].setBankerIcon(!0);var o=e.windPos,r=(1-o+4)%4;this.XLCHTable.setClockDi(o,r)},t.prototype.onSubSendCards=function(e){var t=e.cards;this.XLCHHandArea.forEach(function(e,t){v.MJData.handCardNum[t]=13,e.createHandMJ(13)}),v.MJData.userCardArr=t,h.default.sortCardList(v.MJData.userCardArr),this.XLCHHandArea[0].setHandValue(),this.XLCHHandArea[0].hideMJGrey();var n=e.left_card;this.XLCHTop.setRemainCard(n),g.AudioManager.playGameSFX("fapai")},t.prototype.onChangeCardNotify=function(e){v.MJData.MultipleHandClick=!0,this.XLCHChangeTips.showChangeTips(!0);var t=e.cards;this.XLCHHandArea[0].setBounceMJ(t),this.XLCHPlayer.forEach(function(e){e.showChangeDot(!0)}),this.XLCHTable.setClockTime(e.time_out)},t.prototype.onPlayerChangeCardRes=function(e){var t=h.default.getLocalIndex(e.seat_id),n=e.code;0==t&&(0==n?(this.XLCHChangeTips.node_card.forEach(function(e){e.active=!1}),v.MJData.MultipleHandClick=!1,this.XLCHChangeTips.showChangeTips(!1)):1==n&&(c.UIManager.showTips("\u9009\u62e9\u7684\u724c\u4e0d\u7b26\u5408\u89c4\u5219"),this.XLCHChangeTips.node_card.forEach(function(e){e.active=!0}))),0==n&&(this.XLCHChangeTips.showCard(t),this.XLCHPlayer[t].showChangeDot(!1),0!=t&&(v.MJData.handCardNum[t]=10,this.XLCHHandArea[t].createHandMJ(10)))},t.prototype.onSendChangeCardResult=function(e){var t=this;v.MJData.MultipleHandClick=!1,this.XLCHChangeTips.showChangeTips(!1),this.XLCHChangeTips.hideCard();for(var n=e.changeWay,o=e.get_cards,r=e.remove_cards,a=0;a<r.length;a++){var i=r[a],c=v.MJData.userCardArr.indexOf(i);-1!=c&&v.MJData.userCardArr.splice(c,1)}v.MJData.handCardNum[0]=10,this.XLCHHandArea[0].createHandMJ(10),h.default.sortCardList(v.MJData.userCardArr),this.XLCHHandArea[0].setHandValue();this.XLCHChangeTips.showChangeWay(n),this.scheduleOnce(function(){t.XLCHChangeTips.hideChangeWay(),t.XLCHHandArea.forEach(function(e,t){v.MJData.handCardNum[t]=13,e.createHandMJ(13)}),v.MJData.userCardArr=v.MJData.userCardArr.concat(o),h.default.sortCardList(v.MJData.userCardArr),t.XLCHHandArea[0].setHandValue()},1)},t.prototype.onDingQueNotify=function(e){this.XLCHDingQue.showDingQueView(!0),this.XLCHChangeTips.resetView(),this.XLCHTable.setClockTime(e.time_out),this.XLCHPlayer.forEach(function(e){e.showDingQueDot(!0)})},t.prototype.onPlayerDingQueRes=function(e){var t=this;e.dingque.forEach(function(e,n){var o=n+1,r=h.default.getLocalIndex(o);t.XLCHPlayer[r].setDingQueIcon(e),t.XLCHPlayer[r].showDingQueDot(!1),0==r&&(s.NetManager.getGameProtocol().DingQueCode=e,h.default.sortCardList(v.MJData.userCardArr),L.LogWrap.log("\u6700\u65b0\u5b9a\u7f3a\u540e\u7684\u724c\u578b\u6570\u636e",v.MJData.userCardArr),t.XLCHHandArea[0].setHandValue(),t.XLCHHandArea[0].setHandMJGrey(s.NetManager.getGameProtocol().DingQueCards,!1),t.XLCHDingQue.showDingQueView(!1))})},t.prototype.onSubTurnOper=function(e){var t=e.seat_id,n=h.default.getLocalIndex(t);v.MJData.turnMeOperate=0==n,L.LogWrap.log("%c \u8f6e\u5230\u8c01\u64cd\u4f5c->>>>","color:red;font-size:24px",n),this.XLCHTable.showArrowLight(n);var o=e.time_out;this.XLCHTable.setClockTime(o)},t.prototype.onSubGetCard=function(e){var t=e.seat_id,n=h.default.getLocalIndex(t),o=e.card;v.MJData.handCardNum[n]=v.MJData.handCardNum[n]+o.length;var r=v.MJData.handCardNum[n];if(this.XLCHHandArea[n].createHandMJ(r),0==n){H.EventManager.emit(M.MJEventDef.MjBrightEvent),L.LogWrap.log("\u6211\u83b7\u53d6\u624b\u724c\u4e86!!!!!!!!!!!!",o),v.MJData.userCardArr=v.MJData.userCardArr.concat(o);var a=o[0];Math.floor(a/10)==s.NetManager.getGameProtocol().DingQueCode&&(L.LogWrap.log("\u83b7\u53d6\u7684\u624b\u724c\u662f\u5b9a\u7f3a\u7684\u724c"),s.NetManager.getGameProtocol().DingQueCards.push(a)),this.XLCHHandArea[n].setHandValue(),this.XLCHHandArea[n].setHandMJGrey(s.NetManager.getGameProtocol().DingQueCards,!1),this.tingStateRun&&this.XLCHHandArea[n].setMJGrey([])}var i=e.left_card;this.XLCHTop.setRemainCard(i)},t.prototype.onSubPlayerCanOper=function(e){var t=e.oper_type;-1==t.indexOf(M.MJOperType.Shoot)&&0!=t.length&&(L.LogWrap.log("%c \u901a\u77e5\u7528\u6237\u64cd\u4f5c!!!!!!!!","color:red"),v.MJData.hasOperAction=!0);for(var n=0;n<t.length;n++)3==t[n]?this.XLCHOper.showOption("chi"):4==t[n]?this.XLCHOper.showOption("peng"):t[n]>=5&&t[n]<=7?this.XLCHOper.showOption("gang"):8==t[n]||9==t[n]?this.XLCHOper.showOption("hu"):10==t[n]&&this.XLCHOper.showOption("ting");v.MJData.chiCombo=[],v.MJData.gangCombo=[],v.MJData.pengCards=null,v.MJData.huCombo=null;var o=e.combo;for(n=0;n<o.length;n++){var r=o[n];r.oper_type==M.MJOperType.Chi?v.MJData.chiCombo.push(r):r.oper_type==M.MJOperType.MingGang||r.oper_type==M.MJOperType.BuGang||r.oper_type==M.MJOperType.AnGang?v.MJData.gangCombo.push(r):r.oper_type==M.MJOperType.Peng?v.MJData.pengCards=r.cards:r.oper_type!=M.MJOperType.DianPao&&r.oper_type!=M.MJOperType.Zimo||(v.MJData.huCombo=r)}},t.prototype.onSubCanTing=function(e){var t=e.ting_combo;v.MJData.tingCombo=t;for(var n=0;n<t.length;n++){var o=t[n].out_card;this.XLCHHandArea[0].addArrowTing(o)}},t.prototype.onSendTingNotify=function(e){var t=e.seat_id;0==h.default.getLocalIndex(t)&&(v.MJData.HuCardList=e.ting_cards,this.XLCHOper.showBtnHuList(!0),v.MJData.tingCombo=null)},t.prototype.onSubPlayerOper=function(e){var t=e.ret;if(0==t){var n=e.seat_id,o=h.default.getLocalIndex(n),r=1==h.default.getUserSexByID(n)?"male/":"female/";L.LogWrap.log("\u64cd\u4f5c\u4eba\u4f4d\u7f6e",o);var a=e.oper_cards,i=a.oper_type;L.LogWrap.log("\u64cd\u4f5c\u7c7b\u578b",i);var c=a.cards,u=a.oper_seat_id,l=0;65535!=u&&0!=u&&(this.lastOutPos=h.default.getLocalIndex(u),l=h.default.getDir(n,u),L.LogWrap.log("\u76f8\u5bf9\u4e8e\u64cd\u4f5c\u8005\u7684\u63d0\u4f9b\u8005\u89c6\u56fe\u4f4d\u7f6e",l)),2==i&&(this.lastOutCard=c[0],this.lastOutPos=o),0==o&&i!=M.MJOperType.Check&&i!=M.MJOperType.Ting&&(v.MJData.tingCombo=null,this.XLCHHandArea[0].removeArrowTing());var p=0;switch(i){case M.MJOperType.Check:this.XLCHHandArea[0].hideMJGrey(),this.XLCHOper.resetView();break;case M.MJOperType.Shoot:p=1,this.XLCHOutArea[o].createOutMJ(c[0],!1);var d=this.XLCHOutArea[o].getLastAddCard();this.XLCHOutEffect.showOutEffect(c[0],o,d),this.XLCHOutArea[o].showShotArrow(),g.AudioManager.playGameSFX("dapai"),g.AudioManager.playGameSFX(r+c[0]);break;case M.MJOperType.Chi:p=2,v.MJData.chiCombo=[],this.XLCHCPGArea[o].createCPGMJ(i,c,l),this.XLCHOutArea[this.lastOutPos].delEndOutMJ(),this.hideShotArrow(),this.showOperEffect(o,i);break;case M.MJOperType.Peng:p=2,v.MJData.pengCards=null,this.XLCHCPGArea[o].createCPGMJ(i,c,l),this.XLCHOutArea[this.lastOutPos].delEndOutMJ(),this.hideShotArrow(),this.showOperEffect(o,i);break;case M.MJOperType.MingGang:p=3,v.MJData.gangCombo=[],L.LogWrap.log("\u660e\u6760!!!!"),this.XLCHCPGArea[o].createCPGMJ(i,c,l),this.XLCHOutArea[this.lastOutPos].delEndOutMJ(),this.hideShotArrow(),this.showOperEffect(o,i);break;case M.MJOperType.AnGang:p=4,v.MJData.gangCombo=[],L.LogWrap.log("\u6697\u6760!!!!"),this.XLCHCPGArea[o].createCPGMJ(i,c,l),this.showOperEffect(o,i);break;case M.MJOperType.BuGang:p=1,v.MJData.gangCombo=[],L.LogWrap.log("\u8865\u6760!!!!"),this.XLCHCPGArea[o].pengToBuGangCard(c,l),this.showOperEffect(o,i);break;case M.MJOperType.Zimo:this.XLCHHuArea[o].createHuMJ(c),this.showOperEffect(o,i);break;case M.MJOperType.DianPao:this.XLCHHuArea[o].createHuMJ(c),this.XLCHOutArea[this.lastOutPos].delEndOutMJ(),this.hideShotArrow(),this.showOperEffect(o,i);break;case M.MJOperType.Ting:if(0==o){for(var f=v.MJData.tingCombo,y=[],C=0;C<f.length;C++){var _=f[C].out_card;y.push(_)}this.XLCHHandArea[0].setMJGrey(y),this.tingStateReady=!0}}v.MJData.handCardNum[o]=v.MJData.handCardNum[o]-p;var m=v.MJData.handCardNum[o];if(i!=M.MJOperType.Check&&i!=M.MJOperType.Ting&&this.XLCHHandArea[o].createHandMJ(m),0==o){this.XLCHOper.hideOption(),i==M.MJOperType.Ting&&this.XLCHOper.showOption("guo"),this.XLCHTingTipsView.hideTingTipsView(),this.tingStateRun||(L.LogWrap.log("\u91cd\u7f6e\u5403\u78b0\u6760\u64cd\u4f5c"),v.MJData.hasOperAction=!1);var b=[];if(i==M.MJOperType.Chi||i==M.MJOperType.Peng||i==M.MJOperType.MingGang){b=c.concat([]);var w=c.indexOf(this.lastOutCard);b.splice(w,1)}else i==M.MJOperType.BuGang?(b=c.concat([]),(b=[]).push(c[0])):i!=M.MJOperType.AnGang&&i!=M.MJOperType.Shoot||(b=c.concat([]));for(C=0;C<b.length;C++){var X=b[C],O=v.MJData.userCardArr.indexOf(X);v.MJData.userCardArr.splice(O,1)}i!=M.MJOperType.Check&&i!=M.MJOperType.Ting&&h.default.sortCardList(v.MJData.userCardArr),this.XLCHHandArea[o].setHandValue(),this.XLCHHandArea[o].setHandMJGrey(s.NetManager.getGameProtocol().DingQueCards,!1),this.tingStateRun&&this.XLCHHandArea[o].setMJGrey([]),H.EventManager.emit(M.MJEventDef.MjBrightEvent)}i!=M.MJOperType.Check&&i!=M.MJOperType.Ting&&i!=M.MJOperType.Shoot&&g.AudioManager.playGameSFX(r+M.MJSound[i])}else 1==t&&(v.MJData.hasOperAction=!1,this.XLCHOper.hideOption(),L.LogWrap.log("%c \u64cd\u4f5c\u54cd\u5e94\u5931\u8d25","color:red;font-size:32px",e))},t.prototype.onSubGameEnd=function(e){var t=this;this.isStartGame=!1;var n=[];s.NetManager.protocolGameCommon.needFlushGold&&s.NetManager.protocolGameCommon.flushPlayerInfo.forEach(function(e){var t=h.default.getLocalIndex(e.seat_id);n[t]=e.gold}),this.XLCHTable.resetClockDi(),this.XLCHHandArea[0].hideMJGrey(),v.MJData.tingCombo=null,e.player_list.forEach(function(e){var o=e.seat_id,r=h.default.getLocalIndex(o),a=n[r]?n[r]:parseFloat(e.gold),i=parseFloat(e.score),c=2==r?cc.v2(0,-120):cc.v2(0,100);t.XLCHPlayer[r].flutterScore(i,c,function(){t.XLCHPlayer[r].setUserScore(a),0==r&&(s.NetManager.protocolGameCommon.needFlushGold=!1,l.DataManager.userInfo.gold=a,t.XLCHTable.showReady(!0))})}),e.player_finish_info.forEach(function(e){var n=e.seat_id,o=h.default.getLocalIndex(n);t.XLCHHandArea[o].removeAllHand(),t.XLCHShowArea[o].showMingCard(e.cards)}),c.UIManager.popup("game/xlch/prefab/xlch_result",e)},t.prototype.onGuaFengXiaYuNotify=function(e){var t=this,n=e.code;e.score.forEach(function(e,o){if(0!=e){var r=o+1,a=h.default.getLocalIndex(r);t.playGuaFengXiaYu(a,n);var i=2==a?cc.v2(0,-120):cc.v2(0,100);t.XLCHPlayer[a].flutterScore(e,i)}})},t.prototype.playGuaFengXiaYu=function(e,t){return a(this,void 0,void 0,function(){var n,o,r=this;return i(this,function(a){switch(a.label){case 0:return n=1==t?"guafeng/guafeng":"xiayu/xiayu",[4,b.ResManager.loadResAsync("game/xlch/effect/"+n,sp.SkeletonData)];case 1:return o=a.sent(),this.user_spine[e].clearTracks(),this.user_spine[e].setToSetupPose(),this.user_spine[e].skeletonData=o,this.user_spine[e].animation="animation",this.user_spine[e].node.active=!0,this.user_spine[e].setCompleteListener(function(){r.user_spine[e].node.active=!1,r.XLCHPlayer[e].hideFlutter()}),[2]}})})},t.prototype.onHujiaoNotify=function(e){var t=this;e.score.forEach(function(e,n){var o=n+1;if(0!=e){var r=h.default.getLocalIndex(o);t.showHuJiao(r);var a=2==r?cc.v2(0,-120):cc.v2(0,100);t.XLCHPlayer[r].flutterScore(e,a)}})},t.prototype.onLiujuNotify=function(e){var t=this;e.tuiShuiScore.forEach(function(e,n){var o=n+1;if(0!=e){var r=h.default.getLocalIndex(o);t.showFlowBureau(r,0);var a=2==r?cc.v2(0,-120):cc.v2(0,100);t.XLCHPlayer[r].flutterScore(e,a)}}),e.chaHuaZhuScore.forEach(function(e,n){var o=n+1;if(0!=e){var r=h.default.getLocalIndex(o);t.showFlowBureau(r,1);var a=2==r?cc.v2(0,-120):cc.v2(0,100);t.XLCHPlayer[r].flutterScore(e,a)}}),e.chaDaJiaoScore.forEach(function(e,n){var o=n+1;if(0!=e){var r=h.default.getLocalIndex(o);t.showFlowBureau(r,2);var a=2==r?cc.v2(0,-120):cc.v2(0,100);t.XLCHPlayer[r].flutterScore(e,a)}})},t.prototype.onUpdateUserScore=function(){},t.prototype.showOperEffect=function(e,t){return a(this,void 0,void 0,function(){var n,o=this;return i(this,function(r){switch(r.label){case 0:return[4,b.ResManager.loadResAsync(M.MJEffect[t],sp.SkeletonData)];case 1:return n=r.sent(),this.user_spine[e].clearTracks(),this.user_spine[e].setToSetupPose(),this.user_spine[e].skeletonData=n,this.user_spine[e].animation="animation",this.user_spine[e].node.active=!0,this.user_spine[e].setCompleteListener(function(){o.user_spine[e].node.active=!1}),[2]}})})},t.prototype.showFlowBureau=function(e,t){var n=this,o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.ljframe[t],this.user_spine[e].node.addChild(o);var r=cc.sequence(cc.delayTime(1),cc.callFunc(function(){o.removeFromParent(),n.XLCHPlayer[e].hideFlutter()}));o.runAction(r)},t.prototype.showHuJiao=function(e){var t=this,n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=this.hujiaoFrame,this.user_spine[e].node.addChild(n);var o=cc.sequence(cc.delayTime(1),cc.callFunc(function(){n.removeFromParent(),t.XLCHPlayer[e].hideFlutter()}));n.runAction(o)},r([G(p.default)],t.prototype,"XLCHPlayer",void 0),r([G(C.default)],t.prototype,"XLCHHandArea",void 0),r([G(X.default)],t.prototype,"XLCHCPGArea",void 0),r([G(w.default)],t.prototype,"XLCHOutArea",void 0),r([G(O.default)],t.prototype,"XLCHShowArea",void 0),r([G(A.default)],t.prototype,"XLCHHuArea",void 0),r([G(y.default)],t.prototype,"XLCHTop",void 0),r([G(f.default)],t.prototype,"XLCHTable",void 0),r([G(d.default)],t.prototype,"XLCHOper",void 0),r([G(D.default)],t.prototype,"XLCHTingTipsView",void 0),r([G(_.default)],t.prototype,"XLCHChangeTips",void 0),r([G(m.default)],t.prototype,"XLCHDingQue",void 0),r([G(P.default)],t.prototype,"XLCHOutEffect",void 0),r([G(sp.Skeleton)],t.prototype,"user_spine",void 0),r([G(cc.SpriteFrame)],t.prototype,"ljframe",void 0),r([G(cc.SpriteFrame)],t.prototype,"hujiaoFrame",void 0),r([G(cc.Node)],t.prototype,"xlch_arrow",void 0),t=r([S],t)}(cc.Component);n.default=E,cc._RF.pop()},{"../../../common/log/LogWrap":void 0,"../../../common/utils/Utils":void 0,"../../../manager/AudioManager":void 0,"../../../manager/DataManager":void 0,"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0,"../../../manager/UIManager":void 0,"../../mahjong/MJData":void 0,"../../mahjong/MJDefine":void 0,"../../mahjong/MJOutEffect":void 0,"../XLCHDefine":"XLCHDefine","./XLCHCPGArea":"XLCHCPGArea","./XLCHChangeTips":"XLCHChangeTips","./XLCHDingQue":"XLCHDingQue","./XLCHHandArea":"XLCHHandArea","./XLCHHuArea":"XLCHHuArea","./XLCHOper":"XLCHOper","./XLCHOutArea":"XLCHOutArea","./XLCHPlayer":"XLCHPlayer","./XLCHShowArea":"XLCHShowArea","./XLCHTable":"XLCHTable","./XLCHTingTipsView":"XLCHTingTipsView","./XLCHTool":"XLCHTool","./XLCHTop":"XLCHTop"}],XLCHHandArea:[function(e,t,n){"use strict";cc._RF.push(t,"c79a2eo8fNO95EBJkO4pXvj","XLCHHandArea");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../mahjong/MJCardBase"),i=e("../../mahjong/MJHandAreaBase"),c=cc._decorator,s=c.ccclass,u=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ArrowTing=null,t}return o(t,e),t.prototype.addArrowTing=function(e){for(var t=this.mj_hand.childrenCount,n=0;n<t;n++){var o=this.mj_hand.children[n];if(e==o.getComponent(a.default).getCardValue()){var r=cc.instantiate(this.ArrowTing);r.setPosition(cc.v2(0,80)),o.addChild(r)}}},t.prototype.removeArrowTing=function(){for(var e=this.mj_hand.childrenCount,t=0;t<e;t++){var n=this.mj_hand.children[t];null!=n.getChildByName("ArrowTing")&&n.getChildByName("ArrowTing").removeFromParent()}},t.prototype.setMJGrey=function(e,t){void 0===t&&(t=!0),this.mj_hand.children.forEach(function(n){var o=n.getComponent(a.default).getCardValue();-1==e.indexOf(o)&&(t&&n.pauseSystemEvents(!0),n.getComponent(a.default).setGreyBack(!0))})},t.prototype.hideMJGrey=function(){this.mj_hand.children.forEach(function(e){e.resumeSystemEvents(!0),e.getComponent(a.default).setGreyBack(!1)})},t.prototype.setBounceMJ=function(e){var t=this,n=JSON.parse(JSON.stringify(e));this.mj_hand.children.forEach(function(e){var o=e.getComponent(a.default).getCardValue();-1!=n.indexOf(o)&&(n.splice(n.indexOf(o),1),t.MJClickEvent(e))})},t.prototype.setHandMJGrey=function(e,t){void 0===t&&(t=!0),this.mj_hand.children.forEach(function(n){var o=n.getComponent(a.default).getCardValue();-1!=e.indexOf(o)&&(t&&n.pauseSystemEvents(!0),n.getComponent(a.default).setGreyBack(!0))})},r([u(cc.Prefab)],t.prototype,"ArrowTing",void 0),t=r([s],t)}(i.default);n.default=l,cc._RF.pop()},{"../../mahjong/MJCardBase":void 0,"../../mahjong/MJHandAreaBase":void 0}],XLCHHuArea:[function(e,t,n){"use strict";cc._RF.push(t,"05175HMButBuKamh331JE6C","XLCHHuArea");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../mahjong/MJCardBase"),i=cc._decorator,c=i.ccclass,s=i.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.node_area=null,t.mj_prefab=null,t.StartPos=cc.v2(),t.DisX=0,t.DisY=0,t.increase=!0,t.lineFeed=0,t.lineOffset=cc.v2(),t.line=0,t.lineIdx=0,t}return o(t,e),t.prototype.createHuMJ=function(e){var t=cc.instantiate(this.mj_prefab),n=this.StartPos.x+this.DisX*this.lineIdx+this.line*this.lineOffset.x,o=this.StartPos.y+this.DisY*this.lineIdx+this.line*this.lineOffset.y;t.setPosition(cc.v2(n,o)),this.node_area.addChild(t),this.lineIdx++,this.lineIdx>this.lineFeed&&(this.line++,this.lineIdx=0),t.getComponent(a.default).setSpirteValue(e)},t.prototype.removeCard=function(){this.node_area.destroyAllChildren(),this.lineIdx=0,this.line=0},r([s(cc.Node)],t.prototype,"node_area",void 0),r([s({type:cc.Prefab,tooltip:"\u624b\u724c\u9884\u5236\u4f53"})],t.prototype,"mj_prefab",void 0),r([s({tooltip:"\u8d77\u59cb\u4f4d\u7f6e"})],t.prototype,"StartPos",void 0),r([s({tooltip:"\u9ebb\u5c06\u95f4\u9694"})],t.prototype,"DisX",void 0),r([s({tooltip:"\u9ebb\u5c06\u95f4\u9694"})],t.prototype,"DisY",void 0),r([s({tooltip:"\u5c42\u7ea7\u9012\u589e\u6216\u8005\u9012\u51cf"})],t.prototype,"increase",void 0),r([s({tooltip:"\u6362\u884c\u6570\u91cf"})],t.prototype,"lineFeed",void 0),r([s({tooltip:"\u6362\u884c\u504f\u79fb\u91cf"})],t.prototype,"lineOffset",void 0),t=r([c],t)}(cc.Component);n.default=u,cc._RF.pop()},{"../../mahjong/MJCardBase":void 0}],XLCHOper:[function(e,t,n){"use strict";cc._RF.push(t,"d1e9aOsHbBL0b1ZdIWQyhi7","XLCHOper");var o,r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../mahjong/MJOperBase"),u=e("../../../common/utils/Utils"),l=e("../../../manager/EventManager"),p=e("../../mahjong/MJCardBase"),h=e("../../mahjong/MJDefine"),d=e("../../../manager/ResManager"),f=e("../../mahjong/MJData"),g=((o={})[h.MJOperType.Chi]="chi",o[h.MJOperType.Peng]="peng",o[h.MJOperType.MingGang]="gang",o[h.MJOperType.AnGang]="gang",o[h.MJOperType.BuGang]="gang",o),y=cc._decorator,C=y.ccclass,v=y.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.multiple_oper_view=null,t.icon_type=null,t.card_list=[],t.btn_huList=null,t.cardListDatas=[],t.hasOpenHuList=!1,t.GameView=null,t}return r(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this),this.resetView(),this.card_list.forEach(function(e,n){var o=n;u.default.addClickEventEND(e,t.onClickCardListEvent.bind(t),o)}),this.btn_huList.active=!1,u.default.addClickEventEND(this.btn_huList,this.onClickHuListEvent.bind(this)),l.EventManager.on(this,h.MJEventDef.OpenMulOperView,function(e){t.showMulOperview(e)})},t.prototype.onDestroy=function(){l.EventManager.off(this)},t.prototype.resetView=function(){this.multiple_oper_view.active=!1,this.icon_type.spriteFrame=null,this.card_list.forEach(function(e){e.active=!1}),this.cardListDatas=[]},t.prototype.showMulOperview=function(e){return i(this,void 0,void 0,function(){var t,n,o;return c(this,function(r){switch(r.label){case 0:this.resetView(),t=function(t){var o,r,a,i,s;return c(this,function(c){switch(c.label){case 0:return 0!=t?[3,2]:(o=e[t].oper_type,r=g[o],a=n.icon_type,[4,d.ResManager.loadResAsync("game/mahjong/res/icon_"+r,cc.SpriteFrame)]);case 1:a.spriteFrame=c.sent(),c.label=2;case 2:return n.cardListDatas.push(e[t]),(i=n.card_list[t]).active=!0,s=e[t].cards,i.children.forEach(function(e,t){null!=s[t]?(e.active=!0,e.getComponent(p.default).setSpirteValue(s[t])):e.active=!1}),[2]}})},n=this,o=0,r.label=1;case 1:return o<e.length?[5,t(o)]:[3,4];case 2:r.sent(),r.label=3;case 3:return o++,[3,1];case 4:return this.multiple_oper_view.active=!0,[2]}})})},t.prototype.onClickCardListEvent=function(e,t){var n=this.cardListDatas[t];n.oper_type==h.MJOperType.Chi?l.EventManager.emit(h.MJEventDef.MjChiEvent,n):l.EventManager.emit(h.MJEventDef.MjGangEvent,n),this.multiple_oper_view.active=!1,this.node_oper.active=!1},t.prototype.showBtnHuList=function(e){this.btn_huList.active=e,this.hasOpenHuList=!1},t.prototype.onClickHuListEvent=function(){this.hasOpenHuList?this.GameView.XLCHTingTipsView.hideTingTipsView():this.GameView.XLCHTingTipsView.showTingTipsView(f.MJData.HuCardList),this.hasOpenHuList=!this.hasOpenHuList},a([v(cc.Node)],t.prototype,"multiple_oper_view",void 0),a([v(cc.Sprite)],t.prototype,"icon_type",void 0),a([v(cc.Node)],t.prototype,"card_list",void 0),a([v(cc.Node)],t.prototype,"btn_huList",void 0),t=a([C],t)}(s.default);n.default=_,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/EventManager":void 0,"../../../manager/ResManager":void 0,"../../mahjong/MJCardBase":void 0,"../../mahjong/MJData":void 0,"../../mahjong/MJDefine":void 0,"../../mahjong/MJOperBase":void 0}],XLCHOutArea:[function(e,t,n){"use strict";cc._RF.push(t,"9d683TdtSxGL6teBcX3RfL6","XLCHOutArea");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../mahjong/MJOutAreaBase"),i=e("../../mahjong/MJCardBase"),c=cc._decorator,s=c.ccclass,u=c.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.node_bright=null,t.shotArrow=null,t}return o(t,e),t.prototype.addCardBright=function(e){for(var t=this.node_outArea.childrenCount,n=0;n<t;n++){var o=this.node_outArea.children[n],r=o.getComponent(i.default).getCardValue();o.getComponent(i.default).setGreyBack(r==e)}},t.prototype.hideCardBright=function(){for(var e=this.node_outArea.childrenCount,t=0;t<e;t++){this.node_outArea.children[t].getComponent(i.default).setGreyBack(!1)}},t.prototype.showShotArrow=function(){this.shotArrow.active=!0,this.shotArrow.stopAllActions();var e=this.getLastAddCard().position,t=this.node_outArea.convertToWorldSpaceAR(e),n=this.shotArrow.parent.convertToNodeSpaceAR(t);this.shotArrow.setPosition(n.x,n.y+30);var o=cc.moveBy(.4,cc.v2(0,10)),r=cc.moveBy(.4,cc.v2(0,-10)),a=cc.repeatForever(cc.sequence(o,r));this.shotArrow.runAction(a)},r([u(cc.Prefab)],t.prototype,"node_bright",void 0),r([u(cc.Node)],t.prototype,"shotArrow",void 0),t=r([s],t)}(a.default);n.default=l,cc._RF.pop()},{"../../mahjong/MJCardBase":void 0,"../../mahjong/MJOutAreaBase":void 0}],XLCHPlayer:[function(e,t,n){"use strict";cc._RF.push(t,"0246b5Fc55KOLFI4VeGIgf2","XLCHPlayer");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../../common/UIHelper"),s=e("../../../common/utils/Utils"),u=e("../../../manager/ResManager"),l=e("./XLCHDot"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spr_head=null,t.banker=null,t.label_name=null,t.label_money=null,t.icon_ting=null,t.icon_dingque=null,t.spr_dot=null,t.flutter=null,t.lose_num=null,t.win_num=null,t.interVal=null,t}return o(t,e),t.prototype.onLoad=function(){this.originFlutterPos=this.flutter.node.position},t.prototype.initUser=function(){this.spr_head.spriteFrame=null,this.label_name.string="",this.label_money.string="",this.banker.active=!1,this.icon_dingque.spriteFrame=null,this.icon_ting.active=!1,this.spr_dot.node.active=!1,this.flutter.node.stopAllActions(),this.flutter.node.active=!1,this.flutter.string="",this.unschedule(this.interVal),this.interVal=null,this.node.active=!1},t.prototype.setUserHead=function(e){c.default.setHeadIcon(e,this.spr_head.node)},t.prototype.setUserScore=function(e){this.label_money.string=s.default.getFormatGold(e)},t.prototype.setUserInfo=function(e){var t=e,n=s.default.getSubStringLengTxt(e.username)||s.default.getReplaceStrToStar(e.player_id);this.label_name.string=n,this.setUserHead(e.headimg_id),this.setUserScore(t.gold),this.node.active=!0},t.prototype.setBankerIcon=function(e){this.banker.active=e},t.prototype.setTingIcon=function(e){this.icon_ting.active=e},t.prototype.setDingQueIcon=function(e){return a(this,void 0,void 0,function(){var t,n;return i(this,function(o){switch(o.label){case 0:return t={1:"wan",2:"tiao",3:"tong"},[4,u.ResManager.loadResAsync("game/xlch/res/dq_"+t[e],cc.SpriteFrame)];case 1:return n=o.sent(),this.icon_dingque.spriteFrame=n,[2]}})})},t.prototype.showChangeDot=function(e){this.spr_dot.node.active=e,e&&this.spr_dot.showDot(1)},t.prototype.showDingQueDot=function(e){this.spr_dot.node.active=e,e&&this.spr_dot.showDot(2)},t.prototype.flutterScore=function(e,t,n){var o=this;this.flutter.node.position=this.originFlutterPos,this.flutter.node.active=!0;var r="";e>=0?(this.flutter.font=this.win_num,r="+"):(this.flutter.font=this.lose_num,r="-");var a=Math.abs(e),i=a/parseFloat(50..toFixed(2)),c=0,s="";this.interVal=function(){s=(c+=i).toFixed(2),o.flutter.string=r+s,c>=a&&(s=a.toString(),o.flutter.string=r+parseFloat(s).toFixed(2),o.unschedule(o.interVal))},this.schedule(this.interVal,.01,cc.macro.REPEAT_FOREVER);var u=cc.moveBy(.5,t),l=cc.sequence(u,cc.delayTime(.5),cc.callFunc(function(){n&&n()}));this.flutter.node.runAction(l)},t.prototype.hideFlutter=function(){this.flutter.node.stopAllActions(),this.flutter.node.active=!1},t.prototype.onDestroy=function(){this.unschedule(this.interVal),this.interVal=null},r([d(cc.Sprite)],t.prototype,"spr_head",void 0),r([d(cc.Node)],t.prototype,"banker",void 0),r([d(cc.Label)],t.prototype,"label_name",void 0),r([d(cc.Label)],t.prototype,"label_money",void 0),r([d(cc.Node)],t.prototype,"icon_ting",void 0),r([d(cc.Sprite)],t.prototype,"icon_dingque",void 0),r([d(l.default)],t.prototype,"spr_dot",void 0),r([d(cc.Label)],t.prototype,"flutter",void 0),r([d(cc.BitmapFont)],t.prototype,"lose_num",void 0),r([d(cc.BitmapFont)],t.prototype,"win_num",void 0),t=r([h],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../../../manager/ResManager":void 0,"./XLCHDot":"XLCHDot"}],XLCHResultPlayer:[function(e,t,n){"use strict";cc._RF.push(t,"629c1JYH1dDzoRQF8VwF1or","XLCHResultPlayer");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../../common/UIHelper"),s=e("../../../manager/ResManager"),u=cc._decorator,l=u.ccclass,p=u.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.user_head=null,t.vip_frame=null,t.user_name=null,t.banker=null,t.wind=null,t.flutter=null,t.lose_num=null,t.win_num=null,t}return o(t,e),t.prototype.setUserName=function(e){this.user_name.string=e},t.prototype.setUserHead=function(e){c.default.setHeadIcon(e,this.user_head)},t.prototype.setBankerIcon=function(e){this.banker.active=e},t.prototype.setWindIcon=function(e){return a(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return[4,s.ResManager.loadResAsync("game/xlch/res/balance/xlch_wind_"+e,cc.SpriteFrame)];case 1:return t=n.sent(),this.wind.spriteFrame=t,[2]}})})},t.prototype.setFlutterScore=function(e){var t="";e>=0?(this.flutter.font=this.win_num,t="+"):this.flutter.font=this.lose_num,this.flutter.string=t+e.toFixed(2)},r([p(cc.Node)],t.prototype,"user_head",void 0),r([p(cc.Sprite)],t.prototype,"vip_frame",void 0),r([p(cc.Label)],t.prototype,"user_name",void 0),r([p(cc.Node)],t.prototype,"banker",void 0),r([p(cc.Sprite)],t.prototype,"wind",void 0),r([p(cc.Label)],t.prototype,"flutter",void 0),r([p(cc.BitmapFont)],t.prototype,"lose_num",void 0),r([p(cc.BitmapFont)],t.prototype,"win_num",void 0),t=r([l],t)}(cc.Component);n.default=h,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../manager/ResManager":void 0}],XLCHResult:[function(e,t,n){"use strict";cc._RF.push(t,"50c44qvhRVP/JR9BNRTlWPv","XLCHResult");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../../common/utils/Utils"),s=e("../../../manager/EventManager"),u=e("../../../manager/NetManager"),l=e("../../../manager/ResManager"),p=e("../../../view/base/PopupView"),h=e("../../../view/common/List"),d=e("../../mahjong/MJData"),f=e("../XLCHDefine"),g=e("./XLCHResultPlayer"),y=e("./XLCHTool"),C=cc._decorator,v=C.ccclass,_=C.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.XLCHResultPlayer=[],t.ScrollView=null,t.icon_flag=null,t.win_num=null,t.lose_num=null,t.winGold=0,t.historydata=null,t}return o(t,e),t.prototype.initComponent=function(){var e=this;this.getItem("btn_close").registerClick(function(){e.close()}),this.getItem("btn_exit").registerClick(function(){e.close()}),this.getItem("btn_start").registerClick(function(){s.EventManager.emit(f.XLCHEvent.ResultClickStart),e.close()}),this.getItem("btn_share").registerClick(function(){u.NetManager.protocolChat.sendChatShareRoomReq(e.winGold.toFixed(2)+"")})},t.prototype.initEvent=function(){var e=this;s.EventManager.on(this,f.XLCHEvent.CloseResultView,function(){e.close()})},t.prototype.start=function(){this.showResultView(),this.ScrollView.numItems=this.data.myConcludeHistory.length,this.historydata=this.data.myConcludeHistory},t.prototype.showResultView=function(){for(var e,t=this.data.player_list,n=0;n<t.length;n++){var o=t[n],r=y.default.getLocalIndex(o.seat_id);this.XLCHResultPlayer[r].setUserHead(o.headimg_id);var a=c.default.getSubStringLengTxt(o.username)||c.default.getReplaceStrToStar(o.player_id);if(this.XLCHResultPlayer[r].setUserName(a),this.XLCHResultPlayer[r].setWindIcon(o.windPos),this.XLCHResultPlayer[r].setBankerIcon(r==d.MJData.bankerPos),this.XLCHResultPlayer[r].setFlutterScore(parseFloat(o.score)),0==r){var i=parseFloat(o.score);e=0==i?0:i>0?1:2}}this.setResultFlag(e)},t.prototype.setResultFlag=function(e){return a(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return[4,l.ResManager.loadResAsync("game/xlch/res/balance/"+(0==e?"xlch_liuju":1==e?"xlch_win":"xlch_lose"),cc.SpriteFrame)];case 1:return t=n.sent(),this.icon_flag.spriteFrame=t,[2]}})})},t.prototype.onListRender=function(e,t){return a(this,void 0,void 0,function(){var n,o,r,a,c,s,u=this;return i(this,function(i){return e.active=!0,n=this.historydata[t],o=e.getChildByName("label_type").getComponent(cc.Label),r="",n.fanxing.forEach(function(e,t){t>0&&(r+=","),r+=f.FanXingStr[e]}),o.string=f.concludeStr[n.actionType]+"\n("+r+")",a=e.getChildByName("label_dir").getComponent(cc.Label),n.oper_seats.forEach(function(e,t){t>0&&(a.string+=",");var n=u.getSeatStr(e);a.string+=n}),e.getChildByName("bet_num").getComponent(cc.Label).string=n.beiShu+"\u500d",c=e.getChildByName("score").getComponent(cc.Label),s="",parseFloat(n.score)>=0?(s="+",c.font=this.win_num):c.font=this.lose_num,c.string=s+parseFloat(n.score).toFixed(2),[2]})})},t.prototype.getSeatStr=function(e){return["","\u4e0b\u5bb6","\u5bf9\u5bb6","\u4e0a\u5bb6"][y.default.getLocalIndex(e)]},r([_(g.default)],t.prototype,"XLCHResultPlayer",void 0),r([_(h.default)],t.prototype,"ScrollView",void 0),r([_(cc.Sprite)],t.prototype,"icon_flag",void 0),r([_(cc.BitmapFont)],t.prototype,"win_num",void 0),r([_(cc.BitmapFont)],t.prototype,"lose_num",void 0),t=r([v],t)}(p.default);n.default=m,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0,"../../../view/base/PopupView":void 0,"../../../view/common/List":void 0,"../../mahjong/MJData":void 0,"../XLCHDefine":"XLCHDefine","./XLCHResultPlayer":"XLCHResultPlayer","./XLCHTool":"XLCHTool"}],XLCHShowArea:[function(e,t,n){"use strict";cc._RF.push(t,"8a0d7jP9RFHApThTxccYiTF","XLCHShowArea");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../mahjong/MJShowAreaBase"),i=cc._decorator,c=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t=r([c],t)}(a.default));n.default=s,cc._RF.pop()},{"../../mahjong/MJShowAreaBase":void 0}],XLCHTable:[function(e,t,n){"use strict";cc._RF.push(t,"0e689b4jZdCqak91WoKtLwF","XLCHTable");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../../common/log/LogWrap"),s=e("../../../common/utils/Utils"),u=e("../../../manager/AudioManager"),l=e("../../../manager/NetManager"),p=e("../../../manager/ResManager"),h=e("../../../manager/UIManager"),d="game/xlch/res/dir_table/",f=cc._decorator,g=f.ccclass,y=f.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_start=null,t.bet_num=null,t.clock_di=null,t.clock_num=null,t.turn_blink=[],t.onUpdateTimer=null,t.GameView=null,t}return o(t,e),t.prototype.onLoad=function(){s.default.addClickEventEND(this.btn_start,this.onClickStartEvent.bind(this))},t.prototype.showReady=function(e){this.btn_start.active=e},t.prototype.onClickStartEvent=function(){h.UIManager.showLoading("\u6b63\u5728\u5feb\u901f\u5339\u914d\u4e2d...",!0,function(){l.NetManager.protocolGameCommon.sendCancelMatch()}),this.GameView.resetGameView(),l.NetManager.protocolGameCommon.sendMatchReq(),this.btn_start.active=!1},t.prototype.setLimitBetNum=function(e){this.bet_num.string="\u5e95\u6ce8: "+e},t.prototype.resetClockDi=function(){return a(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return this.turn_blink.forEach(function(e){e.spriteFrame=null,e.node.active=!1}),this.onUpdateTimer&&(this.unschedule(this.onUpdateTimer),this.onUpdateTimer=null,this.clock_num.string=""),e=this.clock_di,[4,p.ResManager.loadResAsync(d+"bg_xlch_di",cc.SpriteFrame)];case 1:return e.spriteFrame=t.sent(),[2]}})})},t.prototype.setClockDi=function(e,t){return a(this,void 0,void 0,function(){var n,o,r,a,s,u;return i(this,function(i){switch(i.label){case 0:return n=t,c.LogWrap.log("\u6e38\u620f\u7aef\u4e1c\u98ce\u4f4d\u7f6e",n),o=this.clock_di,[4,p.ResManager.loadResAsync(d+"bg_xlch_di"+n,cc.SpriteFrame)];case 1:o.spriteFrame=i.sent(),r=e-1,c.LogWrap.log("\u6e38\u620f\u7aef\u6211\u7684\u98ce\u5411\u4f4d\u7f6e",r),a=["east_","south_","west_","north_"],a=this.sliceArray(a,r),s=0,i.label=2;case 2:return s<4?[4,p.ResManager.loadResAsync(d+a[s]+s,cc.SpriteFrame)]:[3,5];case 3:u=i.sent(),this.turn_blink[s].spriteFrame=u,i.label=4;case 4:return s++,[3,2];case 5:return[2]}})})},t.prototype.setClockTime=function(e){var t=this,n=e;this.clock_num.string=n+"",this.onUpdateTimer&&(this.unschedule(this.onUpdateTimer),this.onUpdateTimer=null),this.onUpdateTimer=function(){if(n<0)return t.unschedule(t.onUpdateTimer),void(t.onUpdateTimer=null);t.clock_num.string=n+"",n<=3&&u.AudioManager.playGameSFX("clock"),n--},this.schedule(this.onUpdateTimer,1,cc.macro.REPEAT_FOREVER,.01)},t.prototype.showArrowLight=function(e){this.turn_blink.forEach(function(t,n){t.node.active=e==n})},t.prototype.sliceArray=function(e,t){var n=e.slice(t),o=e.slice(0,t);return n.concat(o)},t.prototype.onDestroy=function(){this.onUpdateTimer&&(this.unschedule(this.onUpdateTimer),this.onUpdateTimer=null)},r([y(cc.Node)],t.prototype,"btn_start",void 0),r([y(cc.Label)],t.prototype,"bet_num",void 0),r([y(cc.Sprite)],t.prototype,"clock_di",void 0),r([y(cc.Label)],t.prototype,"clock_num",void 0),r([y(cc.Sprite)],t.prototype,"turn_blink",void 0),t=r([g],t)}(cc.Component);n.default=C,cc._RF.pop()},{"../../../common/log/LogWrap":void 0,"../../../common/utils/Utils":void 0,"../../../manager/AudioManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0,"../../../manager/UIManager":void 0}],XLCHTingTipsView:[function(e,t,n){"use strict";cc._RF.push(t,"e176403PcxMyJPCYs82xxfH","XLCHTingTipsView");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return s([e,t])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../mahjong/MJCardBase"),s=cc._decorator,u=s.ccclass,l=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprDi=null,t.cardList=null,t.item_card=null,t}return o(t,e),t.prototype.showTingTipsView=function(e){return a(this,void 0,void 0,function(){var t,n,o;return i(this,function(r){switch(r.label){case 0:this.cardList.removeAllChildren(),t=0,r.label=1;case 1:return t<e.length?(n=e[t].ting_card,(o=cc.instantiate(this.item_card)).active=!0,[4,o.getChildByName("MJCard").getComponent(c.default).setSpirteValue(n)]):[3,4];case 2:r.sent(),o.getChildByName("label_fan").getComponent(cc.Label).string=e[t].fan_Nums+"\u756a",o.getChildByName("label_count").getComponent(cc.Label).string=e[t].left_nums+"\u5f20",this.cardList.addChild(o),r.label=3;case 3:return t++,[3,1];case 4:return this.sprDi.active=!0,[2]}})})},t.prototype.hideTingTipsView=function(){this.sprDi.active=!1},r([l(cc.Node)],t.prototype,"sprDi",void 0),r([l(cc.Node)],t.prototype,"cardList",void 0),r([l(cc.Node)],t.prototype,"item_card",void 0),t=r([u],t)}(cc.Component);n.default=p,cc._RF.pop()},{"../../mahjong/MJCardBase":void 0}],XLCHTool:[function(e,t,n){"use strict";cc._RF.push(t,"fbf58mmPQ1JAogpH4n2OT1E","XLCHTool"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("../XLCHDefine"),r=e("../../../manager/NetManager"),a=function(){function e(){}return e.prototype.getLocalIndex=function(e){var t=r.NetManager.getGameProtocol().MY_SEAT,n=e,a=o.XLCHDefine.GAME_PLAYER;return(n-t+a)%a},e.prototype.getDir=function(e,t){var n=o.XLCHDefine.GAME_PLAYER;return(t-e+n)%n},e.prototype.getUserSexByID=function(e){for(var t=0;t<r.NetManager.getGameProtocol().PLAYER_DATAS.length;t++){var n=r.NetManager.getGameProtocol().PLAYER_DATAS[t];if(n.seat_id==e)return n.sex}},e.prototype.getFilteredExcept=function(e,t){return e.filter(function(e){return-1==t.indexOf(e)})},e.prototype.sortCardList=function(e){var t=e.length;if(0==t)return e;for(var n=0;n<t;n++)for(var o=n+1;o<t;o++)if(e[n]>e[o]){var a=e[n];e[n]=e[o],e[o]=a}else e[n],e[o];if(-1!=r.NetManager.getGameProtocol().DingQueCode){var i=0,c=!1,s=0;for(n=0;n<t;n++){var u=e[n];Math.floor(u/10)==r.NetManager.getGameProtocol().DingQueCode&&(i++,c||(c=!0,s=n))}var l=e.splice(s,i);r.NetManager.getGameProtocol().DingQueCards=l,l.forEach(function(t){e.push(t)})}},e.prototype.sliceArray=function(e,t){var n=e.slice(t),o=e.slice(0,t);return n.concat(o)},e.instance=new e,e}();n.default=a.instance,cc._RF.pop()},{"../../../manager/NetManager":void 0,"../XLCHDefine":"XLCHDefine"}],XLCHTop:[function(e,t,n){"use strict";cc._RF.push(t,"631335xJARM84Y75GvauztB","XLCHTop");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,i=a.ccclass,c=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.remain_card=null,t.card_num=null,t}return o(t,e),t.prototype.setRemainCard=function(e){this.remain_card.active=!0,this.card_num.string="\u4f59\u724c"+e},t.prototype.resetView=function(){this.remain_card.active=!1},r([c(cc.Node)],t.prototype,"remain_card",void 0),r([c(cc.Label)],t.prototype,"card_num",void 0),t=r([i],t)}(cc.Component);n.default=s,cc._RF.pop()},{}]},{},["XLCHDefine","ProtocolXLCH","XLCHCmd","XLCHCPGArea","XLCHChangeTips","XLCHDingQue","XLCHDot","XLCHGameScene","XLCHGameView","XLCHHandArea","XLCHHuArea","XLCHOper","XLCHOutArea","XLCHPlayer","XLCHResult","XLCHResultPlayer","XLCHShowArea","XLCHTable","XLCHTingTipsView","XLCHTool","XLCHTop"]);