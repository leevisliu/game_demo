window.__require=function t(e,o,i){function n(r,s){if(!o[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var d=o[r]={exports:{}};e[r][0].call(d.exports,function(t){return n(e[r][1][t]||t)},d,d.exports,t,e,o,i)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({DHTBottomUserPanel:[function(t,e,o){"use strict";cc._RF.push(e,"816aeDfC0pBRpydqEfktOM8","DHTBottomUserPanel");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./DHTUserPanel"),r=t("../../../common/utils/Utils"),s=t("../../../manager/NetManager"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touziZhongKai=null,e.kaiZhongBtn=null,e.jiaoTouBtn=null,e.jiaoTouContent=null,e.touziZhongKaiList=[],e.jiaoTouPage=null,e}return i(e,t),e.prototype.onLoad=function(){r.default.addClickEventEND(this.kaiZhongBtn,this.clickKaiZhong.bind(this)),r.default.addClickEventEND(this.jiaoTouBtn,this.clickJiaoTou.bind(this)),this.ready.active=!1,this.offline.active=!1,this.room_owner.active=!1},e.prototype.reInitViewBottom=function(t){this.reInitView(t),this.setUser(!0),this.showTuoziZhongKai(!1),this.setTouziZhong(!1),this.hideBtns(),this.hideJiaoTouContent()},e.prototype.clickKaiZhong=function(t){s.NetManager.getGameProtocol().sendDiceOperate(2,6,6)},e.prototype.clickJiaoTou=function(t){var e=this;this.jiaoTouContent.active=!0,this.scheduleOnce(function(){e.jiaoTouContent.children[0].getComponent("DHTJiaotouSelect").initNum()},.01)},e.prototype.showTuoziZhongKai=function(t){void 0===t&&(t=!1),this.touziZhongKai.active=t},e.prototype.showJiaoTouContent=function(t,e){if(void 0===e&&(e=!1),this.jiaoTouBtn.active=!0,this.kaiZhongBtn.active=!0,1==t.operate_type?this.kaiZhongBtn.active=!1:2==t.operate_type&&(this.jiaoTouBtn.active=!1),this.jiaoTouContent.childrenCount);else{var o=cc.instantiate(this.jiaoTouPage);this.jiaoTouContent.addChild(o)}this.jiaoTouContent.children[0].getComponent("DHTJiaotouSelect").initNum({numSmall:t.min_num,numBig:14,smallNumSmallDian:t.min_dice}),this.jiaoTouContent.active=e},e.prototype.hideJiaoTouContent=function(){this.jiaoTouContent.active=!1},e.prototype.hideBtns=function(){this.jiaoTouBtn.active=!1,this.kaiZhongBtn.active=!1},e.prototype.initTouziZhongKaiList=function(t){for(var e=0;e<this.touziZhongKaiList.length;e++)this.touziZhongKaiList[e].spriteFrame=t[e]},n([d(cc.Node)],e.prototype,"touziZhongKai",void 0),n([d(cc.Node)],e.prototype,"kaiZhongBtn",void 0),n([d(cc.Node)],e.prototype,"jiaoTouBtn",void 0),n([d(cc.Node)],e.prototype,"jiaoTouContent",void 0),n([d(cc.Sprite)],e.prototype,"touziZhongKaiList",void 0),n([d(cc.Prefab)],e.prototype,"jiaoTouPage",void 0),e=n([l],e)}(a.default);o.default=u,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0,"./DHTUserPanel":"DHTUserPanel"}],DHTCmd:[function(t,e,o){"use strict";cc._RF.push(e,"6335fMlI0VOhatePdX2e5v7","DHTCmd"),Object.defineProperty(o,"__esModule",{value:!0}),o.DHTCmd="22_0",o.ProtocolDHTCmd={ErrorResp:o.DHTCmd+"_err_res",GameStartNotify:o.DHTCmd+"_game_start_notify",DiceListNotify:o.DHTCmd+"_dice_list_notify",StartRandomNotify:o.DHTCmd+"_start_random_notify",StartOperateNotify:o.DHTCmd+"_start_operate_notify",DiceOperateNotify:o.DHTCmd+"_dice_operate_notify",GameResultNotify:o.DHTCmd+"_game_result_notify",GameReconnectInfo:o.DHTCmd+"_game_reconnect_info"},cc._RF.pop()},{}],DHTGameScene:[function(t,e,o){"use strict";cc._RF.push(e,"57781jrUnxAU6mnVyvm14gz","DHTGameScene");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./DHTGameView"),r=t("../../manager/EventManager"),s=t("../../net/NetCmd"),c=t("../../manager/UIManager"),l=t("./net/DHTCmd"),d=t("../../Define"),u=t("../../manager/DataManager"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dhtGameView=null,e}return i(e,t),e.prototype.onLoad=function(){c.UIManager.hideMarquee(),r.EventManager.on(this,s.ProtocolGameCmd.GameLoginResp,this.onGameLoginResp.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.LoginFriendRoomResp,this.onLoginFriendRoomResp.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.LoginFriendRoomNotify,this.onLoginFriendRoomNotify.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.DisconnectRoomNotify,this.onDisconnectRoomNotify.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.MatchResp,this.onMatchResp.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.CancelMatchResp,this.onCancelMatchResp.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.AdJustReadyResp,this.onAdJustReadyResp.bind(this)),r.EventManager.on(this,s.ProtocolGameCmd.ChangeCreaterRes,this.onChangeCreaterRes.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.GameStartNotify,this.onGameStartNotify.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.DiceListNotify,this.onDiceListNotify.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.StartRandomNotify,this.onStartRandomNotify.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.StartOperateNotify,this.onStartOperateNotify.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.DiceOperateNotify,this.onDiceOperateNotify.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.GameResultNotify,this.onGameResultNotify.bind(this)),r.EventManager.on(this,l.ProtocolDHTCmd.GameReconnectInfo,this.onGameReconnectInfo.bind(this)),r.EventManager.on(this,d.EventDef.UpdateUserGold,this.onUpdateUserScore.bind(this))},e.prototype.onGameLoginResp=function(t){this.dhtGameView.initView(),this.dhtGameView.setBaseNote(t.room_info.room_base_note)},e.prototype.onLoginFriendRoomResp=function(t){var e=this;this.dhtGameView.gameType=1,this.dhtGameView.setRoomId(t.room_id),this.dhtGameView.setBaseNote(t.room_info.room_base_note),this.dhtGameView.playDatalist=t.player_info,this.dhtGameView.initView(),this.dhtGameView.initUser(),this.dhtGameView.playDatalist.forEach(function(t,o){var i=t.creater_state,n=u.DataManager.userInfo.userid==t.player_id?0:1;e.dhtGameView.userList[n].setRoomOwner(1==i)}),this.dhtGameView.onSetStartCountDown(!1)},e.prototype.onLoginFriendRoomNotify=function(t){var e=t.player_info;if(t.is_add)console.log("\u6709\u4eba\u52a0\u5165"),this.dhtGameView.playDatalist=this.dhtGameView.playDatalist.concat(e),this.dhtGameView.userList[1].setUserInfo(e),this.dhtGameView.userList[1].setUserEvent(e.player_id),this.dhtGameView.showFriendPlayerState(1,e.state);else if(t.is_offline){console.log("\u6709\u4eba\u6389\u7ebf\u56de\u6765");for(var o=0;o<this.dhtGameView.playDatalist.length;o++){if(this.dhtGameView.playDatalist[o].player_id==e.player_id){this.dhtGameView.playDatalist[o]=e;break}}this.dhtGameView.userList[1].setUserInfo(e),this.dhtGameView.showFriendPlayerState(1,e.state)}else if(t.is_leave){console.log("\u6709\u4eba\u79bb\u5f00\u6216\u8005\u88ab\u8e22");for(o=0;o<this.dhtGameView.playDatalist.length;o++){if(this.dhtGameView.playDatalist[o].player_id==e.player_id){this.dhtGameView.playDatalist.splice(o,1);break}}this.dhtGameView.userList[1].reInitView(this.dhtGameView)}},e.prototype.onDisconnectRoomNotify=function(t){var e=this;this.dhtGameView.playDatalist&&this.dhtGameView.playDatalist.forEach(function(o,i){o.player_id==t.userid&&(o.state=2,e.dhtGameView.userList[1].setUserInfo(o),e.dhtGameView.showFriendPlayerState(1,o.state))})},e.prototype.onMatchResp=function(t){1==t.status?(console.log("\u5339\u914d\u6210\u529f====>",t),c.UIManager.hideLoading()):2==t.status||4==t.status?(c.UIManager.showTips(2==t.status?"\u5339\u914d\u8d85\u65f6":"\u91d1\u5e01\u4e0d\u8db3"),this.dhtGameView.showReady(),c.UIManager.hideLoading()):3==t.status?(console.log("\u5339\u914d\u88ab\u53d6\u6d88"),c.UIManager.hideLoading()):100==t.status&&(c.UIManager.showTips("\u5339\u914d\u5931\u8d25"),this.dhtGameView.showReady(),c.UIManager.hideLoading())},e.prototype.onCancelMatchResp=function(t){c.UIManager.showTips(t.ok?"\u53d6\u6d88\u5339\u914d\u6210\u529f":"\u53d6\u6d88\u5339\u914d\u5931\u8d25"),t.ok&&this.dhtGameView.showReady()},e.prototype.onAdJustReadyResp=function(t){var e=this;this.dhtGameView.playDatalist&&this.dhtGameView.playDatalist.forEach(function(o,i){if(o.player_id==t.player_id){o.state=t.ret;var n=null;if(n=u.DataManager.userInfo.userid==t.player_id?0:1,e.dhtGameView.showFriendPlayerState(n,o.state),0==n){var a=e.dhtGameView.resultContent.getChildByName("dhtResultView");if(a)a.getComponent("DHTResultView").showFriendReadyBtn();else e.dhtGameView.showReady()}}})},e.prototype.onChangeCreaterRes=function(t){if(0==t.ret){this.dhtGameView.resultContent.destroyAllChildren(),this.dhtGameView.userList.forEach(function(t){t.setRoomOwner(!1)});var e=u.DataManager.userInfo.userid==t.creater_id?0:1;if(this.dhtGameView.userList[e].setRoomOwner(!0),this.dhtGameView.userList[e].setReadyIcon(!1),this.dhtGameView.playDatalist){for(var o=0;o<this.dhtGameView.playDatalist.length;o++){if((i=this.dhtGameView.playDatalist[o]).player_id==t.creater_id){i.state=6;break}}for(o=0;o<this.dhtGameView.playDatalist.length;o++){var i;if((i=this.dhtGameView.playDatalist[o]).player_id==t.old_creater_id){i.state=6;break}}u.DataManager.userInfo.userid!=t.old_creater_id&&u.DataManager.userInfo.userid!=t.creater_id||(this.dhtGameView.setChecked(!1),this.dhtGameView.onSetStartCountDown(!1))}this.dhtGameView.showReady()}},e.prototype.onGameStartNotify=function(t){this.dhtGameView.showStartView(t)},e.prototype.onDiceListNotify=function(t){this.dhtGameView.touziZhongAnima(t)},e.prototype.onStartRandomNotify=function(t){this.dhtGameView.selectAnima(t)},e.prototype.onStartOperateNotify=function(t){this.dhtGameView.waitOperate(t)},e.prototype.onDiceOperateNotify=function(t){this.dhtGameView.getOperate(t)},e.prototype.onGameResultNotify=function(t){var e=this;setTimeout(function(){e.dhtGameView.initResultContent(t)},100)},e.prototype.onGameReconnectInfo=function(t){this.dhtGameView.initReconnect(t)},e.prototype.onUpdateUserScore=function(){this.dhtGameView.onUpdateUserScore()},e.prototype.onDestroy=function(){r.EventManager.off(this)},n([f(a.default)],e.prototype,"dhtGameView",void 0),e=n([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Define":void 0,"../../manager/DataManager":void 0,"../../manager/EventManager":void 0,"../../manager/UIManager":void 0,"../../net/NetCmd":void 0,"./DHTGameView":"DHTGameView","./net/DHTCmd":"DHTCmd"}],DHTGameView:[function(t,e,o){"use strict";cc._RF.push(e,"93fdcpzL29BV6N7sgFewKjl","DHTGameView");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},a=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))(function(n,a){function r(t){try{c(i.next(t))}catch(t){a(t)}}function s(t){try{c(i.throw(t))}catch(t){a(t)}}function c(t){t.done?n(t.value):new o(function(e){e(t.value)}).then(r,s)}c((i=i.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,i,n,a,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(n=(n=r.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){r.label=a[1];break}if(6===a[0]&&r.label<n[1]){r.label=n[1],n=a;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(a);break}n[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{o=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./ui/DHTUserPanel"),c=t("./ui/DHTBottomUserPanel"),l=t("../public/TimeClock"),d=t("../../manager/AudioManager"),u=t("../../common/utils/Utils"),p=t("../../manager/DataManager"),h=t("../../manager/UIManager"),f=t("../../manager/NetManager"),m=t("../../manager/ResManager"),y=t("../../view/common/GameChat"),g=t("../../common/log/LogWrap"),_=t("../../Define"),v=cc._decorator,b=v.ccclass,C=v.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alarm_clock=null,e.baseNodeLabel=null,e.roomCodeLabel=null,e.roomIdLabel=null,e.roomIdNode=null,e.twiceLabel=null,e.twiceNode=null,e.clockLabel=null,e.clockNode=null,e.startBtn=null,e.btn_dissolution=null,e.btn_frined_start=null,e.toggle_ready=null,e.btn_club_invite=null,e.btn_ready=null,e.btn_cancel_ready=null,e.label_startTime=null,e.selectNode=null,e.selectArrow=null,e.userList=[],e.bottomUser=null,e.recordContent=null,e.resultContent=null,e.recordView=null,e.resultView=null,e.touziDianSpriteFrame=[],e.touziShenSpriteFrame=[],e.recordViewCom=null,e.roomUserInfo=[],e.playDatalist=null,e.gameType=0,e.isStartGame=!1,e.isChecked=!1,e.onStartSchedule=null,e}return i(e,t),e.prototype.onLoad=function(){d.AudioManager.playGameBGM("dht_bgm.mp3"),this.initChat(),this.toggle_ready.on("toggle",this.onClickToggle.bind(this)),this.toggle_ready.getComponent(cc.Toggle).isChecked=!1},e.prototype.initChat=function(){return a(this,void 0,void 0,function(){var t,e,o;return r(this,function(i){switch(i.label){case 0:return[4,m.ResManager.loadResAsync("prefabs/common/GameChat",cc.Prefab,!1)];case 1:return(t=i.sent())&&cc.isValid(this.node)&&!this.node.getChildByName("GameChat")&&(e=cc.instantiate(t),this.node.addChild(e),(o=e.getComponent(y.default)).setTalkPositionY(40),o.setTalkPositionX(.022,!1)),[2]}})})},e.prototype.initView=function(){this.node.stopAllActions(),this.initRecordContent(),this.onKillTimer(),this.twiceNode.active=!1,this.showReady(),this.setTwice(1,!1),this.userList[1].reInitView(this),this.bottomUser.reInitViewBottom(this);var t={username:u.default.getSubStringLengTxt(p.DataManager.userInfo.nickname)||u.default.getReplaceStrToStar(p.DataManager.userInfo.userid),gold:p.DataManager.userInfo.gold,headimg_id:p.DataManager.userInfo.headimgurl,vip_level:p.DataManager.userInfo.vip_level};this.bottomUser.setUserInfo(t),u.default.removeClickEvent(this.startBtn),u.default.addClickEventEND(this.startBtn,this.startMatch.bind(this)),u.default.removeClickEvent(this.btn_dissolution),u.default.addClickEventEND(this.btn_dissolution,this.clickDiss.bind(this)),u.default.removeClickEvent(this.btn_frined_start),u.default.addClickEventEND(this.btn_frined_start,this.clickFriend.bind(this)),u.default.removeClickEvent(this.btn_ready),u.default.addClickEventEND(this.btn_ready,this.onClickReadyEvent.bind(this)),u.default.removeClickEvent(this.btn_cancel_ready),u.default.addClickEventEND(this.btn_cancel_ready,this.onClickReadyEvent.bind(this)),u.default.removeClickEvent(this.btn_club_invite),u.default.addClickEventEND(this.btn_club_invite,this.onClubInviteEvent.bind(this))},e.prototype.initUser=function(){for(var t=0;t<this.playDatalist.length;t++)p.DataManager.userInfo.userid==this.playDatalist[t].player_id?(console.log("\u6211\u7684\u5ea7\u4f4dID\u4e3a->>>>>>",this.playDatalist[t].seat_id),this.userList[0].setUserInfo(this.playDatalist[t]),this.userList[0].setUserEvent(this.playDatalist[t].player_id),this.userList[0].node.active=!0):(this.userList[1].setUserInfo(this.playDatalist[t]),this.userList[1].setUserEvent(this.playDatalist[t].player_id),this.userList[1].node.active=!0)},e.prototype.onClickToggle=function(){var t=this.toggle_ready.getComponent(cc.Toggle).isChecked;this.isChecked=t,g.LogWrap.log("\u52fe\u9009\u72b6\u6001!!!!!!!!!!!!!!",t),1==this.gameType&&p.DataManager.isCreaterUser&&this.onSetStartCountDown(t)},e.prototype.setChecked=function(t){this.toggle_ready.getComponent(cc.Toggle).isChecked=t,this.isChecked=t},e.prototype.clickDiss=function(){var t=this.roomIdLabel.string;f.NetManager.protocolGameCommon.sendDismissFriendInquiry(parseFloat(t)||null)},e.prototype.clickFriend=function(){this.onSetStartCountDown(!1),this.initView(),this.initUser();var t=this.roomIdLabel.string;f.NetManager.protocolGameCommon.sendStartFriendGame(parseFloat(t)||null),this.resultContent.childrenCount>0&&this.resultContent.destroyAllChildren()},e.prototype.onClickReadyEvent=function(t){var e=t.name,o=null;"btn_ready"==e?o=0:"btn_cancel_ready"==e&&(o=1),f.NetManager.protocolGameCommon.sendFriendReadyReq(o)},e.prototype.onClubInviteEvent=function(){f.NetManager.protocolChat.sendClubRoomReq()},e.prototype.showReady=function(){this.startBtn.active=!1,this.hideFriendBtn(),1==this.gameType?this.showFriendBtn():this.startBtn.active=!0},e.prototype.setFriendReadyBtn=function(){this.btn_ready.active=!0},e.prototype.hideFriendBtn=function(){this.btn_dissolution.active=!1,this.btn_frined_start.active=!1,this.btn_ready.active=!1,this.btn_cancel_ready.active=!1,this.toggle_ready.opacity=0,this.btn_club_invite.active=!1},e.prototype.showFriendBtn=function(){if(this.toggle_ready.active=!0,this.toggle_ready.opacity=255,p.DataManager.isCreaterUser)this.btn_dissolution.active=!0,this.btn_frined_start.active=!0,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6240\u6709\u73a9\u5bb6\u51c6\u5907\u5b8c\u6210\u540e\u81ea\u52a8\u5f00\u59cb",p.DataManager.roomType==_.RoomType.Club&&(this.btn_dissolution.active=!1,this.btn_club_invite.active=!0);else{for(var t=null,e=0;e<this.playDatalist.length;e++)if(p.DataManager.userInfo.userid==this.playDatalist[e].player_id){t=this.playDatalist[e].state;break}this.btn_ready.active=6==t,this.btn_cancel_ready.active=1==t,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6e38\u620f\u7ed3\u675f\u540e\u81ea\u52a8\u51c6\u5907",p.DataManager.roomType==_.RoomType.Club&&(this.btn_club_invite.active=!0)}},e.prototype.onSetStartCountDown=function(t){var e=this;if(void 0===t&&(t=!0),t){g.LogWrap.log("\u5f00\u59cb\u5012\u8ba1\u65f6-------------------\x3e> \u6e38\u620f\u754c\u9762");var o=5;this.label_startTime.node.active=!0,this.label_startTime.string=o+"",null!=this.onStartSchedule&&(g.LogWrap.log("!=null \u505c\u6b62\u6e38\u620f\u754c\u9762\u5012\u8ba1\u65f6"),this.unschedule(this.onStartSchedule)),this.onStartSchedule=function(){if(o--,e.label_startTime.string=o+"",g.LogWrap.log("%c\u5012\u8ba1\u65f6->>>>>>>>>>>>>>>","color:red",o),o<=0)return e.clickFriend(),e.label_startTime.node.active=!1,void e.unschedule(e.onStartSchedule)},this.schedule(this.onStartSchedule,1,cc.macro.REPEAT_FOREVER)}else this.onStartSchedule&&(g.LogWrap.log("\u505c\u6b62\u6e38\u620f\u754c\u9762\u5012\u8ba1\u65f6\uff01\uff01\uff01\uff01\uff01\uff01\uff01"),this.label_startTime.node.active=!1,this.unschedule(this.onStartSchedule),this.onStartSchedule=null)},e.prototype.setRoomId=function(t){void 0===t&&(t=""),this.roomIdNode.active=!0,this.roomIdLabel.string=t},e.prototype.setBaseNote=function(t){this.baseNodeLabel.string="\u5e95\u6ce8:  "+t},e.prototype.setRoomCode=function(t){this.roomCodeLabel.string=t},e.prototype.getUserSeatid=function(){for(var t=0;t<this.roomUserInfo.length;t++)if(p.DataManager.userInfo.userid==this.roomUserInfo[t].player_id)return this.roomUserInfo[t].seat_id},e.prototype.getLoacalSeatid=function(t){var e=this.getUserSeatid();return(t+this.userList.length-e)%this.userList.length},e.prototype.getPlayerinfo=function(t){for(var e=0;e<this.roomUserInfo.length;e++)if(t==this.roomUserInfo[e].seat_id)return this.roomUserInfo[e]},e.prototype.showStartView=function(t){this.onSetStartCountDown(!1),h.UIManager.hideLoading(),this.isStartGame=!0,f.NetManager.protocolGameCommon.needFlushGold=!1,this.startBtn.active=!1,0!=this.resultContent.childrenCount&&this.resultContent.destroyAllChildren(),this.setRoomCode(t.room_info.room_code),this.roomUserInfo=t.player_list,1==this.gameType&&(this.initView(),this.hideFriendBtn());for(var e=0;e<t.player_list.length;e++)p.DataManager.userInfo.userid==t.player_list[e].player_id?this.bottomUser.setTouziZhong(!0):(this.userList[1].setTouziZhong(!0),this.userList[1].setUserInfo(t.player_list[e]),this.userList[1].node.active=!0);1==this.gameType&&(this.userList.forEach(function(t,e){t.setReadyIcon(!1)}),this.playDatalist.forEach(function(t,e){2!=t.state&&(t.state=3)}),this.initUser()),d.AudioManager.playGameSFX("dht_ysz")},e.prototype.waitOperate=function(t){this.selectNode.active=!1,this.setGameTimer(t),this.setTwice(t.turn,!0);var e=this.getLoacalSeatid(t.seat_id);this.userList[e].setTipContent(!0),this.userList[e].setTipLabel("\u6211\u60f3..."),this.userList[e].setTipTouziIcon(null),0==e&&this.bottomUser.showJiaoTouContent(t)},e.prototype.setTwice=function(t,e){t=t>6?6:t,this.twiceLabel.string="\u7b2c"+t+"/6\u8f6e",this.twiceNode.active=e},e.prototype.getOperate=function(t){this.onKillTimer(),this.pauseAudio(),this.pauseVibrate();var e=this.getLoacalSeatid(t.seat_id);if(this.bottomUser.hideJiaoTouContent(),this.bottomUser.hideBtns(),1==t.operate_type){this.userList[e].setTipContent(!0),this.userList[e].setTipLabel(t.min_num+"\u4e2a"),this.userList[e].setTipTouziIcon(this.touziDianSpriteFrame[t.min_dice-1]),g.LogWrap.log("\u73a9\u5bb6\u558a\u9ab0\u5b50",t.min_num+"\u4e2a"+t.min_dice);var o=1==this.getPlayerinfo(t.seat_id).sex?"male/":"female/";d.AudioManager.playGameSFX(o+t.min_num+"_"+t.min_dice),this.addRecordItem(t)}else if(2==t.operate_type){this.userList[e].setTipContent(!1),this.userList[e].setTipTouziIcon(null),this.userList[e].setSpineKai(!0);o=1==this.getPlayerinfo(t.seat_id).sex?"male/":"female/";d.AudioManager.playGameSFX(o+"kai")}},e.prototype.getTouziIcon=function(t){return this.touziDianSpriteFrame[t]},e.prototype.setGameTimer=function(t){this.onKillTimer();var e=this.getLoacalSeatid(t.seat_id);this.alarm_clock.setGameTimer({limit_time:t.wait_time,playAudio:0==e,vibrate:0==e})},e.prototype.onKillTimer=function(){this.alarm_clock.onKillTimer()},e.prototype.pauseAudio=function(){this.alarm_clock.pauseAudio()},e.prototype.pauseVibrate=function(){this.alarm_clock.pauseVibrate()},e.prototype.setTouziZhongKaiList=function(t){for(var e=[],o=0;o<t.length;o++)e.push(this.touziShenSpriteFrame[t[o]-1]);this.bottomUser.initTouziZhongKaiList(e)},e.prototype.selectAnima=function(t){var e=this;this.selectArrow.stopAllActions(),this.selectArrow.angle=0;var o=this.getLoacalSeatid(t.seat_id),i=0==o?-180:-360,n=cc.sequence(cc.rotateTo(.2,-90),cc.rotateTo(.2,-180),cc.rotateTo(.2,-270),cc.rotateTo(.2,-360),cc.rotateTo(.2,-90),cc.rotateTo(.2,-180)),a=cc.sequence(cc.rotateTo(.25,-90),cc.rotateTo(.25,-180),cc.rotateTo(.25,-270),cc.rotateTo(.25,-360)),r=0==o?n:a,s=cc.sequence(cc.repeat(cc.sequence(cc.rotateTo(.075,-90),cc.rotateTo(.075,-180),cc.rotateTo(.075,-270),cc.rotateTo(.075,-360)),2),r,cc.rotateTo(.5,i),cc.callFunc(function(){e.selectNode.active=!1}));this.selectNode.active=!0,this.selectArrow.runAction(s)},e.prototype.touziZhongAnima=function(t){var e=this;this.bottomUser.touziZhongAnima(function(){e.touziAniCall(t.dice_arr)}),d.AudioManager.playSFX("shake_dice")},e.prototype.touziAniCall=function(t){this.bottomUser.setTouziZhong(!1),this.bottomUser.showTuoziZhongKai(!0),this.setTouziZhongKaiList(t)},e.prototype.initRecordContent=function(){this.recordContent.active=!1,this.recordContent.destroyAllChildren();var t=cc.instantiate(this.recordView);this.recordContent.addChild(t),this.recordViewCom=t.getComponent("DHTRecordView")},e.prototype.addRecordItem=function(t){this.recordContent.active=!0;var e=this.getPlayerinfo(t.seat_id),o=u.default.getSubStringLengTxt(e.username)||u.default.getReplaceStrToStar(e.player_id);this.recordViewCom.addItem(o,t.min_num,this.touziDianSpriteFrame[t.min_dice-1])},e.prototype.initResultContent=function(t){var e=this;this.isStartGame=!1;var o=[];f.NetManager.protocolGameCommon.needFlushGold&&f.NetManager.protocolGameCommon.flushPlayerInfo.forEach(function(t){var i=e.getLoacalSeatid(t.seat_id);g.LogWrap.log("\u4f4d\u7f6e..........",i),o[i]=t.gold});for(var i=0;i<t.player_info_end.length;i++)p.DataManager.userInfo.userid==t.player_info_end[i].player_id?(this.userList[0].setGold(o[0]?o[0]:t.player_info_end[i].gold),p.DataManager.userInfo.gold=parseFloat(o[0]?o[0]:t.player_info_end[i].gold)):this.userList[1].setGold(o[1]?o[1]:t.player_info_end[i].gold),this.playDatalist&&this.playDatalist[i]&&(t.player_info_end[i].player_id==this.playDatalist[i].player_id?this.playDatalist[i].player_id==p.DataManager.userInfo.userid?this.playDatalist[i].gold=o[0]?o[0]:t.player_info_end[i].gold:this.playDatalist[i].gold=o[1]?o[1]:t.player_info_end[i].gold:this.playDatalist[i].player_id==p.DataManager.userInfo.userid?this.playDatalist[i].gold=o[0]?o[0]:t.player_info_end[1-i].gold:this.playDatalist[i].gold=o[1]?o[1]:t.player_info_end[1-i].gold);this.resultContent.destroyAllChildren();var n=cc.instantiate(this.resultView),a=n.getComponent("DHTResultView");if(a.controller=this,a.initView(t),this.resultContent.addChild(n),1==this.gameType){p.DataManager.isCreaterUser&&this.onSetStartCountDown(this.isChecked),this.isStartGame=!1;for(i=0;i<this.playDatalist.length;i++)if(p.DataManager.userInfo.userid==this.playDatalist[i].player_id){this.playDatalist[i].state=6;break}this.isChecked&&!p.DataManager.isCreaterUser&&f.NetManager.protocolGameCommon.sendFriendReadyReq(0)}},e.prototype.initReconnect=function(t){this.isStartGame=!0,this.startBtn.active=!1,this.hideFriendBtn(),this.showStartView(t.game_start_info),t.game_operate_info&&t.game_operate_info.wait_time>0&&this.waitOperate(t.game_operate_info),this.touziAniCall(t.dice_arr);for(var e=0;e<t.game_record.length;e++)this.addRecordItem(t.game_record[e]);this.userList[0].setGold(t.gold)},e.prototype.startMatch=function(){var t=this;h.UIManager.showLoading("\u6b63\u5728\u5feb\u901f\u5339\u914d\u4e2d...",!0,function(){t.cancelMatch()}),this.initView(),f.NetManager.protocolGameCommon.sendMatchReq(),this.startBtn.active=!1},e.prototype.cancelMatch=function(){f.NetManager.protocolGameCommon.sendCancelMatch(),this.showReady()},e.prototype.onUpdateUserScore=function(){this.isStartGame||this.userList[0].setGold(p.DataManager.userInfo.gold+"")},e.prototype.showFriendPlayerState=function(t,e){this.userList[t].setReadyIcon(!1),this.userList[t].setOfflineIcon(!1),1==e?this.userList[t].setReadyIcon(!0):2==e?this.userList[t].setOfflineIcon(!0):3!=e&&6!=e||(this.userList[t].setReadyIcon(!1),this.userList[t].setOfflineIcon(!1))},n([C(l.default)],e.prototype,"alarm_clock",void 0),n([C(cc.Label)],e.prototype,"baseNodeLabel",void 0),n([C(cc.Label)],e.prototype,"roomCodeLabel",void 0),n([C(cc.Label)],e.prototype,"roomIdLabel",void 0),n([C(cc.Node)],e.prototype,"roomIdNode",void 0),n([C(cc.Label)],e.prototype,"twiceLabel",void 0),n([C(cc.Node)],e.prototype,"twiceNode",void 0),n([C(cc.Label)],e.prototype,"clockLabel",void 0),n([C(cc.Node)],e.prototype,"clockNode",void 0),n([C(cc.Node)],e.prototype,"startBtn",void 0),n([C(cc.Node)],e.prototype,"btn_dissolution",void 0),n([C(cc.Node)],e.prototype,"btn_frined_start",void 0),n([C(cc.Node)],e.prototype,"toggle_ready",void 0),n([C(cc.Node)],e.prototype,"btn_club_invite",void 0),n([C(cc.Node)],e.prototype,"btn_ready",void 0),n([C(cc.Node)],e.prototype,"btn_cancel_ready",void 0),n([C(cc.Label)],e.prototype,"label_startTime",void 0),n([C(cc.Node)],e.prototype,"selectNode",void 0),n([C(cc.Node)],e.prototype,"selectArrow",void 0),n([C(s.default)],e.prototype,"userList",void 0),n([C(c.default)],e.prototype,"bottomUser",void 0),n([C(cc.Node)],e.prototype,"recordContent",void 0),n([C(cc.Node)],e.prototype,"resultContent",void 0),n([C(cc.Prefab)],e.prototype,"recordView",void 0),n([C(cc.Prefab)],e.prototype,"resultView",void 0),n([C(cc.SpriteFrame)],e.prototype,"touziDianSpriteFrame",void 0),n([C(cc.SpriteFrame)],e.prototype,"touziShenSpriteFrame",void 0),e=n([b],e)}(cc.Component);o.default=w,cc._RF.pop()},{"../../Define":void 0,"../../common/log/LogWrap":void 0,"../../common/utils/Utils":void 0,"../../manager/AudioManager":void 0,"../../manager/DataManager":void 0,"../../manager/NetManager":void 0,"../../manager/ResManager":void 0,"../../manager/UIManager":void 0,"../../view/common/GameChat":void 0,"../public/TimeClock":void 0,"./ui/DHTBottomUserPanel":"DHTBottomUserPanel","./ui/DHTUserPanel":"DHTUserPanel"}],DHTJiaotouSelect:[function(t,e,o){"use strict";cc._RF.push(e,"e82e4wbHPBEOZWt5TdymEvw","DHTJiaotouSelect");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../common/utils/Utils"),r=t("../../../manager/NetManager"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touziNum=null,e.left=null,e.right=null,e.scrollView=null,e.touziNumContent=null,e.touziListContent=null,e.touziNumBg=[],e.touziData=null,e.touziNumber=null,e.dianNumber=null,e}return i(e,t),e.prototype.onLoad=function(){this.addEventListener()},e.prototype.addEventListener=function(){for(var t=0;t<this.touziListContent.childrenCount;t++){var e=this.touziListContent.children[t];a.default.addClickEventEND(e,this.clickDian.bind(this),t)}a.default.addClickEventEND(this.left,this.leftScroll.bind(this)),a.default.addClickEventEND(this.right,this.rightScroll.bind(this))},e.prototype.leftScroll=function(){var t=Math.abs(this.scrollView.getScrollOffset().x),e=new cc.Vec2(t-70<0?0:t-70,0);this.scrollView.scrollToOffset(e)},e.prototype.rightScroll=function(){var t=this.scrollView.getMaxScrollOffset().x,e=Math.abs(this.scrollView.getScrollOffset().x),o=new cc.Vec2(e+70>t?t:e+70,0);this.scrollView.scrollToOffset(o)},e.prototype.clickDian=function(t,e){this.dianNumber=(6-e)%6+1,r.NetManager.getGameProtocol().sendDiceOperate(1,this.dianNumber,this.touziNumber),this.node.parent.active=!1},e.prototype.clickNum=function(t,e){this.touziNumber=e,this.reInitDian(t,e)},e.prototype.initNum=function(t){var e=this,o=new cc.Vec2(0,0);this.scrollView.scrollToOffset(o),this.touziData=t||this.touziData;for(var i=0;i<this.touziNumContent.childrenCount;i++){this.touziNumContent.children[i].destroy()}this.touziNumContent.destroyAllChildren();var n=function(t){var o=cc.instantiate(r.touziNum);o.active=!0;var i=cc.find("num",o),n=i&&i.getComponent(cc.Label);(n&&(n.string=""+t),r.touziNumContent.addChild(o),a.default.addClickEventEND(o,function(t,i){e.clickNum(t,i);for(var n=0;n<e.touziNumContent.childrenCount;n++){e.touziNumContent.children[n].getComponent(cc.Sprite).spriteFrame=e.touziNumBg[0]}o.getComponent(cc.Sprite).spriteFrame=e.touziNumBg[1]},t),t==r.touziData.numSmall)&&(r.clickNum(o,t),o.getComponent(cc.Sprite).spriteFrame=r.touziNumBg[1])},r=this;for(i=this.touziData.numSmall;i<=this.touziData.numBig;i++)n(i)},e.prototype.onEnable=function(){},e.prototype.reInitDian=function(t,e){if(this.node.parent&&this.node.parent.active)for(var o=e==this.touziData.numSmall,i=0;i<this.touziListContent.childrenCount;i++)-1==e||o&&(7-this.touziData.smallNumSmallDian)%6<i?(this.touziListContent.children[i].opacity=135,this.touziListContent.children[i].pauseSystemEvents(!1)):(this.touziListContent.children[i].opacity=255,this.touziListContent.children[i].resumeSystemEvents(!1))},n([l(cc.Node)],e.prototype,"touziNum",void 0),n([l(cc.Node)],e.prototype,"left",void 0),n([l(cc.Node)],e.prototype,"right",void 0),n([l(cc.ScrollView)],e.prototype,"scrollView",void 0),n([l(cc.Node)],e.prototype,"touziNumContent",void 0),n([l(cc.Node)],e.prototype,"touziListContent",void 0),n([l(cc.SpriteFrame)],e.prototype,"touziNumBg",void 0),e=n([c],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0}],DHTRecordItem:[function(t,e,o){"use strict";cc._RF.push(e,"2b876Jc71xPVbqu6SMEZAmh","DHTRecordItem");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,s=a.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemBg=[],e.nameLabel=null,e.numLabel=null,e.touziIcon=null,e.bgIcon=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t,e,o,i){this.bgIcon.spriteFrame=this.itemBg[t?0:1],this.nameLabel.string=e,this.numLabel.string=o+"\u4e2a",this.nameLabel.node.color=t?cc.color(159,55,34):cc.color(246,224,201),this.numLabel.node.color=t?cc.color(159,55,34):cc.color(246,224,201),this.touziIcon.spriteFrame=i},n([s(cc.SpriteFrame)],e.prototype,"itemBg",void 0),n([s(cc.Label)],e.prototype,"nameLabel",void 0),n([s(cc.Label)],e.prototype,"numLabel",void 0),n([s(cc.Sprite)],e.prototype,"touziIcon",void 0),n([s(cc.Sprite)],e.prototype,"bgIcon",void 0),e=n([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{}],DHTRecordView:[function(t,e,o){"use strict";cc._RF.push(e,"5f6c5H3B/pBDaHX+hxFvDmc","DHTRecordView");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../common/utils/Utils"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scroll_main=null,e.recordViewContent=null,e.recordItem=null,e}return i(e,t),e.prototype.onLoad=function(){this.recordViewContent.destroyAllChildren(),a.default.resetiPhoneXPos(this.node)},e.prototype.addItem=function(t,e,o){var i=cc.instantiate(this.recordItem);i.active=!0;var n=i.getComponent("DHTRecordItem"),a=!(this.recordViewContent.childrenCount%2);n.init(a,t,e,o),this.recordViewContent.addChild(i),this.scroll_main.scrollToBottom(.3)},n([c(cc.ScrollView)],e.prototype,"scroll_main",void 0),n([c(cc.Node)],e.prototype,"recordViewContent",void 0),n([c(cc.Node)],e.prototype,"recordItem",void 0),e=n([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../../../common/utils/Utils":void 0}],DHTResultItem:[function(t,e,o){"use strict";cc._RF.push(e,"4147a4tyGtMeaPgsCPAxJCk","DHTResultItem");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../manager/DataManager"),r=t("../../../common/utils/Utils"),s=t("../../../common/UIHelper"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.sprHead=null,e.vip_frame=null,e.vip_level=null,e.nameLabel=null,e.typeIconKai=null,e.typeIconJiao=null,e.label_gold=null,e.icon_flag=null,e.touziList=[],e.flagFrames=[],e.diFrames=[],e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.initView=function(t,e,o,i){var n=e;this.bg.active=n.player_id==a.DataManager.userInfo.userid,this.bg.getComponent(cc.Sprite).spriteFrame=i?this.diFrames[0]:this.diFrames[1],this.nameLabel.string=r.default.getSubStringLengTxt(n.player_name)||r.default.getReplaceStrToStar(n.player_id),this.typeIconKai.active=!!n.player_type,this.typeIconJiao.active=!n.player_type,this.nameLabel.node.color=i?cc.color(255,255,255):cc.color(192,204,254),this.label_gold.node.color=i?cc.color(255,255,255):cc.color(192,204,254),this.label_gold.string=parseFloat(n.coin_num)>0?"+"+n.coin_num:""+n.coin_num,this.icon_flag.spriteFrame=n.bunko?this.flagFrames[0]:this.flagFrames[1],this.setHeadIcon(e.headimg_id),this.setVipFrame(e.vip_level),this.setVipLevel(e.vip_level);for(var s=0;s<this.touziList.length;s++)this.touziList[s].node.opacity=127.5,n.isShunzi||t.last_dice_value!=n.dice_list[s]||(this.touziList[s].node.opacity=255),n.isShunzi||t.called_one||1!=n.dice_list[s]||(this.touziList[s].node.opacity=255),this.touziList[s].spriteFrame=o[s]},e.prototype.setHeadIcon=function(t){s.default.setHeadIcon(t,this.sprHead)},e.prototype.setVipFrame=function(t){t=t||0,s.default.setHeadFrame(t,this.vip_frame)},e.prototype.setVipLevel=function(t){t=t||0,s.default.setVipLevel(t,this.vip_level)},n([d(cc.Node)],e.prototype,"bg",void 0),n([d(cc.Node)],e.prototype,"sprHead",void 0),n([d(cc.Node)],e.prototype,"vip_frame",void 0),n([d(cc.Node)],e.prototype,"vip_level",void 0),n([d(cc.Label)],e.prototype,"nameLabel",void 0),n([d(cc.Node)],e.prototype,"typeIconKai",void 0),n([d(cc.Node)],e.prototype,"typeIconJiao",void 0),n([d(cc.Label)],e.prototype,"label_gold",void 0),n([d(cc.Sprite)],e.prototype,"icon_flag",void 0),n([d(cc.Sprite)],e.prototype,"touziList",void 0),n([d(cc.SpriteFrame)],e.prototype,"flagFrames",void 0),n([d(cc.SpriteFrame)],e.prototype,"diFrames",void 0),e=n([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../../../manager/DataManager":void 0}],DHTResultView:[function(t,e,o){"use strict";cc._RF.push(e,"cc12dV234hJq5iAU6j7CbB2","DHTResultView");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},a=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))(function(n,a){function r(t){try{c(i.next(t))}catch(t){a(t)}}function s(t){try{c(i.throw(t))}catch(t){a(t)}}function c(t){t.done?n(t.value):new o(function(e){e(t.value)}).then(r,s)}c((i=i.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,i,n,a,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(a){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(n=(n=r.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){r.label=a[1];break}if(6===a[0]&&r.label<n[1]){r.label=n[1],n=a;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(a);break}n[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{o=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../common/utils/Utils"),c=t("../../../manager/DataManager"),l=t("../../../manager/AudioManager"),d=t("../../../manager/NetManager"),u=t("../../../common/log/LogWrap"),p=t("../../../manager/ResManager"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.diceValueLabel=null,e.diceValueIcon=null,e.diceNumLabel=null,e.diceNumIcon=null,e.resultlabel=null,e.spine_flag=null,e.img_di=null,e.closeBtnNode=null,e.nextBtnNode=null,e.shareBtnNode=null,e.toggle_ready=null,e.btn_ready=null,e.btn_cancel_ready=null,e.label_startTime=null,e.resultItem=null,e.resultItemContent=null,e.controller=null,e.win_gold=0,e.onStartSchedule=null,e}return i(e,t),e.prototype.onLoad=function(){s.default.addClickEventEND(this.nextBtnNode,this.nextGame.bind(this)),s.default.addClickEventEND(this.shareBtnNode,this.shareRoom.bind(this)),s.default.addClickEventEND(this.closeBtnNode,this.closeView.bind(this)),s.default.addClickEventEND(this.btn_ready,this.onClickReadyEvent.bind(this)),s.default.addClickEventEND(this.btn_cancel_ready,this.onClickReadyEvent.bind(this))},e.prototype.initView=function(t){this.toggle_ready.getComponent(cc.Toggle).isChecked=!1,this.nextBtnNode.active=!1,0==this.controller.gameType&&(this.nextBtnNode.active=!0),this.diceValueLabel.string="\u53eb\u9ab0: "+t.last_dice_num+"\u4e2a",this.diceValueIcon.spriteFrame=this.controller.getTouziIcon(t.last_dice_value-1);var e=!1,o=-1;this.resultItemContent.destroyAllChildren();for(var i=[],n=0;n<t.player_info_end.length;n++){var a=t.player_info_end[n];a.player_id==c.DataManager.userInfo.userid?i[0]=a:i[1]=a}u.LogWrap.log("\u6392\u5e8f\u540e\u7684\u6570\u636e",i);for(n=0;n<i.length;n++){var r=cc.instantiate(this.resultItem);r.active=!0;for(var s=r.getComponent("DHTResultItem"),d=[],p=i[n].dice_list.sort(),h=[],f=0;f<p.length;f++)t.called_one?0==h.length?h.push(p[f]):p[f]==h[h.length-1]+1&&h.push(p[f]):h[h.length-1]!=p[f]&&h.push(p[f]),d.push(this.controller.getTouziIcon(p[f]-1));5==h.length&&(i[n].isShunzi=!0),console.log(h),c.DataManager.userInfo.userid==i[n].player_id&&(e=i[n].bunko,o=i[n].player_type,this.win_gold=i[n].coin_num),s.initView(t,i[n],d,e),this.resultItemContent.addChild(r)}this.diceNumLabel.string="\u5171\u8ba1: "+t.num+"\u4e2a",this.diceNumIcon.spriteFrame=this.controller.getTouziIcon(t.last_dice_value-1),this.resultlabel.string=!!o==e?"\u5f00\u76c5\u65b9\u8d62":"\u53eb\u9ab0\u65b9\u8d62",this.nextBtnNode.x=0,this.shareBtnNode.active=!1,e?(l.AudioManager.playSFX("game_win"),0==this.controller.gameType&&(this.nextBtnNode.x=180,this.shareBtnNode.active=!0)):l.AudioManager.playSFX("game_lose"),this.setDiFrame(e),this.setFlagFrame(e),1==this.controller.gameType&&(this.toggle_ready.active=!0,this.toggle_ready.off("toggle"),this.toggle_ready.on("toggle",this.onClickToggle.bind(this)),this.toggle_ready.getComponent(cc.Toggle).isChecked=this.controller.isChecked,c.DataManager.isCreaterUser?(this.nextBtnNode.active=!0,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6240\u6709\u73a9\u5bb6\u51c6\u5907\u5b8c\u6210\u540e\u81ea\u52a8\u5f00\u59cb"):(this.btn_ready.active=!0,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6e38\u620f\u7ed3\u675f\u540e\u81ea\u52a8\u51c6\u5907"))},e.prototype.setDiFrame=function(t){return a(this,void 0,void 0,function(){var e,o;return r(this,function(i){switch(i.label){case 0:return e="game/dht/res/",[4,p.ResManager.loadResAsync(t?e+"dht_bk_js_win":e+"dht_bk_js_lose",cc.SpriteFrame)];case 1:return o=i.sent(),this.img_di.spriteFrame=o,[2]}})})},e.prototype.setFlagFrame=function(t){return a(this,void 0,void 0,function(){var e,o;return r(this,function(i){switch(i.label){case 0:return e="game/dht/effect/",[4,p.ResManager.loadResAsync(t?e+"shengli":e+"shibai",sp.SkeletonData)];case 1:return o=i.sent(),this.spine_flag.skeletonData=o,this.spine_flag.setAnimation(0,"animation",!1),[2]}})})},e.prototype.nextGame=function(t){this.node.active=!1,0==this.controller.gameType?this.controller.startMatch():(this.onSetStartCountDown(!1),this.controller.clickFriend()),this.node.parent&&(this.node.parent.removeChild(this.node),this.node.destroy())},e.prototype.shareRoom=function(){var t=parseFloat(this.win_gold+"");d.NetManager.protocolChat.sendChatShareRoomReq(t.toFixed(2))},e.prototype.closeView=function(t){this.node.active=!1,this.controller.initView(),1==this.controller.gameType&&this.controller.initUser(),this.node.parent&&(this.node.parent.removeChild(this.node),this.node.destroy())},e.prototype.onClickReadyEvent=function(t){var e=t.name,o=null;"btn_ready"==e?o=0:"btn_cancel_ready"==e&&(o=1),d.NetManager.protocolGameCommon.sendFriendReadyReq(o)},e.prototype.onClickToggle=function(){var t=this.toggle_ready.getComponent(cc.Toggle).isChecked;this.controller.setChecked(t),1==this.controller.gameType&&c.DataManager.isCreaterUser&&this.onSetStartCountDown(t)},e.prototype.onSetStartCountDown=function(t){var e=this;if(void 0===t&&(t=!0),t){u.LogWrap.log("\u7ed3\u7b97\u754c\u9762\u7684\u5012\u8ba1\u65f6");var o=5;this.label_startTime.node.active=!0,this.label_startTime.string=o+"",null!=this.onStartSchedule&&this.unschedule(this.onStartSchedule),this.onStartSchedule=function(){if(o--,e.label_startTime.string=o+"",o<=0)return e.label_startTime.node.active=!1,void e.unschedule(e.onStartSchedule)},this.schedule(this.onStartSchedule,1,cc.macro.REPEAT_FOREVER)}else this.onStartSchedule&&(this.label_startTime.node.active=!1,this.unschedule(this.onStartSchedule))},e.prototype.showFriendReadyBtn=function(){for(var t=null,e=0;e<this.controller.playDatalist.length;e++)if(c.DataManager.userInfo.userid==this.controller.playDatalist[e].player_id){t=this.controller.playDatalist[e].state;break}this.btn_ready.active=6==t,this.btn_cancel_ready.active=1==t},e.prototype.onDestroy=function(){this.unschedule(this.onStartSchedule),this.onStartSchedule=null},n([m(cc.Label)],e.prototype,"diceValueLabel",void 0),n([m(cc.Sprite)],e.prototype,"diceValueIcon",void 0),n([m(cc.Label)],e.prototype,"diceNumLabel",void 0),n([m(cc.Sprite)],e.prototype,"diceNumIcon",void 0),n([m(cc.Label)],e.prototype,"resultlabel",void 0),n([m(sp.Skeleton)],e.prototype,"spine_flag",void 0),n([m(cc.Sprite)],e.prototype,"img_di",void 0),n([m(cc.Node)],e.prototype,"closeBtnNode",void 0),n([m(cc.Node)],e.prototype,"nextBtnNode",void 0),n([m(cc.Node)],e.prototype,"shareBtnNode",void 0),n([m(cc.Node)],e.prototype,"toggle_ready",void 0),n([m(cc.Node)],e.prototype,"btn_ready",void 0),n([m(cc.Node)],e.prototype,"btn_cancel_ready",void 0),n([m(cc.Label)],e.prototype,"label_startTime",void 0),n([m(cc.Node)],e.prototype,"resultItem",void 0),n([m(cc.Node)],e.prototype,"resultItemContent",void 0),e=n([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../common/log/LogWrap":void 0,"../../../common/utils/Utils":void 0,"../../../manager/AudioManager":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0}],DHTUserPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5cb8aan1dtJB4NMoPH5aGof","DHTUserPanel");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),n=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../common/utils/Utils"),r=t("../../../manager/NetManager"),s=t("../../../common/UIHelper"),c=cc._decorator,l=c.ccclass,d=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.headIcon=null,e.vip_frame=null,e.vip_level=null,e.nameLabel=null,e.goldLabel=null,e.touziZhong=null,e.tipLabel=null,e.tipTouziIcon=null,e.tipContent=null,e.spine_kai=null,e.ready=null,e.offline=null,e.room_owner=null,e.node_touch=null,e.isFriend=!1,e.GameView=null,e.playerID=null,e}return i(e,t),e.prototype.onLoad=function(){this.ready.active=!1,this.offline.active=!1,this.vip_frame.getComponent(cc.Sprite).spriteFrame=null,this.vip_level.getComponent(cc.Sprite).spriteFrame=null},e.prototype.reInitView=function(t){this.GameView=t,this.nameLabel.string="",this.setGold(""),this.setTouziZhong(!1),this.setTipLabel(""),this.setTipTouziIcon(null),this.setTipContent(!1),this.setSpineKai(!1),this.setUser(!1)},e.prototype.setUserInfo=function(t){this.nameLabel.string=a.default.getSubStringLengTxt(t.username)||a.default.getReplaceStrToStar(t.player_id),this.setGold(t.gold),this.setHeadIcon(t.headimg_id),this.setVipFrame(t.vip_level),this.setVipLevel(t.vip_level),1==this.GameView.gameType&&(this.node.active=!0,1==t.state?(this.setReadyIcon(!0),this.setOfflineIcon(!1)):2==t.state?(this.setOfflineIcon(!0),this.setReadyIcon(!1)):3!=t.state&&6!=t.state||(this.setReadyIcon(!1),this.setOfflineIcon(!1)))},e.prototype.setVipFrame=function(t){t=t||0,s.default.setHeadFrame(t,this.vip_frame)},e.prototype.setVipLevel=function(t){t=t||0,s.default.setVipLevel(t,this.vip_level)},e.prototype.setReadyIcon=function(t){this.ready.active=t},e.prototype.setOfflineIcon=function(t){this.offline.active=t},e.prototype.setRoomOwner=function(t){this.room_owner.active=t},e.prototype.setUserEvent=function(t){var e=this;this.playerID=t,this.node_touch.off(cc.Node.EventType.TOUCH_END),this.node_touch.on(cc.Node.EventType.TOUCH_END,function(){r.NetManager.protocolGameCommon.sendLookPlayerInfoReq(e.playerID)})},e.prototype.setUser=function(t){void 0===t&&(t=!1),this.node.active=t},e.prototype.setTouziZhong=function(t){void 0===t&&(t=!1),this.touziZhong.active=t},e.prototype.setHeadIcon=function(t){s.default.setHeadIcon(t,this.headIcon.node)},e.prototype.setGold=function(t){this.goldLabel.string=a.default.getFormatGold(t)},e.prototype.setTipLabel=function(t){this.tipLabel.string=t,this.tipLabel.node.active=!!t},e.prototype.setTipTouziIcon=function(t){this.tipTouziIcon.spriteFrame=t,this.tipTouziIcon.node.active=!!t},e.prototype.setTipContent=function(t){void 0===t&&(t=!1),this.tipContent.active=t},e.prototype.setSpineKai=function(t){void 0===t&&(t=!1),this.spine_kai.node.active=t,t&&(this.spine_kai.clearTracks(),this.spine_kai.setAnimation(0,"animation",!1))},e.prototype.touziZhongAnima=function(t){if(this.touziZhong.active){this.touziZhong.stopAllActions();var e=cc.sequence(cc.rotateTo(.1,20),cc.rotateTo(.1,0),cc.rotateTo(.1,-20),cc.rotateTo(.1,0)),o=cc.sequence(cc.rotateTo(.075,20),cc.rotateTo(.075,0),cc.rotateTo(.075,-20),cc.rotateTo(.075,0));this.touziZhong.runAction(cc.sequence(e,cc.repeat(o,3),cc.callFunc(function(){t&&t()})))}},n([d(cc.Sprite)],e.prototype,"headIcon",void 0),n([d(cc.Node)],e.prototype,"vip_frame",void 0),n([d(cc.Node)],e.prototype,"vip_level",void 0),n([d(cc.Label)],e.prototype,"nameLabel",void 0),n([d(cc.Label)],e.prototype,"goldLabel",void 0),n([d(cc.Node)],e.prototype,"touziZhong",void 0),n([d(cc.Label)],e.prototype,"tipLabel",void 0),n([d(cc.Sprite)],e.prototype,"tipTouziIcon",void 0),n([d(cc.Node)],e.prototype,"tipContent",void 0),n([d(sp.Skeleton)],e.prototype,"spine_kai",void 0),n([d(cc.Node)],e.prototype,"ready",void 0),n([d(cc.Node)],e.prototype,"offline",void 0),n([d(cc.Node)],e.prototype,"room_owner",void 0),n([d(cc.Node)],e.prototype,"node_touch",void 0),e=n([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0}],ProtocolDHT:[function(t,e,o){"use strict";cc._RF.push(e,"741d9fjh6RCTrQX/LVrB53U","ProtocolDHT");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../../manager/DataManager"),a=t("../../../net/ProtocolBase"),r=t("../../../Define"),s=t("../../../manager/EventManager"),c=t("./DHTCmd"),l=t("../../../manager/UIManager"),d=t("../../../manager/NetManager"),u=function(t){function e(){var e=t.call(this,"game/dht/pb")||this;return e.cmd=c.DHTCmd,e.type=r.SocketType.Game,e.pbName="DHT",s.EventManager.on(e,c.ProtocolDHTCmd.ErrorResp,e.onErrorResp.bind(e)),e}return i(e,t),e.prototype.sendDiceOperate=function(t,e,o){var i={player_id:n.DataManager.userInfo.userid,operate_type:t,min_dice:e,min_num:o};console.log("============>\u53d1\u9001\u64cd\u4f5c\u5185\u5bb9"),this.send(i,"dice_operate_req")},e.prototype.onErrorResp=function(t){l.UIManager.showTipsPopup(t.err_msg)},e}(a.default);o.default=u,d.NetManager.protocolCache.ProtocolDHT=u,cc._RF.pop()},{"../../../Define":void 0,"../../../manager/DataManager":void 0,"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../../net/ProtocolBase":void 0,"./DHTCmd":"DHTCmd"}]},{},["DHTGameScene","DHTGameView","DHTCmd","ProtocolDHT","DHTBottomUserPanel","DHTJiaotouSelect","DHTRecordItem","DHTRecordView","DHTResultItem","DHTResultView","DHTUserPanel"]);