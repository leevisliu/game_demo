window.__require=function e(t,o,n){function r(i,s){if(!o[i]){if(!t[i]){var c=i.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+i+"'")}i=c}var d=o[i]={exports:{}};t[i][0].call(d.exports,function(e){return r(t[i][1][e]||e)},d,d.exports,e,t,o,n)}return o[i].exports}for(var a="function"==typeof __require&&__require,i=0;i<n.length;i++)r(n[i]);return r}({CMD_DDZ:[function(e,t,o){"use strict";cc._RF.push(t,"200f7z3uPpAcoj86W/A5Lag","CMD_DDZ"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.zeroMemory=function(e){for(var t=[],o=0;o<e;o++)t[o]=0;return t},e.clone=function(e){return JSON.parse(JSON.stringify(e))},e.INVALE_CHAIR=255,e.GAME_SCENE_FREE=100,e.GAME_SCENE_PLAYING=101,e.GAME_PLAYER=3,e.FLutter_POS=cc.v2(0,120),e.MY_SEAT=-1,e.MY_ID=-1,e.PLAYER_DATAS=[],e.MY_DATA=null,e.LANDLORD_POS=null,e.CALL_BTNS_VPOS=[cc.v2(-260,0),cc.v2(20,0),cc.v2(190,0),cc.v2(360,0)],e.OPER_BTN_VPOS={1:[cc.v2(-260,0),cc.v2(20,0),cc.v2(190,0)],2:cc.v2(20,0)},e.HAND_CARD=[],e.MARKER_CARD=[],e.CARD_TIPS=[],e.TIPS_INDEX=null,e.SEEN_CARD=[],e.LAST_OUT_POS=null,e}();o.default=n,cc._RF.pop()},{}],DDZCmd:[function(e,t,o){"use strict";cc._RF.push(t,"c3f6coMEn9IH6/n2ksgDEN5","DDZCmd"),Object.defineProperty(o,"__esModule",{value:!0}),o.DDZCmd="213_0",o.ProtocolDDZCmd={GameStartNotify:o.DDZCmd+"_game_start_notify",GameSendCardNotify:o.DDZCmd+"_game_send_card_notify",GameLandlordNotify:o.DDZCmd+"_game_landlord_notify",GameLandLordEndNotify:o.DDZCmd+"_game_landlord_end_notify",GameUserOperateNotify:o.DDZCmd+"_game_user_operate_notify",GameRefreshCardNotify:o.DDZCmd+"_game_refresh_card_notify",GameRefreshMarkerNotify:o.DDZCmd+"_game_refresh_marker_notify",GameEndNotify:o.DDZCmd+"_game_end_notify",GameReconnectInfo:o.DDZCmd+"_game_reconnect_info",GameLandLordRes:o.DDZCmd+"_game_landlord_res",GameUserOperateRes:o.DDZCmd+"_game_user_operate_res",GameUserDepositRes:o.DDZCmd+"_game_user_deposit_res",GameErrRes:o.DDZCmd+"_game_err_res",GameSeenCardRes:o.DDZCmd+"_game_seen_card_res"},cc._RF.pop()},{}],DDZFooter:[function(e,t,o){"use strict";cc._RF.push(t,"a3b9bhXLjBI26srgcylQ9CH","DDZFooter");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../model/CMD_DDZ"),i=e("../../../common/utils/Utils"),s=e("../../../manager/NetManager"),c=e("../../../manager/UIManager"),l=e("../../../manager/DataManager"),d=e("../../../common/log/LogWrap"),u=e("../../../Define"),p=2,h=4,f=cc._decorator,v=f.ccclass,_=f.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gold=null,t.btn_add=null,t.lab_remain=null,t.lab_bet=null,t.node_call=null,t.node_oper=null,t.btn_no_out=null,t.btn_tips=null,t.btn_out=null,t.btn_pass=null,t.btn_start=null,t.btn_dissolution=null,t.btn_frined_start=null,t.toggle_ready=null,t.btn_club_invite=null,t.btn_ready=null,t.btn_cancel_ready=null,t.label_startTime=null,t.auto_mask=null,t.btn_cancel_auto=null,t.spr_mask=null,t.btn_gps=null,t.GameView=null,t.call_btns=[],t.IsCheck=!1,t.onStartSchedule=null,t}return n(t,e),t.prototype.onLoad=function(){this.initView(),this.initNode(),this.initEvent()},t.prototype.initView=function(){this.gold.string="",this.lab_remain.string="",this.lab_bet.string="",this.node_call.active=!1,this.node_oper.active=!1,this.btn_pass.active=!1,this.btn_start.active=!1,this.auto_mask.active=!1,this.spr_mask.active=!1},t.prototype.resetView=function(){this.lab_remain.string="",this.lab_bet.string="",this.node_call.active=!1,this.node_oper.active=!1,this.btn_pass.active=!1,this.btn_start.active=!1,this.auto_mask.active=!1,this.spr_mask.active=!1,this.onSetStartCountDown(!1)},t.prototype.initNode=function(){this.call_btns=this.node_call.children},t.prototype.initEvent=function(){var e=this;i.default.addClickEventEND(this.btn_start,this.onClickEvent.bind(this)),i.default.addClickEventEND(this.btn_dissolution,this.clickDiss.bind(this)),i.default.addClickEventEND(this.btn_frined_start,this.clickFriend.bind(this)),i.default.addClickEventEND(this.btn_add,this.onAddEvent.bind(this)),i.default.addClickEventEND(this.btn_no_out,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_tips,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_out,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_pass,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_cancel_auto,this.onClickEvent.bind(this)),this.call_btns.forEach(function(t,o){i.default.addClickEventEND(t,e.onCallEvent.bind(e),o)}),this.toggle_ready.on("toggle",this.onClickToggle.bind(this)),this.toggle_ready.getComponent(cc.Toggle).isChecked=!1,i.default.addClickEventEND(this.btn_ready,this.onClickReadyEvent.bind(this)),i.default.addClickEventEND(this.btn_cancel_ready,this.onClickReadyEvent.bind(this)),i.default.addClickEventEND(this.btn_club_invite,this.onClubInviteEvent.bind(this)),i.default.addClickEventEND(this.btn_gps,this.onClickGPSEvent.bind(this))},t.prototype.clickDiss=function(){var e=this.GameView.TopPanel.room_id.string;s.NetManager.protocolGameCommon.sendDismissFriendInquiry(parseFloat(e)||null)},t.prototype.clickFriend=function(){this.onSetStartCountDown(!1);var e=this.GameView.TopPanel.room_id.string;s.NetManager.protocolGameCommon.sendStartFriendGame(parseFloat(e)||null)},t.prototype.onClickEvent=function(e){var t=e.name;"btn_start"==t?this.sendMatchReq():"btn_cancel_auto"==t&&s.NetManager.getGameProtocol().sendUserDepositReq(!1)},t.prototype.onAddEvent=function(e){},t.prototype.onHandleEvent=function(e){var t=e.name;"btn_no_out"==t||"btn_pass"==t?(s.NetManager.getGameProtocol().sendUserOperateReq(h),this.hideOperateBtns()):"btn_tips"==t?this.GameView.onTipsCard():"btn_out"==t&&this.onSendOutCard()},t.prototype.onSendOutCard=function(){var e=this.GameView.GetOutCard();e.length>0?(s.NetManager.getGameProtocol().sendUserOperateReq(p,e),this.hideOperateBtns()):c.UIManager.showTips("\u8bf7\u9009\u62e9\u8981\u51fa\u7684\u724c")},t.prototype.onCallEvent=function(e,t){s.NetManager.getGameProtocol().sendGrabLandLordReq(t),this.hideViewCallBtn()},t.prototype.sendMatchReq=function(){c.UIManager.showLoading("\u6b63\u5728\u5feb\u901f\u5339\u914d\u4e2d...",!0,function(){s.NetManager.protocolGameCommon.sendCancelMatch()}),this.GameView.resetGameView(),s.NetManager.protocolGameCommon.sendMatchReq(),this.btn_start.active=!1},t.prototype.setUserScore=function(e){this.gold.string=i.default.getFormatGold(e)},t.prototype.setUserRemainCard=function(e){this.lab_remain.string="<color=#D4AE47>\u6211\u5269 </c><color=#ffffff>"+e+"</color><color=#D4AE47> \u5f20</c>"},t.prototype.setGameCurrentBet=function(e){this.lab_bet.string=e},t.prototype.onClickToggle=function(){var e=this.toggle_ready.getComponent(cc.Toggle).isChecked;this.IsCheck=e,1==this.GameView.gameType&&l.DataManager.isCreaterUser&&this.onSetStartCountDown(e)},t.prototype.setChecked=function(e){this.toggle_ready.getComponent(cc.Toggle).isChecked=e,this.IsCheck=e},t.prototype.setGPSButton=function(e){this.btn_gps.active=e},t.prototype.onClickGPSEvent=function(){var e=parseFloat(l.DataManager.friendRoomId);s.NetManager.protocolGameCommon.sendLocationReq(e)},t.prototype.onClubInviteEvent=function(){s.NetManager.protocolChat.sendClubRoomReq()},t.prototype.onClickReadyEvent=function(e){var t=e.name,o=null;"btn_ready"==t?o=0:"btn_cancel_ready"==t&&(o=1),s.NetManager.protocolGameCommon.sendFriendReadyReq(o)},t.prototype.showReadyBtn=function(){this.hideReadyBtn(),0==this.GameView.gameType&&(this.btn_start.active=!0)},t.prototype.hideReadyBtn=function(){this.btn_start.active=!1},t.prototype.showFriendBtn=function(){this.hideFriendBtn(),this.toggle_ready.active=!0,l.DataManager.isCreaterUser?(this.btn_dissolution.active=!0,this.btn_frined_start.active=!0,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6240\u6709\u73a9\u5bb6\u51c6\u5907\u5b8c\u6210\u540e\u81ea\u52a8\u5f00\u59cb",l.DataManager.roomType==u.RoomType.Club&&(this.btn_dissolution.active=!1,this.btn_club_invite.active=!0)):(this.btn_ready.active=6==a.default.MY_DATA.state,this.btn_cancel_ready.active=1==a.default.MY_DATA.state,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6e38\u620f\u7ed3\u675f\u540e\u81ea\u52a8\u51c6\u5907",l.DataManager.roomType==u.RoomType.Club&&(this.btn_club_invite.active=!0))},t.prototype.showFriendReadyBtn=function(){this.btn_ready.active=!0,this.toggle_ready.active=!0,l.DataManager.roomType==u.RoomType.Club&&(this.btn_club_invite.active=!0)},t.prototype.hideFriendBtn=function(){this.btn_dissolution.active=!1,this.btn_frined_start.active=!1,this.btn_ready.active=!1,this.btn_cancel_ready.active=!1,this.toggle_ready.active=!1,this.btn_club_invite.active=!1},t.prototype.onSetStartCountDown=function(e){var t=this;if(void 0===e&&(e=!0),e){var o=5;this.label_startTime.node.active=!0,this.label_startTime.string=o+"";var n=function(){if(o--,d.LogWrap.log("\u5012\u8ba1\u65f6\u65f6\u95f4",o),t.label_startTime.string=o+"",o<=0){d.LogWrap.log("\u5012\u8ba1\u65f6\u7ed3\u675f, \u53d1\u9001\u597d\u53cb\u623f\u5f00\u59cb\u6e38\u620f\u6307\u4ee4");var e=l.DataManager.friendRoomId;return s.NetManager.protocolGameCommon.sendStartFriendGame(parseFloat(e)||null),t.label_startTime.node.active=!1,void t.unschedule(t.onStartSchedule)}};this.onStartSchedule=n,this.schedule(n,1,cc.macro.REPEAT_FOREVER)}else this.onStartSchedule&&(this.label_startTime.node.active=!1,this.unschedule(this.onStartSchedule))},t.prototype.setViewCallBtn=function(e){this.call_btns.forEach(function(e,t){e.active=!1});for(var t=0;t<e.length;t++){var o=e[t],n=this.call_btns[o];n.position=a.default.CALL_BTNS_VPOS[t],n.active=!0}this.node_call.active=!0},t.prototype.hideViewCallBtn=function(){this.node_call.active=!1},t.prototype.setViewOperBtn=function(e){var t=this.node_oper.children;switch(t.forEach(function(e,t){e.active=!1}),e){case 1:t.forEach(function(t,o){t.active=!0,t.position=a.default.OPER_BTN_VPOS[e][o]}),this.node_oper.active=!0;break;case 2:this.btn_out.active=!0,this.btn_out.position=a.default.OPER_BTN_VPOS[e],this.node_oper.active=!0;break;case 3:this.btn_pass.active=!0}},t.prototype.hideOperateBtns=function(){this.node_oper.active=!1,this.btn_pass.active=!1},t.prototype.showAutoMask=function(e){this.auto_mask.active=!!e},t.prototype.showSprMask=function(e){this.spr_mask.active=e},r([_(cc.Label)],t.prototype,"gold",void 0),r([_(cc.Node)],t.prototype,"btn_add",void 0),r([_(cc.RichText)],t.prototype,"lab_remain",void 0),r([_(cc.Label)],t.prototype,"lab_bet",void 0),r([_(cc.Node)],t.prototype,"node_call",void 0),r([_(cc.Node)],t.prototype,"node_oper",void 0),r([_(cc.Node)],t.prototype,"btn_no_out",void 0),r([_(cc.Node)],t.prototype,"btn_tips",void 0),r([_(cc.Node)],t.prototype,"btn_out",void 0),r([_(cc.Node)],t.prototype,"btn_pass",void 0),r([_(cc.Node)],t.prototype,"btn_start",void 0),r([_(cc.Node)],t.prototype,"btn_dissolution",void 0),r([_(cc.Node)],t.prototype,"btn_frined_start",void 0),r([_(cc.Node)],t.prototype,"toggle_ready",void 0),r([_(cc.Node)],t.prototype,"btn_club_invite",void 0),r([_(cc.Node)],t.prototype,"btn_ready",void 0),r([_(cc.Node)],t.prototype,"btn_cancel_ready",void 0),r([_(cc.Label)],t.prototype,"label_startTime",void 0),r([_(cc.Node)],t.prototype,"auto_mask",void 0),r([_(cc.Node)],t.prototype,"btn_cancel_auto",void 0),r([_(cc.Node)],t.prototype,"spr_mask",void 0),r([_(cc.Node)],t.prototype,"btn_gps",void 0),t=r([v],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../Define":void 0,"../../../common/log/LogWrap":void 0,"../../../common/utils/Utils":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../model/CMD_DDZ":"CMD_DDZ"}],DDZGameScene:[function(e,t,o){"use strict";cc._RF.push(t,"f58a1ZHvS5E1JKBSVM02sD/","DDZGameScene");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./model/CMD_DDZ"),i=e("./DDZGameView"),s=e("./DDZTool"),c=e("../../manager/EventManager"),l=e("../../net/NetCmd"),d=e("../../manager/DataManager"),u=e("../../manager/UIManager"),p=e("./net/DDZCmd"),h=e("../../Define"),f=cc._decorator,v=f.ccclass,_=f.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameView=null,t}return n(t,e),t.prototype.onLoad=function(){this.GameView.GameScene=this,this.initData(),this.initEvent()},t.prototype.initData=function(){},t.prototype.initEvent=function(){c.EventManager.on(this,l.ProtocolGameCmd.GameLoginResp,this.onGameLoginResp.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.LoginFriendRoomResp,this.onLoginFriendRoomResp.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.LoginFriendRoomNotify,this.onLoginFriendRoomNotify.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.DisconnectRoomNotify,this.onDisconnectRoomNotify.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.MatchResp,this.onMatchResp.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.CancelMatchResp,this.onCancelMatchResp.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.AdJustReadyResp,this.onAdJustReadyResp.bind(this)),c.EventManager.on(this,l.ProtocolGameCmd.ChangeCreaterRes,this.onChangeCreaterRes.bind(this)),c.EventManager.on(this,h.EventDef.UpdateUserGold,this.onUpdateUserScore.bind(this)),u.UIManager.hideMarquee(),c.EventManager.on(this,p.ProtocolDDZCmd.GameStartNotify,this.onGameStartNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameSendCardNotify,this.onGameSendCardNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameLandlordNotify,this.onGameLandlordNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameLandLordEndNotify,this.onGameLandLordEndNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameUserOperateNotify,this.onGameUserOperateNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameRefreshCardNotify,this.onGameRefreshCardNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameRefreshMarkerNotify,this.onGameRefreshMarkerNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameEndNotify,this.onDDZGameEndNotify.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameReconnectInfo,this.onGameReconnectInfo.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameSeenCardRes,this.onGameSeenCardRes.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameLandLordRes,this.onGameLandLordRes.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameUserOperateRes,this.onGameUserOperateRes.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameUserDepositRes,this.onGameUserDepositRes.bind(this)),c.EventManager.on(this,p.ProtocolDDZCmd.GameErrRes,this.onGameErrRes.bind(this))},t.prototype.onGameLoginResp=function(e){this.GameView.resetGameView(),this.GameView.initPrePareGameView(e)},t.prototype.onLoginFriendRoomResp=function(e){var t=this;this.GameView.gameType=1,this.GameView.TopPanel.setRoomId(e.room_id),this.GameView.resetGameView(),a.default.PLAYER_DATAS=e.player_info,console.log("%c\u6240\u6709\u7528\u6237\u4fe1\u606f======>","color:green",a.default.PLAYER_DATAS),a.default.PLAYER_DATAS.forEach(function(e,t){e.player_id==d.DataManager.userInfo.userid&&(a.default.MY_DATA=e,a.default.MY_SEAT=e.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",e))});var o=JSON.parse(JSON.stringify(e));o.player_info=a.default.MY_DATA,this.GameView.initPrePareGameView(o),this.GameView.initGameView(),a.default.PLAYER_DATAS.forEach(function(e,o){var n=e.creater_state,r=s.default.getInstance().getLocalIndex(e.seat_id);t.GameView.UserPanel[r].setRoomOwner(1==n)})},t.prototype.onLoginFriendRoomNotify=function(e){var t=s.default.getInstance().getLocalIndex(e.player_info.seat_id),o=e.player_info;if(e.is_add)console.log("\u6709\u4eba\u52a0\u5165"),a.default.PLAYER_DATAS=a.default.PLAYER_DATAS.concat(o),this.GameView.UserPanel[t].setUserInfo(o),this.GameView.UserPanel[t].setUserEvent(o.player_id),this.GameView.showFriendPlayerState(t,o.state);else if(e.is_offline){console.log("\u6709\u4eba\u6389\u7ebf\u56de\u6765");for(var n=0;n<a.default.PLAYER_DATAS.length;n++){if(a.default.PLAYER_DATAS[n].player_id==o.player_id){a.default.PLAYER_DATAS[n]=o;break}}this.GameView.UserPanel[t].setUserInfo(o),this.GameView.showFriendPlayerState(t,o.state)}else if(e.is_leave){console.log("\u6709\u4eba\u79bb\u5f00\u6216\u8005\u88ab\u8e22");for(n=0;n<a.default.PLAYER_DATAS.length;n++){if(a.default.PLAYER_DATAS[n].player_id==o.player_id){a.default.PLAYER_DATAS.splice(n,1);break}}this.GameView.UserPanel[t].initPlayerView(),this.GameView.OutCard[t].removeCard(),this.GameView.SeenCard[t].removeCard()}},t.prototype.onDisconnectRoomNotify=function(e){if(a.default.PLAYER_DATAS)for(var t=0;t<a.default.PLAYER_DATAS.length;t++){var o=a.default.PLAYER_DATAS[t];if(o.player_id==e.userid){o.state=2;var n=s.default.getInstance().getLocalIndex(o.seat_id);this.GameView.showFriendPlayerState(n,o.state);break}}},t.prototype.onAdJustReadyResp=function(e){if(a.default.PLAYER_DATAS)for(var t=0;t<a.default.PLAYER_DATAS.length;t++){var o=a.default.PLAYER_DATAS[t];if(o.player_id==e.player_id){var n=s.default.getInstance().getLocalIndex(o.seat_id);o.state=e.ret,this.GameView.showFriendPlayerState(n,o.state),0==n&&this.GameView.showReady();break}}},t.prototype.onChangeCreaterRes=function(e){if(0==e.ret){this.GameView.UserPanel.forEach(function(e){e.setRoomOwner(!1)});var t=s.default.getInstance().getLocalIndex(e.creater_seat_id);if(this.GameView.UserPanel[t].setRoomOwner(!0),this.GameView.UserPanel[t].setReadyIcon(!1),a.default.PLAYER_DATAS){for(var o=0;o<a.default.PLAYER_DATAS.length;o++){if((n=a.default.PLAYER_DATAS[o]).player_id==e.creater_id){n.state=6;break}}for(o=0;o<a.default.PLAYER_DATAS.length;o++){var n;if((n=a.default.PLAYER_DATAS[o]).player_id==e.old_creater_id){n.state=6;break}}d.DataManager.userInfo.userid!=e.old_creater_id&&d.DataManager.userInfo.userid!=e.creater_id||(this.GameView.Footer.setChecked(!1),this.GameView.Footer.onSetStartCountDown(!1))}this.GameView.showReady()}},t.prototype.onMatchResp=function(e){1==e.status?(console.log("\u5339\u914d\u6210\u529f====>",e),u.UIManager.hideLoading()):2==e.status||4==e.status?(u.UIManager.showTips(2==e.status?"\u5339\u914d\u8d85\u65f6":"\u91d1\u5e01\u4e0d\u8db3"),this.GameView.showReady(),u.UIManager.hideLoading()):3==e.status?(console.log("\u5339\u914d\u88ab\u53d6\u6d88"),u.UIManager.hideLoading()):100==e.status&&(u.UIManager.showTips("\u5339\u914d\u5931\u8d25"),this.GameView.showReady(),u.UIManager.hideLoading())},t.prototype.onCancelMatchResp=function(e){u.UIManager.showTips(e.ok?"\u53d6\u6d88\u5339\u914d\u6210\u529f":"\u53d6\u6d88\u5339\u914d\u5931\u8d25"),e.ok&&this.GameView.showReady()},t.prototype.onGameStartNotify=function(e){this.GameView.resetGameView(),a.default.PLAYER_DATAS=e.player_list,console.log("%c\u6240\u6709\u7528\u6237\u4fe1\u606f======>","color:green",a.default.PLAYER_DATAS),a.default.PLAYER_DATAS.forEach(function(e,t){e.player_id==d.DataManager.userInfo.userid&&(a.default.MY_DATA=e,a.default.MY_SEAT=e.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",e))}),this.GameView.initGameView(),this.GameView.onSubStartGame(e)},t.prototype.onGameSendCardNotify=function(e){this.GameView.onSubDealCard(e)},t.prototype.onGameLandlordNotify=function(e){this.GameView.NotifyGrabLandLord(e)},t.prototype.onGameLandLordEndNotify=function(e){this.GameView.onSubGameLandLordEnd(e)},t.prototype.onGameUserOperateNotify=function(e){this.GameView.onNotifyUserPlay(e)},t.prototype.onGameRefreshCardNotify=function(e){this.GameView.onSubRefHandCard(e)},t.prototype.onGameRefreshMarkerNotify=function(e){this.GameView.onSubRefMarker(e)},t.prototype.onDDZGameEndNotify=function(e){this.GameView.onSubGameEnd(e)},t.prototype.onGameReconnectInfo=function(e){this.GameView.recoverGameView(e)},t.prototype.onGameSeenCardRes=function(e){this.GameView.onSubSeenCardRes(e)},t.prototype.onGameLandLordRes=function(e){this.GameView.onSubLandLordRes(e)},t.prototype.onGameUserOperateRes=function(e){this.GameView.onSubUserPlayRes(e)},t.prototype.onGameUserDepositRes=function(e){this.GameView.onSubDepositRes(e)},t.prototype.onGameErrRes=function(e){this.GameView.onSubGameError(e)},t.prototype.onUpdateUserScore=function(){this.GameView.onUpdateUserScore()},t.prototype.onDestroy=function(){c.EventManager.off(this)},r([_(i.default)],t.prototype,"GameView",void 0),t=r([v],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Define":void 0,"../../manager/DataManager":void 0,"../../manager/EventManager":void 0,"../../manager/UIManager":void 0,"../../net/NetCmd":void 0,"./DDZGameView":"DDZGameView","./DDZTool":"DDZTool","./model/CMD_DDZ":"CMD_DDZ","./net/DDZCmd":"DDZCmd"}],DDZGameView:[function(e,t,o){"use strict";cc._RF.push(t,"4d19923nlNInKKtzPXIFPai","DDZGameView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new o(function(t){t(e.value)}).then(i,s)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return c([e,t])}}function c(a){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{o=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./DDZTool"),c=e("./ui/DDZHandCard"),l=e("./ui/DDZOutCard"),d=e("./ui/DDZTopPanel"),u=e("./ui/DDZFooter"),p=e("./ui/DDZUser"),h=e("./model/CMD_DDZ"),f=e("./ui/DDZMarker"),v=e("./ui/DDZOverEffect"),_=e("./ui/DDZSeenCard"),g=e("../../manager/AudioManager"),m=e("../../common/utils/Utils"),y=e("../../manager/DataManager"),C=e("../../manager/UIManager"),D=e("../../manager/ResManager"),b=e("../../view/common/GameChat"),P=e("../../manager/NetManager"),S=cc._decorator,R=S.ccclass,A=S.property,w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TopPanel=null,t.Footer=null,t.UserPanel=[],t.HandCard=null,t.OutCard=[],t.SeenCard=[],t.outEffect=[],t.Marker=null,t.node_gold=null,t.UINode=null,t.gold_frame=null,t.start_game=null,t.over_effect=null,t.share_bg=null,t.btn_ready=null,t.btn_share=null,t.GameScene=null,t.gameType=0,t.isCreaterUser=!1,t.isStartGame=!1,t.winGold=0,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.Footer.GameView=this,this.TopPanel.GameView=this,this.UserPanel.forEach(function(t,o){t.GameView=e}),m.default.addClickEventEND(this.btn_ready,function(){var t=e.UINode.getChildByName("over_effect");t&&t.getComponent(v.default).clearOverEffect(),e.Footer.sendMatchReq()}),m.default.addClickEventEND(this.btn_share,function(){var t=parseFloat(e.winGold+"");P.NetManager.protocolChat.sendChatShareRoomReq(t.toFixed(2)+"")}),g.AudioManager.playGameBGM("ddz_bgm.mp3"),this.initChat()},t.prototype.initChat=function(){return a(this,void 0,void 0,function(){var e,t;return i(this,function(o){switch(o.label){case 0:return[4,D.ResManager.loadResAsync("prefabs/common/GameChat",cc.Prefab,!1)];case 1:return(e=o.sent())&&cc.isValid(this.node)&&!this.node.getChildByName("GameChat")&&(t=cc.instantiate(e),this.node.addChild(t),t.getComponent(b.default).setTalkPositionY()),[2]}})})},t.prototype.initPrePareGameView=function(e){var t=e.player_info,o={username:m.default.getSubStringLengTxt(t.username)||m.default.getReplaceStrToStar(t.player_id),gold:t.gold,headimg_id:t.headimg_id},n=e.room_info.room_base_note;this.TopPanel.setBasicPot(n),this.UserPanel[0].setUserInfo(o),0==e.state&&this.showReady(),1==this.gameType&&this.Footer.setGPSButton(!0)},t.prototype.initGameView=function(){var e=this;h.default.PLAYER_DATAS.forEach(function(t,o){var n=s.default.getInstance().getLocalIndex(t.seat_id);e.UserPanel[n].setUserInfo(t),e.UserPanel[n].setUserEvent(t.player_id)})},t.prototype.initUserView=function(){this.UserPanel.forEach(function(e,t){0!=t?e.initPlayerView():e.resetMyView()})},t.prototype.showReady=function(){0==this.gameType?this.Footer.showReadyBtn():1==this.gameType&&this.Footer.showFriendBtn()},t.prototype.initData=function(){h.default.HAND_CARD=[],h.default.MARKER_CARD=[],h.default.CARD_TIPS=[],h.default.TIPS_INDEX=null,h.default.SEEN_CARD=[],h.default.MY_DATA=[],h.default.PLAYER_DATAS=[],h.default.MY_SEAT=-1,h.default.MY_ID=-1,h.default.LANDLORD_POS=null},t.prototype.resetGameView=function(){this.TopPanel.resetView(),this.HandCard.removeCard(),this.OutCard.forEach(function(e,t){e.removeCard()}),this.SeenCard.forEach(function(e,t){0!=t&&e.removeCard()}),this.UserPanel.forEach(function(e,t){0!=t?e.initPlayerView():e.resetMyView()}),this.Footer.resetView();var e=this.UINode.getChildByName("over_effect");e&&e.getComponent(v.default).clearOverEffect(),this.share_bg.active=!1},t.prototype.hideUserSprOperation=function(e){e||0==e?this.UserPanel[e].hideSprOperation():this.UserPanel.forEach(function(e,t){e.hideSprOperation()})},t.prototype.onSubRefHandCard=function(e){h.default.HAND_CARD=e.card_arr},t.prototype.onSubRefMarker=function(e){this.Marker.refCardCount(e.card_marker_arr)},t.prototype.GetOutCard=function(){return this.HandCard.getShootCard()},t.prototype.recoverGameView=function(e){var t=this;this.initData(),this.resetGameView();var o=e.game_start_notify;h.default.PLAYER_DATAS=o.player_list,console.log("%c\u6240\u6709\u7528\u6237\u4fe1\u606f======>","color:green",h.default.PLAYER_DATAS);for(var n=0;n<h.default.PLAYER_DATAS.length;n++){var r=h.default.PLAYER_DATAS[n];if(r.player_id==y.DataManager.userInfo.userid){h.default.MY_DATA=r,h.default.MY_SEAT=r.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",r);break}}if(this.initGameView(),e.landlord_seat_id){var a=s.default.getInstance().getLocalIndex(e.landlord_seat_id);h.default.LANDLORD_POS=a,this.UserPanel[a].setLandLordIcon(),this.TopPanel.showLandLordCard(e.landlord_extra_card)}var i=e.game_state;e.all_player_data.forEach(function(e,o){var n=s.default.getInstance().getLocalIndex(e.seat_id),r=h.default.LANDLORD_POS==n;if(0==n?(h.default.HAND_CARD=e.card_arr,t.HandCard.initHandCard(e.card_arr),h.default.MARKER_CARD=e.card_marker_arr):e.card_arr.length>0&&t.SeenCard[n].initSeenCard(e.card_arr,r),3==i){var a=e.landlord_mul;0==a?t.UserPanel[n].setSprOperation("bujiao"):-1!=a&&t.UserPanel[n].setSprOperation(a+"fen")}4==e.user_operate&&t.UserPanel[n].setSprOperation("buchu"),e.is_deposit&&0!=n&&t.UserPanel[n].showAutoIcon(!0),t.OutCard[n].initOutPoker(e.cur_out_card_arr,r),t.UserPanel[n].setRemainCardNum(e.remain_card_count),e.remain_card_count>0&&e.remain_card_count<=2&&t.UserPanel[n].showWarning()}),6!=i&&(this.TopPanel.showMarketBtn(!0),this.TopPanel.showAutoBtn(!0)),this.isStartGame=!1,6!=i?(this.isStartGame=!0,this.Footer.hideReadyBtn()):console.log("\u672a\u9690\u85cf\u51c6\u5907\u6309\u94ae, game_state->",i),this.UserPanel.forEach(function(e,t){e.onKillTimer()});var c=o.room_info.room_code;this.TopPanel.setRoomInfo(c),this.Footer.setGameCurrentBet(e.cur_mul),1==this.gameType&&(this.Footer.hideFriendBtn(),this.UserPanel.forEach(function(e,t){e.setReadyIcon(!1)}))},t.prototype.onSubStartGame=function(e){var t=this;C.UIManager.hideLoading(),0==this.gameType?this.Footer.hideReadyBtn():1==this.gameType&&this.Footer.hideFriendBtn(),P.NetManager.protocolGameCommon.needFlushGold=!1,this.isStartGame=!0;var o=e.room_info.room_code;this.TopPanel.setRoomInfo(o),this.Footer.hideReadyBtn();var n=cc.instantiate(this.start_game);this.UINode.addChild(n),this.scheduleOnce(function(){t.UINode.removeChild(n)},1),g.AudioManager.playSFX("start_game"),1==this.gameType&&(this.Footer.hideFriendBtn(),this.UserPanel.forEach(function(e,t){e.setReadyIcon(!1)}))},t.prototype.onSubDealCard=function(e){this.UserPanel.forEach(function(e,t){e.onKillTimer(),0!=t&&e.showAutoIcon(!1)}),this.SeenCard.forEach(function(e,t){0!=t&&e.removeCard()}),this.hideUserSprOperation(),this.Footer.showAutoMask(!1);var t=e.card_arr;h.default.HAND_CARD=t,this.HandCard.dealCardAni(t),this.TopPanel.showAutoBtn(!0),this.TopPanel.showMarketBtn(!0),e.is_reboot&&C.UIManager.showTips("\u672c\u5c40\u65e0\u4eba\u5e84\u5bb6\uff0c\u6e38\u620f\u5c06\u91cd\u65b0\u5f00\u59cb"),this.Footer.setUserRemainCard(17),this.UserPanel[1].setRemainCardNum(17),this.UserPanel[2].setRemainCardNum(17),this.Footer.setGameCurrentBet(1)},t.prototype.onSubSeenCardRes=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id),o=e.card_arr;h.default.SEEN_CARD[t]=o,0!=t&&this.SeenCard[t].initSeenCard(o)},t.prototype.NotifyGrabLandLord=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id);this.UserPanel.forEach(function(e,t){e.onKillTimer()}),this.UserPanel[t].setGameTimer({limit_time:e.time_out,playAudio:0==t,vibrate:0==t}),0==t?this.Footer.setViewCallBtn(e.grab_mul_arr):this.Footer.hideViewCallBtn()},t.prototype.onSubLandLordRes=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id),o=s.default.getInstance().getUserSexByID(e.seat_id);0==t&&this.Footer.hideViewCallBtn();var n=1==o?"male":"female",r=e.landlord_mul;0==r?(this.UserPanel[t].setSprOperation("bujiao"),g.AudioManager.playGameSFX(n+"/bujiao")):(this.UserPanel[t].setSprOperation(r+"fen"),g.AudioManager.playGameSFX(n+"/qiangdizhu")),this.Footer.setGameCurrentBet(e.cur_mul)},t.prototype.onSubGameLandLordEnd=function(e){var t=this;this.UserPanel.forEach(function(e,t){e.onKillTimer()});var o=function(){t.unschedule(o),t.hideUserSprOperation()};this.schedule(o,1,0);var n=s.default.getInstance().getLocalIndex(e.landlord_seat_id),r=e.landlord_extra_card;h.default.LANDLORD_POS=n,0==n?(h.default.HAND_CARD=h.default.HAND_CARD.concat(r),this.HandCard.onAddLandLord(r),this.HandCard.addLandlordSpr()):h.default.SEEN_CARD[n]&&(h.default.SEEN_CARD[n]=h.default.SEEN_CARD[n].concat(r),this.SeenCard[n].initSeenCard(h.default.SEEN_CARD[n],!0)),this.UserPanel[n].setRemainCardNum(20),this.UserPanel[n].setLandLordIcon(!0),this.TopPanel.showLandLordCard(r),this.Footer.setGameCurrentBet(e.cur_mul)},t.prototype.onNotifyUserPlay=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id);if(this.UserPanel.forEach(function(e,t){e.onKillTimer()}),this.Footer.hideOperateBtns(),this.hideUserSprOperation(t),this.Footer.showSprMask(!1),this.OutCard[t].removeCard(),this.UserPanel[t].setGameTimer({limit_time:e.time_out,playAudio:0==t,vibrate:0==t}),0==t){var o=e.oper_type;this.Footer.setViewOperBtn(o),3==o&&this.Footer.showSprMask(!0),h.default.CARD_TIPS=e.card_tips,console.log("\u63d0\u793a\u6570\u7ec4\u96c6\u5408",e.card_tips),h.default.TIPS_INDEX=0}},t.prototype.onTipsCard=function(){var e=h.default.CARD_TIPS[h.default.TIPS_INDEX].card_arr;this.HandCard.shootTipsCard(e),console.log("\u63d0\u793a\u4e0b\u6807",h.default.TIPS_INDEX),h.default.TIPS_INDEX++,h.default.TIPS_INDEX>=h.default.CARD_TIPS.length&&(h.default.TIPS_INDEX=0)},t.prototype.onSubUserPlayRes=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id),o=s.default.getInstance().getUserSexByID(e.seat_id);h.default.LAST_OUT_POS=t,e.card_arr&&this.outCardAni(e);var n=1==o?"male":"female",r=e.remain_card_count;r<=2&&r>0&&(this.UserPanel[t].showWarning(),g.AudioManager.playGameSFX(n+"/remain_"+r)),this.UserPanel[t].setRemainCardNum(r),this.Footer.setGameCurrentBet(e.cur_mul),0!=t&&this.SeenCard[t].initSeenCard(e.seen_card_arr,h.default.LANDLORD_POS==t),4==e.user_operate&&(this.UserPanel[t].setSprOperation("buchu"),g.AudioManager.playGameSFX(n+"/buyao"))},t.prototype.outCardAni=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id),o=s.default.getInstance().getUserSexByID(e.seat_id),n=e.card_arr;0==t&&(this.HandCard.outCardAni(n),n.forEach(function(e,t){var o=h.default.HAND_CARD.indexOf(e);h.default.HAND_CARD.splice(o,1)}));var r=!1;h.default.LANDLORD_POS==t&&(r=!0),n.length>0&&this.OutCard[t].showOutPoker(n,r),this.playCardEffect(e.card_type,t);var a=this.getCardAudio(e),i=1==o?"male":"female";a&&g.AudioManager.playGameSFX(i+"/"+a)},t.prototype.playCardEffect=function(e,t){return a(this,void 0,void 0,function(){var o,n,r,a;return i(this,function(i){switch(i.label){case 0:return n={3:1.5,4:1.5,9:1.2,10:1.2,13:2,14:2.7},(o={3:"shunzi",4:"liandui",9:"feiji",10:"feiji",13:"boom",14:"wangzha"})[e]?[4,D.ResManager.loadResAsync("game/ddz/"+o[e],cc.Prefab)]:[3,2];case 1:if(!(r=i.sent()))return[2];a=cc.instantiate(r),this.outEffect[t].addChild(a),9!=e&&10!=e||2!=t||(a.scaleX=-1),this.scheduleOnce(function(){cc.isValid(a)&&a.destroy()},n[e]),i.label=2;case 2:return[2]}})})},t.prototype.playEndEffect=function(e){return a(this,void 0,void 0,function(){var t,o,n;return i(this,function(r){switch(r.label){case 0:return t="",0==e?t="chuntian":1==e&&(t="fanchun"),[4,D.ResManager.loadResAsync("game/ddz/"+t,cc.Prefab)];case 1:return(o=r.sent())?(n=cc.instantiate(o),this.UINode.addChild(n),this.scheduleOnce(function(){cc.isValid(n)&&n.destroy()},2),[2]):[2]}})})},t.prototype.getCardAudio=function(e){var t,o=e.card_type,n=e.card_arr;if(1==o)t=s.default.getInstance().getCardLogicValue(n[0]);else if(2==o){t="pair_"+s.default.getInstance().getCardLogicValue(n[0])}else if(0!=o){t={3:"shunzi",4:"liandui",5:"three",7:"three_one",8:"three_two",9:"feiji",10:"feiji",11:"four_two",12:"four_two_pair",13:"boom",14:"wangzha"}[o]}return t},t.prototype.onSubDepositRes=function(e){var t=s.default.getInstance().getLocalIndex(e.seat_id);0==t?(this.Footer.showAutoMask(e.is_deposit),this.TopPanel.showAutoBtn(!e.is_deposit)):this.UserPanel[t].showAutoIcon(e.is_deposit)},t.prototype.onSubGameEnd=function(e){this.isStartGame=!1,this.UserPanel.forEach(function(e,t){e.onKillTimer(),e.hideWarning(),e.hideSprOperation()}),this.Footer.showAutoMask(!1),this.TopPanel.hideAutoBtn(),this.TopPanel.hideMarketView(),this.Footer.hideOperateBtns(),this.onGameEndAni(e)},t.prototype.onGameEndAni=function(e){for(var t,o=this,n=[],r=[],a=null,i=h.default.LANDLORD_POS,c=null,l=e.end_player_info,d=0;d<l.length;d++){var u=s.default.getInstance().getLocalIndex(l[d].seat_id),p=l[d].score;if(p<0?r.push(u):n.push(u),0!=u&&u!=h.default.LAST_OUT_POS){var f=u==i;this.OutCard[u].seenOutPoker(l[d].remain_card_arr,f)}0==u&&(this.winGold=p)}-1==r.indexOf(i)?(c=!0,a=r):(c=!1,a=n),t=0==i?e.is_win?0:1:e.is_win?2:3;var _=cc.instantiate(this.over_effect);this.UINode.addChild(_),_.getComponent(v.default).playOverEffect(t),e.is_win&&0==this.gameType&&(this.share_bg.active=!0),e.spring_group>=0&&this.playEndEffect(e.spring_group),this.setGoldAnimation(a,c,function(){var t=[];P.NetManager.protocolGameCommon.needFlushGold&&P.NetManager.protocolGameCommon.flushPlayerInfo.forEach(function(e){var o=s.default.getInstance().getLocalIndex(e.seat_id);t[o]=e.gold});for(var n=function(n){var r=s.default.getInstance().getLocalIndex(l[n].seat_id),a=t[r]?t[r]:parseFloat(l[n].gold),i=l[n].score,c=h.default.FLutter_POS;o.UserPanel[r].flutterScore(i,c,function(){if(o.UserPanel[r].setUserScore(a),n==l.length-1&&(P.NetManager.protocolGameCommon.needFlushGold=!1,0==o.gameType&&(o.initData(),e.is_win||o.showReady()),1==o.gameType)){var t=o.Footer.IsCheck;y.DataManager.isCreaterUser?(o.Footer.showFriendBtn(),o.Footer.onSetStartCountDown(t)):(o.Footer.showFriendReadyBtn(),t&&P.NetManager.protocolGameCommon.sendFriendReadyReq(0))}})},r=0;r<l.length;r++)n(r)})},t.prototype.setGoldAnimation=function(e,t,o){for(var n=this,r=null,a=null,i=h.default.LANDLORD_POS,s=this.UserPanel[i].node.parent.convertToWorldSpaceAR(this.UserPanel[i].getNodePosition()),c=this.node_gold.convertToNodeSpaceAR(s),l=0,d=0;d<e.length;d++)for(var u=e[d],p=this.UserPanel[u].node.parent.convertToWorldSpaceAR(this.UserPanel[u].getNodePosition()),f=this.node_gold.convertToNodeSpaceAR(p),v=0;v<10;v++){var _=new cc.Node;_.addComponent(cc.Sprite),_.getComponent(cc.Sprite).spriteFrame=this.gold_frame,t?(a=f,r=c):(a=c,r=f),_.setPosition(a),this.node_gold.addChild(_);var m=cc.moveTo(.1*v,cc.v2(r.x,r.y)),y=cc.sequence(m,cc.callFunc(function(){++l==10*e.length-1&&(n.node_gold.removeAllChildren(),o&&o())}));_.runAction(y)}g.AudioManager.playSFX("collect_gold")},t.prototype.onSubGameError=function(e){7==e.err_id?(C.UIManager.showTips("\u724c\u578b\u9009\u62e9\u9519\u8bef"),this.Footer.node_oper.active=!0):8==e.err_id&&(C.UIManager.showTips("\u9009\u62e9\u7684\u724c\u578b\u6bd4\u4e0a\u5bb6\u7684\u5c0f"),this.Footer.node_oper.active=!0)},t.prototype.onUpdateUserScore=function(){this.isStartGame||this.Footer.setUserScore(y.DataManager.userInfo.gold)},t.prototype.showFriendPlayerState=function(e,t){this.UserPanel[e].setReadyIcon(!1),this.UserPanel[e].setOfflineIcon(!1),1==t?this.UserPanel[e].setReadyIcon(!0):2==t?this.UserPanel[e].setOfflineIcon(!0):3!=t&&6!=t||(this.UserPanel[e].setReadyIcon(!1),this.UserPanel[e].setOfflineIcon(!1))},r([A(d.default)],t.prototype,"TopPanel",void 0),r([A(u.default)],t.prototype,"Footer",void 0),r([A(p.default)],t.prototype,"UserPanel",void 0),r([A(c.default)],t.prototype,"HandCard",void 0),r([A(l.default)],t.prototype,"OutCard",void 0),r([A(_.default)],t.prototype,"SeenCard",void 0),r([A(cc.Node)],t.prototype,"outEffect",void 0),r([A(f.default)],t.prototype,"Marker",void 0),r([A(cc.Node)],t.prototype,"node_gold",void 0),r([A(cc.Node)],t.prototype,"UINode",void 0),r([A(cc.SpriteFrame)],t.prototype,"gold_frame",void 0),r([A(cc.Prefab)],t.prototype,"start_game",void 0),r([A(cc.Prefab)],t.prototype,"over_effect",void 0),r([A(cc.Node)],t.prototype,"share_bg",void 0),r([A(cc.Node)],t.prototype,"btn_ready",void 0),r([A(cc.Node)],t.prototype,"btn_share",void 0),t=r([R],t)}(cc.Component);o.default=w,cc._RF.pop()},{"../../common/utils/Utils":void 0,"../../manager/AudioManager":void 0,"../../manager/DataManager":void 0,"../../manager/NetManager":void 0,"../../manager/ResManager":void 0,"../../manager/UIManager":void 0,"../../view/common/GameChat":void 0,"./DDZTool":"DDZTool","./model/CMD_DDZ":"CMD_DDZ","./ui/DDZFooter":"DDZFooter","./ui/DDZHandCard":"DDZHandCard","./ui/DDZMarker":"DDZMarker","./ui/DDZOutCard":"DDZOutCard","./ui/DDZOverEffect":"DDZOverEffect","./ui/DDZSeenCard":"DDZSeenCard","./ui/DDZTopPanel":"DDZTopPanel","./ui/DDZUser":"DDZUser"}],DDZHandCard:[function(e,t,o){"use strict";cc._RF.push(t,"a1c49m+OBRKz6PpAhzpriJr","DDZHandCard");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../DDZTool"),i=e("../model/CMD_DDZ"),s=cc.v2(20.5,35.5),c=cc._decorator,l=c.ccclass,d=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.poker=null,t.spr_landlord=null,t.startPos=null,t.maxMovePos=null,t.movePos=null,t.endPos=null,t.cancelPos=null,t.moveCancel=!1,t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){e.onMouseDown(t)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){e.onMouseMove(t)}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){t.stopPropagation(),e.onMouseCancel(t)}),this.node.on(cc.Node.EventType.TOUCH_END,function(t){t.stopPropagation(),e.onMouseUp(t)}),this.node.active=!1},t.prototype.initHandCard=function(e){this.node.active=!0,this.node.removeAllChildren(),a.default.getInstance().sortCardList(e);for(var t=e.length,o=0;o<e.length;o++){var n=cc.instantiate(this.poker),r=n.getComponent("createPoker"),s=e[o];n.zIndex=o,n.scale=1.5,r.createPoker(s),n.position=cc.v2(-(t-1)/2*50+50*o,0),this.node.addChild(n)}this.node.setContentSize(cc.size(117+50*(t-1),162)),0==i.default.LANDLORD_POS&&t>0&&this.addLandlordSpr()},t.prototype.removeCard=function(){for(var e=this.node.childrenCount,t=0;t<e;t++){var o=this.node.children[0];o.stopAllActions(),o.removeFromParent()}},t.prototype.dealCardAni=function(e,t){var o=this;this.node.active=!0,this.removeCard();var n=e.length,r=JSON.parse(JSON.stringify(e));a.default.getInstance().sortCardList(r),r.forEach(function(e,t){var r=cc.instantiate(o.poker);r.getComponent("createPoker").createPoker(e),r.scale=1.5,r.zIndex=t,o.node.addChild(r,t),r.runAction(cc.moveTo(.3,o.calculateVPos(n,t)))}),this.schedule(function(){t&&t()},.3,0,0),this.node.setContentSize(cc.size(117+50*(n-1),162))},t.prototype.outCardAni=function(e){for(var t=this,o=this.node.childrenCount,n=0;n<e.length;n++)for(var r=function(t){var o=a.node.children[t];if(o.getComponent("createPoker").getCardValue()==e[n])return cc.tween(o).by(.2,{position:cc.v2(0,50),opacity:-255}).call(function(){o.removeFromParent()}).start(),"break"},a=this,i=0;i<o;i++){if("break"===r(i))break}this.schedule(function(){t.sortHandCard()},.21,0,0)},t.prototype.onAddLandLord=function(e){a.default.getInstance().sortCardList(i.default.HAND_CARD);for(var t=JSON.parse(JSON.stringify(i.default.HAND_CARD)),o=t.length,n=0;n<17;n++){var r=(d=this.node.children[n]).getComponent("createPoker");r.setShoot(!1);var s=r.getCardValue(),c=t.indexOf(s);d.zIndex=c;var l=this.calculateVPos(o,c);d.runAction(cc.moveTo(.3,l))}for(n=0;n<e.length;n++){var d,u=(d=cc.instantiate(this.poker)).getComponent("createPoker");u.createPoker(e[n]),u.setShoot(!1);c=t.indexOf(e[n]);d.scale=1.5,d.zIndex=c,this.node.insertChild(d,c);l=this.calculateVPos(o,c);d.position=cc.v2(l.x,35),d.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.3,l)))}this.node.sortAllChildren(),this.calculateVSize(o)},t.prototype.shootTipsCard=function(e){for(var t=this,o=this.node.childrenCount,n=0;n<o;n++){this.node.children[n].getComponent("createPoker").setShoot(!1)}e.forEach(function(e,n){for(var r=0;r<o;r++){var a=t.node.children[r].getComponent("createPoker");if(a.getCardValue()==e){a.setShoot(!0);break}}})},t.prototype.sortHandCard=function(){a.default.getInstance().sortCardList(i.default.HAND_CARD);for(var e=JSON.parse(JSON.stringify(i.default.HAND_CARD)),t=e.length,o=0;o<t;o++){var n=this.node.children[o],r=n.getComponent("createPoker");r.createPoker(e[o]),r.setShoot(!1);var s=this.calculateVPos(t,o);n.runAction(cc.moveTo(.1,s))}this.calculateVSize(t),0==i.default.LANDLORD_POS&&t>0&&this.addLandlordSpr()},t.prototype.addLandlordSpr=function(){var e=this.node.children[this.node.childrenCount-1],t=new cc.Node;t.scale=.4,t.addComponent(cc.Sprite),t.getComponent(cc.Sprite).spriteFrame=this.spr_landlord,t.position=s,e.addChild(t)},t.prototype.getShootCard=function(){for(var e=this.node.childrenCount,t=[],o=0;o<e;o++){var n=this.node.children[o].getComponent("createPoker"),r=n.getCardValue();n.getShoot()&&t.push(r)}return t},t.prototype.calculateVPos=function(e,t){var o=e;return cc.v2(-(o-1)/2*50+50*t,0)},t.prototype.calculateVSize=function(e){var t=e,o=cc.size(117+50*(t-1),162);this.node.setContentSize(o)},t.prototype.getCardTouchCount=function(e){for(var t=0,o=0;o<e.childrenCount;o++){e.children[o].active&&t++}return t},t.prototype.getCardIndex=function(e,t,o){var n=0;return n=(o+e.width/2)/50>=t?t-1:(o+e.width/2)/50<=0?0:(o+e.width/2)/50,Math.floor(n)},t.prototype.onMouseDown=function(e){if(e.touch.getLocation()){var t=e.currentTarget.convertToNodeSpaceAR(e.touch.getLocation());this.startPos=t,this.maxMovePos=this.startPos}},t.prototype.onMouseMove=function(e){if(e.touch.getLocation()){var t=e.currentTarget,o=t.convertToNodeSpaceAR(e.touch.getLocation());this.movePos=o;var n=this.getCardTouchCount(t);if(0!=n){if(this.movePos.x<=t.width/-2||this.movePos.x>=t.width/2||this.movePos.y<=t.height/-2||this.movePos.y>=t.height/2)return this.moveCancel||(this.cancelPos=this.movePos),void(this.moveCancel=!0);if(this.moveCancel=!1,this.startPos.x>this.movePos.x){for(var r=this.getCardIndex(t,n,this.movePos.x);r<=this.getCardIndex(t,n,this.startPos.x);r++){t.children[r].getComponent("createPoker").setGrey(!0)}if(this.movePos.x<this.maxMovePos.x)this.maxMovePos=this.movePos;else for(r=this.getCardIndex(t,n,this.maxMovePos.x);r<this.getCardIndex(t,n,this.movePos.x);r++){t.children[r].getComponent("createPoker").setGrey(!1)}}else{for(r=this.getCardIndex(t,n,this.startPos.x);r<=this.getCardIndex(t,n,this.movePos.x);r++){t.children[r].getComponent("createPoker").setGrey(!0)}if(this.movePos.x>this.maxMovePos.x)this.maxMovePos=this.movePos;else if(this.getCardIndex(t,n,this.movePos.x)!=this.getCardIndex(t,n,this.maxMovePos.x))for(r=this.getCardIndex(t,n,this.movePos.x)+1;r<=this.getCardIndex(t,n,this.maxMovePos.x);r++){t.children[r].getComponent("createPoker").setGrey(!1)}}}else console.log("\u6ca1\u6709\u53ef\u70b9\u51fb\u7684\u724c")}},t.prototype.onMouseUp=function(e){if(e.touch.getLocation()){var t=e.currentTarget;this.moveCancel=!1;var o=t.convertToNodeSpaceAR(e.touch.getLocation());this.endPos=o;var n=this.getCardTouchCount(t);if(0!=n){if(this.startPos.x>this.endPos.x)for(var r=this.getCardIndex(t,n,this.endPos.x);r<=this.getCardIndex(t,n,this.startPos.x);r++){var a=(i=t.children[r]).getComponent("createPoker");i.getComponent("createPoker").setShoot(!a.getShoot())}else for(r=this.getCardIndex(t,n,this.startPos.x);r<=this.getCardIndex(t,n,this.endPos.x);r++){a=(i=t.children[r]).getComponent("createPoker");i.getComponent("createPoker").setShoot(!a.getShoot())}for(r=0;r<n;r++){var i;(i=t.children[r]).getComponent("createPoker").setGrey(!1)}}else console.log("\u6ca1\u6709\u53ef\u70b9\u51fb\u7684\u724c")}},t.prototype.onMouseCancel=function(e){if(e.touch.getLocation()){var t=e.currentTarget;this.moveCancel=!1;var o=this.getCardTouchCount(t);if(0!=o){if(this.startPos.x>this.cancelPos.x)for(var n=this.getCardIndex(t,o,this.cancelPos.x);n<=this.getCardIndex(t,o,this.startPos.x);n++){var r=(a=t.children[n]).getComponent("createPoker");a.getComponent("createPoker").setShoot(!r.getShoot())}else for(n=this.getCardIndex(t,o,this.startPos.x);n<=this.getCardIndex(t,o,this.cancelPos.x);n++){r=(a=t.children[n]).getComponent("createPoker");a.getComponent("createPoker").setShoot(!r.getShoot())}for(n=0;n<o;n++){var a;(a=t.children[n]).getComponent("createPoker").setGrey(!1)}}else console.log("\u6ca1\u6709\u53ef\u70b9\u51fb\u7684\u724c")}},r([d(cc.Prefab)],t.prototype,"poker",void 0),r([d(cc.SpriteFrame)],t.prototype,"spr_landlord",void 0),t=r([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../DDZTool":"DDZTool","../model/CMD_DDZ":"CMD_DDZ"}],DDZMarker:[function(e,t,o){"use strict";cc._RF.push(t,"6cd543kpsxLI6W4isx4yTko","DDZMarker");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,i=a.ccclass,s=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.num=[],t.card_content=[4,4,4,4,4,4,4,4,4,4,4,4,4,1,1],t.grey_color=cc.color(163,148,139),t.red_color=cc.color(231,15,15),t}return n(t,e),t.prototype.refCardCount=function(e){var t=this;e.forEach(function(e,o){t.num[o].string=e,t.num[o].node.color=0!=e?t.red_color:t.grey_color})},r([s(cc.Label)],t.prototype,"num",void 0),t=r([i],t)}(cc.Component);o.default=c,cc._RF.pop()},{}],DDZOutCard:[function(e,t,o){"use strict";cc._RF.push(t,"46b599NBhRDJ6aCOmW13cQx","DDZOutCard");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../DDZTool"),i=cc.v2(20.5,35.5),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.poker=null,t.spr_landlord=null,t.ViewPos=0,t}return n(t,e),t.prototype.showOutPoker=function(e,t){var o=this;this.removeCard();var n=(e=a.default.getInstance().sortOutCardList(e)).length;e.forEach(function(e,t){var r=cc.instantiate(o.poker);if(r.getComponent("createPoker").createPoker(e),0==o.ViewPos){r.position=cc.v2(0,0);var a=cc.v2(-(n-1)/2*30+30*t,0);r.runAction(cc.moveTo(.2,a))}else if(1==o.ViewPos){n>10&&(n=10),r.position=cc.v2(0,-50*Math.floor(t/10));a=cc.v2(-30*(n-1-t%10),-50*Math.floor(t/10));r.runAction(cc.moveTo(.2,a))}else if(2==o.ViewPos){r.position=cc.v2(0,-50*Math.floor(t/10));a=cc.v2(30*Math.floor(t%10),-50*Math.floor(t/10));r.runAction(cc.moveTo(.2,a))}o.node.addChild(r)}),t&&n>0&&this.addLandlordSpr()},t.prototype.initOutPoker=function(e,t){var o=this;this.removeCard();var n=(e=a.default.getInstance().sortOutCardList(e)).length;e.forEach(function(e,t){var r=cc.instantiate(o.poker);if(r.getComponent("createPoker").createPoker(e),0==o.ViewPos){r.position=cc.v2(0,0);var a=cc.v2(-(n-1)/2*30+30*t,0);r.setPosition(a)}else if(1==o.ViewPos){n>10&&(n=10),r.position=cc.v2(0,-50*Math.floor(t/10));a=cc.v2(-30*(n-1-t%10),-50*Math.floor(t/10));r.setPosition(a)}else if(2==o.ViewPos){r.position=cc.v2(0,-50*Math.floor(t/10));a=cc.v2(30*Math.floor(t%10),-50*Math.floor(t/10));r.setPosition(a)}o.node.addChild(r)}),t&&n>0&&this.addLandlordSpr()},t.prototype.seenOutPoker=function(e,t){var o=this;this.removeCard(),a.default.getInstance().sortCardList(e);var n=e.length;e.forEach(function(e,t){var r=cc.instantiate(o.poker);if(r.getComponent("createPoker").createPoker(e),0==o.ViewPos){r.position=cc.v2(0,0);var a=cc.v2(-(n-1)/2*30+30*t,0);r.setPosition(a)}else if(1==o.ViewPos){n>10&&(n=10),r.position=cc.v2(0,-50*Math.floor(t/10));a=cc.v2(-30*(n-1-t%10),-50*Math.floor(t/10));r.setPosition(a)}else if(2==o.ViewPos){r.position=cc.v2(0,-50*Math.floor(t/10));a=cc.v2(30*Math.floor(t%10),-50*Math.floor(t/10));r.setPosition(a)}o.node.addChild(r)}),t&&n>0&&this.addLandlordSpr()},t.prototype.addLandlordSpr=function(){var e=this.node.children[this.node.childrenCount-1],t=new cc.Node;t.scale=.4,t.addComponent(cc.Sprite),t.getComponent(cc.Sprite).spriteFrame=this.spr_landlord,t.position=i,e.addChild(t)},t.prototype.removeCard=function(){this.node.removeAllChildren()},r([l(cc.Prefab)],t.prototype,"poker",void 0),r([l(cc.SpriteFrame)],t.prototype,"spr_landlord",void 0),r([l(cc.Integer)],t.prototype,"ViewPos",void 0),t=r([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../DDZTool":"DDZTool"}],DDZOverEffect:[function(e,t,o){"use strict";cc._RF.push(t,"201897hcTtFSYzk5RNIAZa3","DDZOverEffect");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../common/log/LogWrap"),i=e("../../../manager/DataManager"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spine=null,t.spineData=[],t}return n(t,e),t.prototype.playOverEffect=function(e){var t=this;this.spine.clearTracks(),this.spine.skeletonData=this.spineData[e];var o=0==e||2==e?"once":"animation";this.spine.setAnimation(0,o,!1),this.spine.setCompleteListener(function(o){if(a.LogWrap.log("\u6597\u5730\u4e3b\u8fdb\u5165setCompleteListener\u5224\u65ad"),t.spine.setCompleteListener(null),i.DataManager.isFriendGame)return t.spine.clearTracks(),void t.node.removeFromParent();1==e||3==e?(t.spine.clearTracks(),t.node.removeFromParent()):t.spine.setAnimation(0,"loop",!1)})},t.prototype.clearOverEffect=function(){this.spine.clearTracks(),this.node.removeFromParent()},r([l(sp.Skeleton)],t.prototype,"spine",void 0),r([l({type:[sp.SkeletonData],displayName:"\u9aa8\u9abc\u7279\u6548",tooltip:"0: \u5730\u4e3b\u80dc\u5229 1:\u5730\u4e3b\u5931\u8d25 2:\u519c\u6c11\u80dc\u5229 3:\u519c\u6c11\u5931\u8d25"})],t.prototype,"spineData",void 0),t=r([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../common/log/LogWrap":void 0,"../../../manager/DataManager":void 0}],DDZSeenCard:[function(e,t,o){"use strict";cc._RF.push(t,"fe3c9Ewzp9APK/sW1la0dSX","DDZSeenCard");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../DDZTool"),i=cc.v2(20.5,35.5),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.poker=null,t.spr_landlord=null,t.ViewPos=0,t}return n(t,e),t.prototype.initSeenCard=function(e,t){var o=this;this.removeCard(),a.default.getInstance().sortCardList(e);var n=e.length;e.forEach(function(e,t){var r=cc.instantiate(o.poker);if(r.scale=.6,r.getComponent("createPoker").createPoker(e),0==o.ViewPos){r.position=cc.v2(0,0);var a=cc.v2(-(n-1)/2*15+15*t,0);r.setPosition(a)}else if(1==o.ViewPos){n>10&&(n=10),r.position=cc.v2(0,-35*Math.floor(t/10));a=cc.v2(-15*(n-1-t%10),-35*Math.floor(t/10));r.setPosition(a)}else if(2==o.ViewPos){r.position=cc.v2(0,-35*Math.floor(t/10));a=cc.v2(15*Math.floor(t%10),-35*Math.floor(t/10));r.setPosition(a)}o.node.addChild(r)}),t&&n>0&&this.addLandlordSpr()},t.prototype.addLandlordSpr=function(){var e=this.node.children[this.node.childrenCount-1],t=new cc.Node;t.scale=.4,t.addComponent(cc.Sprite),t.getComponent(cc.Sprite).spriteFrame=this.spr_landlord,t.position=i,e.addChild(t)},t.prototype.removeCard=function(){this.node.removeAllChildren()},r([l(cc.Prefab)],t.prototype,"poker",void 0),r([l(cc.SpriteFrame)],t.prototype,"spr_landlord",void 0),r([l(cc.Integer)],t.prototype,"ViewPos",void 0),t=r([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../DDZTool":"DDZTool"}],DDZTips:[function(e,t,o){"use strict";cc._RF.push(t,"d762baccTROBbOUanW8Lq/u","DDZTips");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./DDZTool"),i=0,s=1,c=2,l=3,d=4,u=5,p=6,h=7,f=8,v=9,_=10,g=11,m=12,y=13,C=14,D=cc._decorator,b=D.ccclass,P=(D.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myCards=[],t.validCardDatas=null,t.valueObj={},t.mainValue=[],t.subValue=[],t.boomValue=[],t.valueArr=[],t.getCards=function(){switch(t.validCardDatas.type){case s:t.getSingle();break;case c:t.getDouble();break;case l:t.getLinkSingle();break;case d:t.getLinkDouble();break;case u:t.getThree();break;case p:t.getLinkThree();break;case h:t.getThreeSingle();break;case f:t.getThreeDouble();break;case v:t.getFlySingle();break;case _:t.getFlyDouble();break;case g:t.getFourSingle();break;case m:t.getFourDouble();break;case y:t.getBoom();break;case C:t.getRocket();break;case i:return console.log("\u65e0\u6548\u724c\u578b"),!1;default:return console.log("\u6ca1\u6709\u8fd9\u79cd\u724c\u578b"),!1}var e=[],o=[];t.mainValue.forEach(function(e,n){e.forEach(function(r,a){o[n]||(o[n]=[]);var i=e.length;o[n][a]=t.findCards(r,i)})});[].forEach(function(t,n){for(var r=0;o.length;r++){var a=o[r];e.push(a.concat(t))}});[].forEach(function(t,o){e.push(t)})},t.findhandlebynumber=function(e,o){var n=[];for(var r in e)n=n.concat(t.findCards(e[r],o));return n},t.getValueNumber=function(e){for(var o=t.getValue(e),n={},r=0;r<o.length;r++){var a=o[r];n[a]?n[a]++:n[a]=1}return n},t.getValue=function(e){for(var t=[],o=0;o<e.length;o++){var n=a.default.getInstance().getCardLogicValue(e[o]);t.push(n)}return t},t}return n(t,e),t.prototype.Tips=function(e,t){this.myCards=e,a.default.getInstance().sortDescCardList(this.myCards),this.validCardDatas=t,this.valueObj=this.getValueNumber(this.myCards),this.getCards()},t.prototype.findCards=function(e,t){var o=0,n=[];for(var r in this.myCards){var a=this.myCards[r];if(this.getValue(a)==e&&(o++,n.push(a)),o>=t)return n}return null},t.prototype.findSubCard=function(e,t,o){var n=this,r=JSON.parse(JSON.stringify(this.valueObj));for(var a in e){var i=a,s=e[a];for(var c in r){var l=c,d=r[c];i==l&&(d-s==0?delete r[c]:r[c]=d-s)}}var u=[];for(var p in r){l=p;if((d=r[p])>=t&&u.push(l),u.length==o)break}console.log(u);var h=[];return u.forEach(function(e,o){h.concat(n.findCards(e,t))}),h},t.prototype.turnValueNumber=function(e,t){for(var o={},n=0;n<e.length;n++)o[e[n]]=t},t.prototype.getNumberLink=function(e,t,o){var n=this.validCardDatas.value,r=this.valueObj,a=[],i=[];for(var s in r){var c=parseInt(s);if(console.log("\u724c\u503c",c),c>14){console.log("2 \u9b3c\u724c\u4e0d\u4f5c\u987a\u5b50");break}var l=r[s];if(c>n&&l>=e){if(0==i.length||i[i.length-1]!=c-1?(console.log("\u5e26\u5165\u7684\u9ed8\u8ba4\u724c\u503c",c),i=[c]):(console.log("\u63a8\u5165\u7684\u724c\u503c\u4e3a",c),i.push(c)),i.length==t){console.log("\u63a8\u5165\u7684\u6570\u7ec4\u4e3a",i);var d=[].concat(i);a.push(d),i.splice(0,1)}}else i=[]}return a},t.prototype.getSingle=function(){var e=this,t=this.validCardDatas.value,o=this.valueObj,n=[];for(var r in o)r>t&&n.push(r);n.forEach(function(t,o){var n;n=e.findCards(t,1),e.valueArr.push(n)})},t.prototype.getDouble=function(){var e=this;this.getNumberLink(2,1).forEach(function(t,o){var n;n=e.findCards(t[0],2),e.valueArr.push(n)})},t.prototype.getLinkSingle=function(){var e=this,t=this.validCardDatas.link;this.getNumberLink(1,t).forEach(function(t,o){var n;n=e.findhandlebynumber(t,1),e.valueArr.push(n)})},t.prototype.getLinkDouble=function(){var e=this,t=this.validCardDatas.link;this.getNumberLink(2,t).forEach(function(t,o){var n;n=e.findhandlebynumber(t,2),e.valueArr.push(n)})},t.prototype.getThree=function(){var e=this;this.getNumberLink(3,1).forEach(function(t,o){var n;n=e.findCards(t[0],3),e.valueArr.push(n)})},t.prototype.getLinkThree=function(){var e=this,t=this.validCardDatas.link;this.getNumberLink(3,t).forEach(function(t,o){var n;n=e.findhandlebynumber(t,3),e.valueArr.push(n)})},t.prototype.getThreeSingle=function(){var e=this;this.getNumberLink(3,1).forEach(function(t,o){var n=[];n=e.findCards(t[0],3);var r=e.turnValueNumber(t,3),a=e.findSubCard(r,1,1),i=n.concat(a);e.valueArr.push(i)})},t.prototype.getThreeDouble=function(){var e=this;this.getNumberLink(3,1).forEach(function(t,o){var n=[];n=e.findCards(t[0],3);var r=e.turnValueNumber(t,3),a=e.findSubCard(r,2,1),i=n.concat(a);e.valueArr.push(i)})},t.prototype.getFlySingle=function(){var e=this,t=this.validCardDatas.link;this.getNumberLink(3,t).forEach(function(t,o){var n=[];n=e.findCards(t[0],3);var r=e.turnValueNumber(t,3),a=e.validCardDatas.link,i=e.findSubCard(r,1,a),s=n.concat(i);e.valueArr.push(s)})},t.prototype.getFlyDouble=function(){var e=this,t=this.validCardDatas.link;this.getNumberLink(3,t).forEach(function(t,o){var n=[];n=e.findCards(t[0],3);var r=e.turnValueNumber(t,3),a=e.validCardDatas.link,i=e.findSubCard(r,2,a),s=n.concat(i);e.valueArr.push(s)})},t.prototype.getFourSingle=function(){var e=this;this.getNumberLink(4,1).forEach(function(t,o){var n=[];n=e.findCards(t[0],4);var r=e.turnValueNumber(t,4),a=e.findSubCard(r,1,1),i=n.concat(a);e.valueArr.push(i)})},t.prototype.getFourDouble=function(){var e=this;this.getNumberLink(4,1).forEach(function(t,o){var n=[];n=e.findCards(t[0],4);var r=e.turnValueNumber(t,4),a=e.findSubCard(r,2,1),i=n.concat(a);e.valueArr.push(i)})},t.prototype.getBoom=function(){var e=this;this.getNumberLink(4,1).forEach(function(t,o){var n;n=e.findCards(t[0],4),e.valueArr.push(n)})},t.prototype.getRocket=function(){var e=[],t=this.valueObj;for(var o in t){var n=parseInt(o);(n=t[o])>=16&&e.push(n)}2==e.length&&this.valueArr.push(e)},t.prototype.getNumberLink1=function(e,t,o){var n={5:3,6:3,7:1,8:1,10:1},r=(o=o||[],[]),a=[];for(var i in n){var s=parseInt(i);if(console.log("\u724c\u503c",s),s>3&&n[i]>=2&&-1==o.indexOf(s)){if(0==a.length||a[a.length-1]!=s-1?(console.log("\u5e26\u5165\u7684\u9ed8\u8ba4\u724c\u503c",s),a=[s]):(console.log("\u63a8\u5165\u7684\u724c\u503c\u4e3a",s),a.push(s)),1==a.length){console.log("\u63a8\u5165\u7684\u6570\u7ec4\u4e3a",a);var c=[].concat(a);r.push(c),a.splice(0,1)}}else a=[]}console.log(r)},t=r([b],t)}(cc.Component));o.default=P,cc._RF.pop()},{"./DDZTool":"DDZTool"}],DDZTool:[function(e,t,o){"use strict";cc._RF.push(t,"fcb5bXCxqVPmI6e+IucByTL","DDZTool");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./model/CMD_DDZ"),i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return n(t,e),o=t,t.getInstance=function(){return null==this.instance&&(this.instance=new o),this.instance},t.prototype.getLocalIndex=function(e){var t=a.default.MY_SEAT,o=e,n=a.default.GAME_PLAYER;return(o-t+n)%n},t.prototype.getUserSexByID=function(e){for(var t=0;t<a.default.PLAYER_DATAS.length;t++){var o=a.default.PLAYER_DATAS[t];if(o.seat_id==e)return o.sex}},t.prototype.sortOutCardList=function(e){if(0==e.length)return e;for(var t=[],o={},n=0;n<e.length;n++){var r=this.getCardLogicValue(e[n]);t.push(r)}for(n=0;n<t.length;n++){var a=t[n];o[a]?o[a]++:o[a]=1}var i=[],s=[];for(n=0;n<e.length;n++){o[this.getCardLogicValue(e[n])]>2?i.push(e[n]):s.push(e[n])}this.sortCardList(i),this.sortCardList(s);return i.concat(s)},t.prototype.sortCardList=function(e){var t=e.length;if(0==t)return e;for(var o=0;o<t;o++)for(var n=o+1;n<t;n++)if(this.getCardLogicValue(e[o])<this.getCardLogicValue(e[n])){var r=e[o];e[o]=e[n],e[n]=r}else if(this.getCardLogicValue(e[o])==this.getCardLogicValue(e[n])&&this.getCardLogicColor(e[o])<this.getCardLogicColor(e[n])){r=e[o];e[o]=e[n],e[n]=r}},t.prototype.sortDescCardList=function(e){var t=e.length;if(0==t)return e;for(var o=0;o<t;o++)for(var n=o+1;n<t;n++)if(this.getCardLogicValue(e[o])>this.getCardLogicValue(e[n])){var r=e[o];e[o]=e[n],e[n]=r}else if(this.getCardLogicValue(e[o])==this.getCardLogicValue(e[n])&&this.getCardLogicColor(e[o])<this.getCardLogicColor(e[n])){r=e[o];e[o]=e[n],e[n]=r}},t.prototype.getCardLogicValue=function(e){var t=15&e;return t<=2?t+=13:t>=14&&(t+=2),t},t.prototype.getCardLogicColor=function(e){return(240&e)/16},t=o=r([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{"./model/CMD_DDZ":"CMD_DDZ"}],DDZTopPanel:[function(e,t,o){"use strict";cc._RF.push(t,"f29b4MJLqZLyIegrX1OKDjP","DDZTopPanel");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../../common/utils/Utils"),i=e("../../../manager/NetManager"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_auto=null,t.btn_cancel_auto=null,t.pot_num=null,t.table_num=null,t.btn_marker=null,t.spr_marker=null,t.lanlord_card=null,t.poker=null,t.room_id=null,t.room_id_node=null,t.GameView=null,t}return n(t,e),t.prototype.onLoad=function(){this.initView(),this.addEvenListener()},t.prototype.initView=function(){this.pot_num.string="",this.table_num.string="",this.btn_auto.active=!1,this.btn_cancel_auto.active=!1,this.btn_marker.active=!1,this.spr_marker.active=!1},t.prototype.resetView=function(){this.table_num.string="",this.btn_auto.active=!1,this.btn_cancel_auto.active=!1,this.btn_marker.active=!1,this.spr_marker.active=!1,this.lanlord_card.removeAllChildren()},t.prototype.addEvenListener=function(){a.default.addClickEventEND(this.btn_marker,this.onEvenClickButton.bind(this)),a.default.addClickEventEND(this.btn_auto,this.onAutoClickEvent.bind(this)),a.default.addClickEventEND(this.btn_cancel_auto,this.onAutoClickEvent.bind(this))},t.prototype.onEvenClickButton=function(e){"btn_marker"==e.name&&(this.spr_marker.active=!this.spr_marker.active)},t.prototype.onAutoClickEvent=function(e){var t=e.name;"btn_auto"==t?(i.NetManager.getGameProtocol().sendUserDepositReq(!0),this.btn_cancel_auto.active=!0):"btn_cancel_auto"==t&&(i.NetManager.getGameProtocol().sendUserDepositReq(!1),this.btn_auto.active=!0),e.active=!1},t.prototype.setRoomInfo=function(e){this.table_num.string=e||""},t.prototype.setRoomId=function(e){void 0===e&&(e=""),this.room_id_node.active=!0,this.room_id.string=e},t.prototype.setBasicPot=function(e){this.pot_num.string=e},t.prototype.showAutoBtn=function(e){this.btn_auto.active=e,this.btn_cancel_auto.active=!e},t.prototype.hideAutoBtn=function(){this.btn_auto.active=!1,this.btn_cancel_auto.active=!1},t.prototype.showMarketBtn=function(e){this.btn_marker.active=e},t.prototype.hideMarketView=function(){this.btn_marker.active=!1,this.spr_marker.active=!1},t.prototype.showLandLordCard=function(e){var t=this;this.lanlord_card.removeAllChildren(),e.forEach(function(e,o){var n=cc.instantiate(t.poker),r=n.getComponent("createPoker");r.createPoker(e),r.setCardAni(e),t.lanlord_card.addChild(n)}),this.lanlord_card.active=!0},r([l(cc.Node)],t.prototype,"btn_auto",void 0),r([l(cc.Node)],t.prototype,"btn_cancel_auto",void 0),r([l(cc.Label)],t.prototype,"pot_num",void 0),r([l(cc.Label)],t.prototype,"table_num",void 0),r([l(cc.Node)],t.prototype,"btn_marker",void 0),r([l(cc.Node)],t.prototype,"spr_marker",void 0),r([l(cc.Node)],t.prototype,"lanlord_card",void 0),r([l(cc.Prefab)],t.prototype,"poker",void 0),r([l(cc.Label)],t.prototype,"room_id",void 0),r([l(cc.Node)],t.prototype,"room_id_node",void 0),t=r([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0}],DDZUser:[function(e,t,o){"use strict";cc._RF.push(t,"d1dc8N7GaNAQZSv/s9gJxCR","DDZUser");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../public/TimeClock"),i=e("./DDZFooter"),s=e("../../../common/utils/Utils"),c=e("../../../manager/NetManager"),l=e("../../../common/UIHelper"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.head=null,t.nickname=null,t.gold=null,t.flutter=null,t.yellow_bmfont=null,t.grey_bmfont=null,t.landlord=null,t.sprOper=null,t.sprRemain=null,t.remainCount=null,t.auto_icon=null,t.alarm_clock=null,t.warning=null,t.user_oper_font=null,t.ready=null,t.offline=null,t.room_owner=null,t.Footer=null,t.GameView=null,t.ViewPos=0,t.playerID=null,t}return n(t,e),t.prototype.onLoad=function(){0==this.ViewPos?this.initUserView():this.initPlayerView(),this.originFlutterPos=this.flutter.node.position,this.ready.active=!1,this.offline.active=!1,this.room_owner.active=!1},t.prototype.initUserView=function(){this.unscheduleAllCallbacks(),this.nickname.string="",this.flutter.string="",this.landlord.active=!1,this.sprOper.node.active=!1,this.sprOper.spriteFrame=null,this.alarm_clock.onKillTimer(),this.node.active=!1},t.prototype.initPlayerView=function(){this.unscheduleAllCallbacks(),this.nickname.string="",this.gold.string="",this.flutter.string="",this.landlord.active=!1,this.sprOper.node.active=!1,this.sprOper.spriteFrame=null,this.sprRemain.active=!1,this.auto_icon.active=!1,this.remainCount.string="",this.warning.active=!1,this.alarm_clock.onKillTimer(),this.node.active=!1},t.prototype.resetMyView=function(){this.unscheduleAllCallbacks(),this.flutter.string="",this.landlord.active=!1,this.sprOper.node.active=!1,this.sprOper.spriteFrame=null,this.alarm_clock.onKillTimer()},t.prototype.getNodePosition=function(){return this.node.getPosition()},t.prototype.setUserInfo=function(e){var t=e,o=s.default.getSubStringLengTxt(e.username)||s.default.getReplaceStrToStar(e.player_id);this.nickname.string=o,this.setUserScore(t.gold),this.setHeadIcon(e.headimg_id),this.node.active=!0,1==this.GameView.gameType&&(1==e.state?(this.setReadyIcon(!0),this.setOfflineIcon(!1)):2==e.state?(this.setOfflineIcon(!0),this.setReadyIcon(!1)):3!=e.state&&6!=e.state||(this.setReadyIcon(!1),this.setOfflineIcon(!1)))},t.prototype.setReadyIcon=function(e){this.ready.active=e},t.prototype.setOfflineIcon=function(e){this.offline.active=e},t.prototype.setRoomOwner=function(e){this.room_owner.active=e},t.prototype.setUserEvent=function(e){var t=this;this.playerID=e,this.node.off(cc.Node.EventType.TOUCH_END),this.node.on(cc.Node.EventType.TOUCH_END,function(){c.NetManager.protocolGameCommon.sendLookPlayerInfoReq(t.playerID)})},t.prototype.setHeadIcon=function(e){l.default.setHeadIcon(e,this.head.node)},t.prototype.setUserScore=function(e){0==this.ViewPos?this.Footer.setUserScore(e):this.gold.string=s.default.getFormatGold(e)},t.prototype.setLandLordIcon=function(e){if(this.landlord.active=!0,e){var t=cc.sequence(cc.scaleTo(.3,.1,1),cc.scaleTo(.3,1));this.landlord.runAction(t)}},t.prototype.setSprOperation=function(e){this.sprOper.node.active=!0,this.sprOper.spriteFrame=this.user_oper_font.getSpriteFrame("font_"+e)},t.prototype.hideSprOperation=function(){this.sprOper.spriteFrame=null,this.sprOper.node.active=!1},t.prototype.setRemainCardNum=function(e){0==this.ViewPos?this.Footer.setUserRemainCard(e):(this.sprRemain.active=!0,this.remainCount.string=e)},t.prototype.setGameTimer=function(e){this.alarm_clock.setGameTimer(e)},t.prototype.onKillTimer=function(){this.alarm_clock.onKillTimer()},t.prototype.showAutoIcon=function(e){this.auto_icon.active=!!e},t.prototype.showWarning=function(){0!=this.ViewPos&&(this.warning.active=!0)},t.prototype.hideWarning=function(){0!=this.ViewPos&&(this.warning.active=!1)},t.prototype.flutterScore=function(e,t,o){var n=this;this.flutter.node.position=this.originFlutterPos,this.flutter.node.active=!0;var r="";e>=0?(this.flutter.font=this.yellow_bmfont,r="+"):(this.flutter.font=this.grey_bmfont,r="-");var a=Math.abs(e),i=a/parseFloat(50..toFixed(2)),s=0,c="",l=function(){c=(s+=i).toFixed(2),n.flutter.string=r+c,s>=a&&(c=a.toString(),n.flutter.string=r+parseFloat(c).toFixed(2),n.unschedule(l))};this.schedule(l,.01,cc.macro.REPEAT_FOREVER);var d=cc.moveBy(.5,t),u=cc.sequence(d,cc.delayTime(.5),cc.callFunc(function(){o&&o()}));this.flutter.node.runAction(u)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},r([p(cc.Sprite)],t.prototype,"head",void 0),r([p(cc.Label)],t.prototype,"nickname",void 0),r([p(cc.Label)],t.prototype,"gold",void 0),r([p(cc.Label)],t.prototype,"flutter",void 0),r([p(cc.Font)],t.prototype,"yellow_bmfont",void 0),r([p(cc.Font)],t.prototype,"grey_bmfont",void 0),r([p(cc.Node)],t.prototype,"landlord",void 0),r([p(cc.Sprite)],t.prototype,"sprOper",void 0),r([p(cc.Node)],t.prototype,"sprRemain",void 0),r([p(cc.Label)],t.prototype,"remainCount",void 0),r([p(cc.Node)],t.prototype,"auto_icon",void 0),r([p(a.default)],t.prototype,"alarm_clock",void 0),r([p(cc.Node)],t.prototype,"warning",void 0),r([p(cc.SpriteAtlas)],t.prototype,"user_oper_font",void 0),r([p(cc.Node)],t.prototype,"ready",void 0),r([p(cc.Node)],t.prototype,"offline",void 0),r([p(cc.Node)],t.prototype,"room_owner",void 0),r([p(i.default)],t.prototype,"Footer",void 0),r([p(cc.Integer)],t.prototype,"ViewPos",void 0),t=r([u],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0,"../../public/TimeClock":void 0,"./DDZFooter":"DDZFooter"}],ProtocolDDZ:[function(e,t,o){"use strict";cc._RF.push(t,"b4368yePaBIlbM2GXcH/1xT","ProtocolDDZ");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../../manager/DataManager"),a=e("../../../net/ProtocolBase"),i=e("../../../manager/NetManager"),s=e("../../../manager/UIManager"),c=e("./DDZCmd"),l=e("../../../Define"),d=function(e){function t(){var t=e.call(this,"game/ddz/pb")||this;return t.cmd=c.DDZCmd,t.type=l.SocketType.Game,t.pbName="DDZ",t}return n(t,e),t.prototype.sendGrabLandLordReq=function(e){var t={player_id:r.DataManager.userInfo.userid,landlord_mul:e};console.log("============>\u53d1\u9001\u62a2\u5730\u4e3b\u8bf7\u6c42"),this.send(t,"game_landlord_req")},t.prototype.sendUserOperateReq=function(e,t){var o={player_id:r.DataManager.userInfo.userid,user_operate:e,out_card_arr:t||[]};console.log("============>\u53d1\u9001\u64cd\u4f5c\u8bf7\u6c42"),this.send(o,"game_user_operate_req")},t.prototype.sendUserDepositReq=function(e){var t={player_id:r.DataManager.userInfo.userid,is_deposit:e};console.log("============>\u53d1\u9001\u6258\u7ba1\u8bf7\u6c42"),this.send(t,"game_user_deposit_req")},t.prototype.onErrorResp=function(e){s.UIManager.showTipsPopup(e.msg)},t}(a.default);o.default=d,i.NetManager.protocolCache.ProtocolDDZ=d,cc._RF.pop()},{"../../../Define":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../../net/ProtocolBase":void 0,"./DDZCmd":"DDZCmd"}],Tips:[function(e,t,o){"use strict";cc._RF.push(t,"4f6fbkOzCFMvpdGCAjkL3rN","Tips");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var a=e("./DDZTool"),i=1,s=2,c=3,l=4,d=5,u=6,p=7,h=8,f=9,v=10,_=41,g=42,m=43,y=44,C=40,D=51,b=cc._decorator,P=b.ccclass,S=(b.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardInstance=null,t.youCards=null,t.exclude=null,t.exboom=null,t.exghost=null,t.homeToAdmin=function(e){var t=[];for(var o in e){var n=e[o];if(14!=n)if(15!=n){var r=Math.floor(n/16),a=Math.floor(n%16);1==a?a=12:2==a?a=14:a<=13&&(a-=2);var i=a;t.push(16*i+r)}else t.push(242);else t.push(241)}return t},t.adminToHome=function(e){var t=[];for(var o in e){var n=e[o];if(241!=n)if(242!=n){var r=n%16,a=Math.floor(n/16);12==a?a=1:14==a?a=2:a<12&&(a+=2);var i=a;t.push(16*r+i)}else t.push(15);else t.push(14)}return t},t.Tips=function(e,o){t.cardInstance=e,t.youCards=t.homeToAdmin(o),t.exclude=[],t.exboom=[],t.exghost=[],t.getCards()},t.getCards=function(){var e;switch(t.cardInstance.type){case i:e=t.getSingle();break;case c:e=t.getLinkSingle();break;case s:e=t.getDouble();break;case l:e=t.getLinkDouble();break;case d:e=t.getThree();break;case p:e=t.getThreeOne();break;case h:e=t.getThreeTwo();break;case u:e=t.getLinkThree();break;case f:e=t.getFlySingle();break;case v:e=t.getFlyDouble();break;case C:e=t.getBoom();break;case _:e=t.getFourOne();break;case g:e=t.getFourTwo();break;case m:e=t.getFourDouble();break;case y:e=t.getFourTwoDouble();break;case D:return!1;default:return console.log("\u6ca1\u6709\u8fd9\u79cd\u724c\u578b"),!1}return!1!==e?t.adminToHome(e):!1!==(e=t.getBoom())?t.adminToHome(e):!1!==(e=t.getRocket())?t.adminToHome(e):0!=t.exclude.length||0!=t.exboom.length||0!=t.exghost.length?(t.exclude=[],t.exboom=[],t.exghost=[],t.getCards()):[]},t.getSingle=function(){if(94!=t.cardInstance.cards[0]){var e=t.getTipsValue(1,t.cardInstance.value,t.exclude);return 0!=e&&(15!=parseInt(e)||!1===t.getTipsValue(2,15)?(t.exclude.push(e.toString()),t.findCards(e,1)):2!=t.exghost.length&&(1==t.exghost.length?(t.exghost.push(242..toString()),[242]):(t.exghost.push(241..toString()),[241])))}for(var o in t.youCards)if(242==t.youCards[o]&&-1==t.exclude.indexOf(15..toString())&&-1==t.exclude.indexOf(15..toString()))return t.exclude.push(15..toString()),[242];return!1},t.getLinkSingle=function(){var e=t.getNumberLink(1,t.exclude);return 0!=e&&(t.exclude.push(e[0].toString()),t.findhandlebynumber(e,1))},t.getDouble=function(){var e=t.getTipsValue(2,t.cardInstance.value,t.exclude);return 0!=e&&(t.exclude.push(e.toString()),t.findCards(e,2))},t.getLinkDouble=function(){var e=t.getNumberLink(2,t.exclude);return 0!=e&&(t.exclude.push(e[0].toString()),t.findhandlebynumber(e,2))},t.getThree=function(){var e=t.getTipsValue(3,t.cardInstance.value,t.exclude);return 0!=e&&(t.exclude.push(e.toString()),t.findCards(e,3))},t.getThreeOne=function(){var e=t.getTipsValue(3,t.cardInstance.value,t.exclude);if(0==e)return!1;var o=t.getTipsValue(1,0,[e]);return!1!==o&&(t.exclude.push(e.toString()),t.findCards(e,3).concat(t.findCards(o,1)))},t.getThreeTwo=function(){var e=t.getTipsValue(3,t.cardInstance.value,t.exclude);if(0==e)return!1;var o=t.getTipsValue(2,0,[e]);return 0!=o&&(t.exclude.push(e.toString()),t.findCards(e,3).concat(t.findCards(o,2)))},t.getLinkThree=function(){var e=t.getNumberLink(3,t.exclude);return 0!=e&&(t.exclude.push(e[0].toString()),t.findhandlebynumber(e,3))},t.getotherbylenth=function(e,o){for(var n=JSON.parse(JSON.stringify(o)),r=[],a=0;a<t.cardInstance.length;a++){var i=t.getTipsValue(e,0,n);if(!1===i)return!1;n.push(i.toString()),r.push(i.toString())}return r},t.findhandlebynumber=function(e,o){var n=[];for(var r in e)n=n.concat(t.findCards(e[r],o));return n},t.getFlayWing=function(){var e=t.getNumberLink(3,t.exclude);if(0==e)return!1;var o=t.getotherbylenth(2,e);return!1!==o?(t.exclude.push(e[0].toString()),t.findhandlebynumber(e,3).concat(t.findhandlebynumber(o,2))):!1!==t.getotherbylenth(1,e)&&(t.exclude.push(e[0].toString()),t.findhandlebynumber(e,3).concat(t.findhandlebynumber(o,1)))},t.getBoom=function(){var e;e=t.cardInstance.type==C?t.cardInstance.value:0;var o=t.getTipsValue(4,e,t.exboom);return!1!==o&&(t.exboom.push(o.toString()),t.findCards(o,4))},t.getFourOne=function(){var e=t.getTipsValue(4,t.cardInstance.value,t.exclude);if(0==e)return!1;var o=t.getTipsValue(1,0,[e]);return!1!==o&&(t.exclude.push(e.toString()),t.findCards(e,4).concat(t.findCards(o,1)))},t.getFourTwo=function(){var e=t.getTipsValue(4,t.cardInstance.value,t.exclude);if(0==e)return!1;var o=t.getTipsValue(1,0,[e]);if(!1===o)return!1;var n=t.getTipsValue(1,0,[e,o]);return!1!==n&&(t.exclude.push(e.toString()),t.findCards(e,4).concat(t.findCards(o,1)).concat(t.findCards(n,1)))},t.getFourDouble=function(){var e=t.getTipsValue(4,t.cardInstance.value,t.exclude);if(0==e)return!1;var o=t.getTipsValue(2,0,[e]);return!1!==o&&(t.exclude.push(e.toString()),t.findCards(e,4).concat(t.findCards(o,2)))},t.getFourTwoDouble=function(){var e=t.getTipsValue(4,t.cardInstance.value,t.exclude);if(0==e)return!1;var o=t.getTipsValue(2,0,[e]);if(!1===o)return!1;var n=t.getTipsValue(2,0,[e,o]);return!1!==n&&(t.exclude.push(e.toString()),t.findCards(e,4).concat(t.findCards(o,2)).concat(t.findCards(n,2)))},t.getRocket=function(){var e=t.getTipsValue(2,14,t.exboom);return!1!==e&&(t.exboom.push(e.toString()),t.findCards(e,2))},t.getTipsValue=function(e,o,n){var r;void 0===n&&(n=[]);var a=t.getValueNumber(t.youCards);for(var i in a)if(a[i]==e&&i>o&&-1==n.indexOf(i)){r=i;break}if(void 0===r){for(var i in console.log("\u5565\u60c5\u51b5\u8fdb\u8fd9\u91cc"),a)if(a[i]>=e&&i>o&&-1==n.indexOf(i)){r=i;break}if(void 0===r)return!1}return r},t.findCards=function(e,o){var n=0,r=[];for(var i in t.youCards)if(a.default.getInstance().getCardLogicValue(t.youCards[i])==e&&(n++,r.push(t.youCards[i].toString())),n>=o)return r;return null},t.getValueNumber=function(e){var o=t.getValue(e),n={};for(var r in o)void 0===n[o[r]]?n[o[r]]=1:n[o[r]]+=1;return n},t.getValue=function(e){var t=[];for(var o in e)t[o]=a.default.getInstance().getCardLogicValue(e[o]);return t},t.getNumberLink=function(e,o){void 0===o&&(o=[]);var n=14-t.cardInstance.value;if(n<t.cardInstance.length)return!1;for(var r=[],a=t.getValueNumber(t.youCards),i=1;i<=n;i++){var s=i+t.cardInstance.value;if(a[s]>=e&&-1==t.exclude.indexOf(s.toString())?r.push((i+t.cardInstance.value).toString()):r=[],r.length==t.cardInstance.length)return r}return!1},t}return n(t,e),t.prototype.getFlySingle=function(){var e=this.getNumberLink(3,this.exclude);if(0==e)return!1;var t=this.getotherbylenth(1,e);return!1!==t?(this.exclude.push(e[0].toString()),this.findhandlebynumber(e,3).concat(this.findhandlebynumber(t,1))):void 0},t.prototype.getFlyDouble=function(){var e=this.getNumberLink(3,this.exclude);if(0==e)return!1;var t=this.getotherbylenth(2,e);return!1!==t&&(this.exclude.push(e[0].toString()),this.findhandlebynumber(e,3).concat(this.findhandlebynumber(t,2)))},t=r([P],t)}(cc.Component));o.default=S,cc._RF.pop()},{"./DDZTool":"DDZTool"}]},{},["DDZGameScene","DDZGameView","DDZTips","DDZTool","Tips","CMD_DDZ","DDZCmd","ProtocolDDZ","DDZFooter","DDZHandCard","DDZMarker","DDZOutCard","DDZOverEffect","DDZSeenCard","DDZTopPanel","DDZUser"]);