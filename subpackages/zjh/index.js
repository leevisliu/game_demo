window.__require=function e(t,n,o){function a(r,l){if(!n[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var c="function"==typeof __require&&__require;if(!l&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){return a(t[r][1][e]||e)},d,d.exports,e,t,n,o)}return n[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<o.length;r++)a(o[r]);return a}({CMD_ZJH:[function(e,t,n){"use strict";cc._RF.push(t,"dee7bjqus9DsJOl6Fm8I6g1","CMD_ZJH"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.zeroMemory=function(e){for(var t=[],n=0;n<e;n++)t[n]=0;return t},e.clone=function(e){return JSON.parse(JSON.stringify(e))},e.CARD_POS={MY_CARD_POS:[cc.v2(-35,0),cc.v2(0,0),cc.v2(35,0)],OTHER_CARD_POS:[cc.v2(-35,0),cc.v2(0,0),cc.v2(35,0)]},e.FLutter_POS=cc.v2(0,90),e.MASK_COLOR=240,e.MASK_VALUE=15,e.INVALE_CHAIR=255,e.GAME_SCENE_FREE=100,e.GAME_SCENE_PLAYING=101,e.GAME_PLAYER=5,e.FAILED=-1,e.LIMIT_FRIEND=-3,e.ROOM_CLOSE=-4,e.EMPTY_DATA=-5,e.MY_SEAT=-1,e.MY_ID=-1,e.PLAYER_DATAS=[],e.MY_DATA=null,e.DEAL_CARD_COUNT=3,e.MAX_CARD_COUNT=3,e}();n.default=o,cc._RF.pop()},{}],ProtocolZJH:[function(e,t,n){"use strict";cc._RF.push(t,"c3cbbiko2hN+aSqxmyIoCd7","ProtocolZJH");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("../../../net/ProtocolBase"),i=e("../../../manager/DataManager"),r=e("./ZJHCmd"),l=e("../../../Define"),s=e("../../../manager/NetManager"),c=e("../../../manager/UIManager"),d=e("../../../manager/EventManager"),p=function(e){function t(){var t=e.call(this,"game/zjh/pb")||this;return t.cmd=r.ZJHCmd,t.type=l.SocketType.Game,t.pbName="ZJH",d.EventManager.on(t,r.ProtocolZJHCmd.ErrorResp,t.onErrorResp.bind(t)),t}return o(t,e),t.prototype.sendFoldReq=function(){var e={player_id:i.DataManager.userInfo.userid};console.log("============>\u53d1\u9001\u5f03\u724c\u8bf7\u6c42"),this.send(e,"fold_req")},t.prototype.sendRaiseReq=function(e){var t={player_id:i.DataManager.userInfo.userid,raise_chip:e+""};console.log("============>\u53d1\u9001\u52a0\u6ce8\u8bf7\u6c42"),this.send(t,"raise_chip_req")},t.prototype.sendCanBattleReq=function(){var e={player_id:i.DataManager.userInfo.userid};console.log("============>\u53d1\u9001\u7533\u8bf7\u53ef\u4ee5\u6bd4\u724c\u7684\u4eba\u7684\u8bf7\u6c42"),this.send(e,"choose_battle_req")},t.prototype.sendBattleReq=function(e){var t={player_id:i.DataManager.userInfo.userid,battle_player_id:e};console.log("============>\u53d1\u9001\u9009\u62e9\u6b64\u4eba\u6bd4\u724c\u8bf7\u6c42=>>>>",e),this.send(t,"battle_req")},t.prototype.sendAllInBattleReq=function(){var e={player_id:i.DataManager.userInfo.userid};console.log("=>>>>>>>>>>>\u53d1\u9001\u5b64\u6ce8\u4e00\u63b7!!!!"),this.send(e,"all_in_battle_req")},t.prototype.sendCallReq=function(){var e={player_id:i.DataManager.userInfo.userid};console.log("============>\u53d1\u9001\u8ddf\u6ce8\u8bf7\u6c42"),this.send(e,"call_req")},t.prototype.sendLookCardReq=function(){var e={player_id:i.DataManager.userInfo.userid};console.log("============>\u53d1\u9001\u770b\u724c\u8bf7\u6c42"),this.send(e,"look_card_req")},t.prototype.onErrorResp=function(e){c.UIManager.showTipsPopup(e.err_msg)},t.prototype.dealError=function(e){console.log("\u9519\u8bef\u4fe1\u606f->>>>",e);e.err_msg},t.prototype.dealGameStart=function(e){},t.prototype.dealTurnWhoHandle=function(e){},t.prototype.dealFoldRes=function(e){},t.prototype.dealRaiseChipRes=function(e){},t.prototype.dealCanBattleRes=function(e){},t.prototype.dealBattleNotify=function(e){},t.prototype.dealCallRes=function(e){},t.prototype.dealLookCard=function(e){},t.prototype.dealGameEnd=function(e){},t.prototype.dealGameReconnect=function(e){},t}(a.default);n.default=p,s.NetManager.protocolCache.ProtocolZJH=p,cc._RF.pop()},{"../../../Define":void 0,"../../../manager/DataManager":void 0,"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../../net/ProtocolBase":void 0,"./ZJHCmd":"ZJHCmd"}],ZJHAvatarPanel:[function(e,t,n){"use strict";cc._RF.push(t,"bc9c7zMRb9OKKPj0WpwnRhU","ZJHAvatarPanel");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(a,i){function r(e){try{s(o.next(e))}catch(e){i(e)}}function l(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(r,l)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(a=2&i[0]?o.return:i[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../../../common/utils/Utils"),s=e("../../../manager/NetManager"),c=e("../../../common/UIHelper"),d=e("../../../manager/ResManager"),p={weikanpai:"font_weikanpai",kanpai:"font_kanpai",qipai:"font_qipai",lose:"font_lose"},u=cc._decorator,h=u.ccclass,_=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.head=null,t.vip_frame=null,t.vip_level=null,t.user_name=null,t.money=null,t.status=null,t.battle_blink=null,t.flutter=null,t.yellow_bmfont=null,t.grey_bmfont=null,t.ready=null,t.offline=null,t.room_owner=null,t.icon_first=null,t.centerPanel=null,t.GameView=null,t.playerID=null,t}return o(t,e),t.prototype.initzation=function(e,t){this.originFlutterPos=this.flutter.node.position,this.centerPanel=e,this.GameView=t,this.initView(),this.ready.active=!1,this.offline.active=!1,this.room_owner.active=!1},t.prototype.initView=function(){this.unscheduleAllCallbacks(),this.user_name.string="",this.money.string="",this.vip_frame.getComponent(cc.Sprite).spriteFrame=null,this.vip_level.getComponent(cc.Sprite).spriteFrame=null,this.flutter.string="",this.flutter.node.stopAllActions(),this.status.spriteFrame=null,this.battle_blink.active=!1,this.icon_first.active=!1,this.node.active=!1},t.prototype.resetMyView=function(){this.unscheduleAllCallbacks(),this.flutter.string="",this.flutter.node.stopAllActions(),this.status.spriteFrame=null,this.battle_blink.active=!1,this.icon_first.active=!1},t.prototype.setBattleEvent=function(e){l.default.removeClickEvent(this.battle_blink),l.default.addClickEventEND(this.battle_blink,this.onBattleEvent.bind(this),e),this.battle_blink.active=!0},t.prototype.hideBattleBlink=function(){l.default.removeClickEvent(this.battle_blink),this.battle_blink.active=!1},t.prototype.onBattleEvent=function(e,t){s.NetManager.getGameProtocol().sendBattleReq(t)},t.prototype.setUserInfo=function(e){var t=e,n=l.default.getSubStringLengTxt(e.username)||l.default.getReplaceStrToStar(e.player_id);this.user_name.string=n,this.setHeadIcon(e.headimg_id),this.setUserScore(t.gold),this.setVipFrame(e.vip_level),this.setVipLevel(e.vip_level),this.node.active=!0,1==this.GameView.gameType&&(1==e.state?(this.setReadyIcon(!0),this.setOfflineIcon(!1)):2==e.state?(this.setOfflineIcon(!0),this.setReadyIcon(!1)):3!=e.state&&6!=e.state||(this.setReadyIcon(!1),this.setOfflineIcon(!1)))},t.prototype.setVipFrame=function(e){e=e||0,c.default.setHeadFrame(e,this.vip_frame)},t.prototype.setVipLevel=function(e){e=e||0,c.default.setVipLevel(e,this.vip_level)},t.prototype.setReadyIcon=function(e){this.ready.active=e},t.prototype.setOfflineIcon=function(e){this.offline.active=e},t.prototype.setRoomOwner=function(e){this.room_owner.active=e},t.prototype.setUserEvent=function(e){var t=this;this.playerID=e,this.node.off(cc.Node.EventType.TOUCH_END),this.node.on(cc.Node.EventType.TOUCH_END,function(){s.NetManager.protocolGameCommon.sendLookPlayerInfoReq(t.playerID)})},t.prototype.setHeadIcon=function(e){c.default.setHeadIcon(e,this.head.node)},t.prototype.getNodePosition=function(){return this.node.getPosition()},t.prototype.setUserScore=function(e){this.money.string=l.default.getFormatGold(e)},t.prototype.setViewFirstSign=function(){this.icon_first.active=!0},t.prototype.setViewPlayerStatus=function(e){return i(this,void 0,void 0,function(){var t;return r(this,function(n){switch(n.label){case 0:return[4,d.ResManager.loadResAsync("game/zjh/res/status/"+p[e],cc.SpriteFrame)];case 1:return t=n.sent(),this.status.spriteFrame=t,[2]}})})},t.prototype.hideViewPlayerStatus=function(){this.status.spriteFrame=null},t.prototype.flutterScore=function(e,t,n){var o=this;this.flutter.node.position=this.originFlutterPos;var a="";e>=0?(this.flutter.font=this.yellow_bmfont,a="+"):(this.flutter.font=this.grey_bmfont,a="-");var i=Math.abs(e),r=i/parseFloat(50..toFixed(2)),l=0,s="",c=function(){s=(l+=r).toFixed(2),o.flutter.string=a+s,l>=i&&(s=i.toString(),o.flutter.string=a+parseFloat(s).toFixed(2),o.unschedule(c))};this.schedule(c,.01,cc.macro.REPEAT_FOREVER);var d=cc.moveBy(.5,t),p=cc.sequence(d,cc.delayTime(.5),cc.callFunc(function(){n&&n()}));this.flutter.node.runAction(p)},t.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},a([_(cc.Sprite)],t.prototype,"head",void 0),a([_(cc.Node)],t.prototype,"vip_frame",void 0),a([_(cc.Node)],t.prototype,"vip_level",void 0),a([_(cc.Label)],t.prototype,"user_name",void 0),a([_(cc.Label)],t.prototype,"money",void 0),a([_(cc.Sprite)],t.prototype,"status",void 0),a([_(cc.Node)],t.prototype,"battle_blink",void 0),a([_(cc.Label)],t.prototype,"flutter",void 0),a([_(cc.Font)],t.prototype,"yellow_bmfont",void 0),a([_(cc.Font)],t.prototype,"grey_bmfont",void 0),a([_(cc.Node)],t.prototype,"ready",void 0),a([_(cc.Node)],t.prototype,"offline",void 0),a([_(cc.Node)],t.prototype,"room_owner",void 0),a([_(cc.Node)],t.prototype,"icon_first",void 0),t=a([h],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0}],ZJHBattleAni:[function(e,t,n){"use strict";cc._RF.push(t,"f5540CUVUZODoZ0GLEVBxX3","ZJHBattleAni");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("../ZJHTool"),r=e("../../../common/utils/Utils"),l=e("../../../common/UIHelper"),s=cc._decorator,c=s.ccclass,d=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.left_head=null,t.left_name=null,t.left_vip_frame=null,t.left_vip_level=null,t.right_head=null,t.right_name=null,t.right_vip_frame=null,t.right_vip_level=null,t.pkSpine=null,t}return o(t,e),t.prototype.setBattleAni=function(e){var t=e.sponsor_seat_id,n=e.passive_seat_id,o=i.default.getInstance().getPlayerInfoBySeat(t),a=i.default.getInstance().getPlayerInfoBySeat(n);this.left_name.string=r.default.getSubStringLengTxt(o.username)||r.default.getReplaceStrToStar(o.player_id),l.default.setHeadIcon(o.headimg_id,this.left_head.node),l.default.setHeadFrame(o.vip_level,this.left_vip_frame),l.default.setVipLevel(o.vip_level,this.left_vip_level),this.right_name.string=r.default.getSubStringLengTxt(a.username)||r.default.getReplaceStrToStar(a.player_id),l.default.setHeadIcon(a.headimg_id,this.right_head.node),l.default.setHeadFrame(a.vip_level,this.right_vip_frame),l.default.setVipLevel(a.vip_level,this.right_vip_level),this.pkSpine.clearTracks(),this.pkSpine.setAnimation(0,e.is_sponsor_win?"left_win":"right_win",!1)},a([d(cc.Sprite)],t.prototype,"left_head",void 0),a([d(cc.Label)],t.prototype,"left_name",void 0),a([d(cc.Node)],t.prototype,"left_vip_frame",void 0),a([d(cc.Node)],t.prototype,"left_vip_level",void 0),a([d(cc.Sprite)],t.prototype,"right_head",void 0),a([d(cc.Label)],t.prototype,"right_name",void 0),a([d(cc.Node)],t.prototype,"right_vip_frame",void 0),a([d(cc.Node)],t.prototype,"right_vip_level",void 0),a([d(sp.Skeleton)],t.prototype,"pkSpine",void 0),t=a([c],t)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../ZJHTool":"ZJHTool"}],ZJHCenterPanel:[function(e,t,n){"use strict";cc._RF.push(t,"f3c9aTHRFpF9bFWHsQrZA0i","ZJHCenterPanel");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../../common/utils/Utils"),r=e("../../../manager/NetManager"),l=e("../../../manager/UIManager"),s=e("../model/CMD_ZJH"),c=e("../../../manager/DataManager"),d=e("../../../common/log/LogWrap"),p=e("../../../Define"),u=cc._decorator,h=u.ccclass,_=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cancel_click=null,t.btn_start=null,t.btn_dissolution=null,t.btn_frined_start=null,t.toggle_ready=null,t.btn_club_invite=null,t.btn_ready=null,t.btn_cancel_ready=null,t.label_startTime=null,t.node_btn=null,t.node_chip=null,t.node_sum=null,t.label_sum=null,t.node_round=null,t.label_round=null,t.btn_look=null,t.btn_fold=null,t.node_raise=null,t.btn_raise=null,t.node_battle=null,t.btn_battle=null,t.node_call=null,t.btn_call=null,t.btn_auto=null,t.btn_cancel_auto=null,t.winSp=null,t.failSp=null,t.normal_material=null,t.grey_material=null,t.GameView=null,t.chip_btns=[],t.onStartSchedule=null,t}return o(t,e),t.prototype.initzation=function(e){this.GameView=e,this.initView(),this.initNode()},t.prototype.initNode=function(){i.default.addClickEventEND(this.btn_start,this.onClickEvent.bind(this)),i.default.addClickEventEND(this.btn_dissolution,this.clickDiss.bind(this)),i.default.addClickEventEND(this.btn_frined_start,this.clickFriend.bind(this)),i.default.addClickEventEND(this.cancel_click,this.onCancelEvent.bind(this)),i.default.addClickEventEND(this.btn_fold,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_raise,this.onRaiseEvent.bind(this)),i.default.addClickEventEND(this.btn_battle,this.onBattleEvent.bind(this)),i.default.addClickEventEND(this.btn_call,this.onCallEvent.bind(this)),i.default.addClickEventEND(this.btn_auto,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_cancel_auto,this.onHandleEvent.bind(this)),i.default.addClickEventEND(this.btn_look,this.onLookCardEvent.bind(this)),this.toggle_ready.on("toggle",this.onClickToggle.bind(this)),this.toggle_ready.getComponent(cc.Toggle).isChecked=!1,i.default.addClickEventEND(this.btn_ready,this.onClickReadyEvent.bind(this)),i.default.addClickEventEND(this.btn_cancel_ready,this.onClickReadyEvent.bind(this)),i.default.addClickEventEND(this.btn_club_invite,this.onClubInviteEvent.bind(this)),this.chip_btns=this.node_chip.children},t.prototype.initView=function(){this.btn_start.active=!1,this.btn_look.active=!1,this.node_btn.active=!1,this.node_chip.active=!1,this.node_round.active=!1,this.node_sum.active=!1,this.cancel_click.active=!1,this.onSetStartCountDown(!1)},t.prototype.clickDiss=function(){var e=this.GameView.topPanel.room_id.string;r.NetManager.protocolGameCommon.sendDismissFriendInquiry(parseFloat(e)||null)},t.prototype.clickFriend=function(){this.onSetStartCountDown(!1);var e=this.GameView.topPanel.room_id.string;r.NetManager.protocolGameCommon.sendStartFriendGame(parseFloat(e)||null)},t.prototype.setViewChipSum=function(e){this.node_sum.active=!0;var t="";t=e>=1e3&&e<1e4?(e/1e3).toString().slice(0,3)+"K":e>=1e4?(e/1e4).toString().slice(0,3)+"W":e+"",this.label_sum.string=t},t.prototype.hideViewChipSum=function(){this.node_sum.active=!1,this.label_sum.string=""},t.prototype.setViewRound=function(e,t){this.node_round.active=!0,this.label_round.string="\u7b2c"+e+"/"+t+"\u8f6e"},t.prototype.setRaiseChipEvent=function(){this.node_chip.active=!0,this.chip_btns.forEach(function(e,t){e.active=!1,i.default.removeClickEvent(e)});for(var e=this.GameView.chip_arr,t=0;t<e.length;t++){var n=this.chip_btns[t];n.active=!0,i.default.addClickEvent(n,this.node,"ZJHCenterPanel","onRaiseClickEvent",t)}this.node_chip.active=!1},t.prototype.setViewBtnChip=function(){var e=this.GameView.chip_arr,t=this.GameView.is_Look,n=parseFloat(this.GameView.limit_arr[0]),o=parseFloat(this.GameView.limit_arr[1]);n=t?2*n:n,o=t?2*o:o;for(var a=0;a<e.length;a++){var i=this.chip_btns[a];i.active=!0;var r=i.getChildByName("Label"),l=parseFloat(e[a]),s=t?2*l:l;r.getComponent(cc.Label).string=s+"",s>n&&s<=o?(i.getComponent(cc.Button).interactable=!0,i.resumeSystemEvents(!1)):(i.getComponent(cc.Button).interactable=!1,i.pauseSystemEvents(!1))}},t.prototype.setBtnState=function(e,t){var n=t.getChildByName("touch"),o=t.getChildByName("cancel");n.active=e,o.active=!e},t.prototype.setViewBtnHandle=function(e){this.setBtnState(e.can_raise,this.node_raise),this.setBtnState(e.can_battle,this.node_battle),this.setBtnState(!0,this.node_call),e.can_allin?(this.setBtnState(!0,this.node_battle),this.setBtnState(!1,this.node_call),console.log("\u8ddf\u6ce8\u6309\u94ae\u53d8\u70701213132131"),this.node_call.active=!0,this.btn_auto.active=!1,this.btn_cancel_auto.active=!1):(this.node_call.active=!this.GameView._isAutoCall,this.btn_auto.active=!1,this.btn_cancel_auto.active=this.GameView._isAutoCall,this.GameView._isAutoCall&&(this.setBtnState(!1,this.node_raise),this.setBtnState(!1,this.node_battle),r.NetManager.getGameProtocol().sendCallReq()))},t.prototype.setViewBtnHandleSpecial=function(e){e.can_allin?(this.setBtnState(!1,this.node_raise),this.setBtnState(!0,this.node_battle),this.setBtnState(!1,this.node_call),console.log("\u8ddf\u6ce8\u6309\u94ae\u53d8\u7070\u8272")):(this.setBtnState(e.can_raise,this.node_raise),this.setBtnState(e.can_battle,this.node_battle),this.setBtnState(e.can_call,this.node_call),0==e.can_call&&console.log("\u8ddf\u6ce8\u6309\u94ae\u53d8\u7070\u8272111"))},t.prototype.hideViewBtnHandle=function(){this.setBtnState(!1,this.node_raise),this.setBtnState(!1,this.node_battle),this.node_call.active=!1,this.btn_auto.active=!this.GameView._isAutoCall,this.btn_cancel_auto.active=this.GameView._isAutoCall},t.prototype.setViewBtnLook=function(e){this.btn_look.active=e},t.prototype.setViewBattleAndCallNum=function(e,t,n){var o=t?2*parseFloat(e):parseFloat(e),a=this.node_battle.children[0].getChildByName("label"),i=this.node_battle.children[1].getChildByName("label");n?(a.getComponent(cc.Label).string="\u5b64\u6ce8\u4e00\u63b7",i.getComponent(cc.Label).string="\u5b64\u6ce8\u4e00\u63b7"):(a.getComponent(cc.Label).string=o+" \u6bd4 \u724c",i.getComponent(cc.Label).string=o+" \u6bd4 \u724c");var r=this.node_call.children[0].getChildByName("label"),l=this.node_call.children[1].getChildByName("label");r.getComponent(cc.Label).string=o+" \u8ddf \u6ce8",l.getComponent(cc.Label).string=o+" \u8ddf \u6ce8"},t.prototype.setViewBtnAllIn=function(){var e=this.node_battle.children[0].getChildByName("label"),t=this.node_battle.children[1].getChildByName("label");e.getComponent(cc.Label).string="\u5b64\u6ce8\u4e00\u63b7",t.getComponent(cc.Label).string="\u5b64\u6ce8\u4e00\u63b7"},t.prototype.onClickEvent=function(e){"btn_start"==e.name&&this.sendMatchReq()},t.prototype.onHandleEvent=function(e){var t=e.name;"btn_fold"==t?r.NetManager.getGameProtocol().sendFoldReq():"btn_auto"==t?(this.GameView._isAutoCall=!0,e.active=!1,this.btn_cancel_auto.active=!0):"btn_cancel_auto"==t&&(this.GameView._isAutoCall=!1,e.active=!1,this.btn_auto.active=!0)},t.prototype.onRaiseEvent=function(){this.setViewBtnChip(),this.cancel_click.active=!this.node_chip.active,this.node_chip.active=!this.node_chip.active},t.prototype.onBattleEvent=function(){this.GameView.is_AllIn?r.NetManager.getGameProtocol().sendAllInBattleReq():r.NetManager.getGameProtocol().sendCanBattleReq()},t.prototype.onCallEvent=function(){r.NetManager.getGameProtocol().sendCallReq()},t.prototype.onCancelEvent=function(e){this.node_chip.active=!1,e.active=!1},t.prototype.onLookCardEvent=function(e){r.NetManager.getGameProtocol().sendLookCardReq(),e.active=!1},t.prototype.onRaiseClickEvent=function(e,t){var n=e.target,o=this.GameView.chip_arr[t],a=this.GameView.is_Look?2*o:o;console.log("========>\u52a0\u6ce8\u7b79\u7801\u6570\u91cf",a),r.NetManager.getGameProtocol().sendRaiseReq(a),n.parent.active=!1},t.prototype.sendMatchReq=function(){this.GameView.is_Match=!0;l.UIManager.showLoading("\u6b63\u5728\u5feb\u901f\u5339\u914d\u4e2d...",!0,function(){r.NetManager.protocolGameCommon.sendCancelMatch()}),this.GameView.resetGameView(),r.NetManager.protocolGameCommon.sendMatchReq(),this.btn_start.active=!1},t.prototype.onClickToggle=function(){var e=this.toggle_ready.getComponent(cc.Toggle).isChecked;this.GameView.IsCheck=e,console.log("\u81ea\u52a8\u51c6\u5907",this.GameView.IsCheck),1==this.GameView.gameType&&c.DataManager.isCreaterUser&&this.onSetStartCountDown(e)},t.prototype.setChecked=function(e){this.toggle_ready.getComponent(cc.Toggle).isChecked=e,this.GameView.IsCheck=e},t.prototype.onClubInviteEvent=function(){r.NetManager.protocolChat.sendClubRoomReq()},t.prototype.onClickReadyEvent=function(e){var t=e.name,n=null;"btn_ready"==t?n=0:"btn_cancel_ready"==t&&(n=1),r.NetManager.protocolGameCommon.sendFriendReadyReq(n)},t.prototype.showReadyBtn=function(){this.hideReadyBtn(),0==this.GameView.gameType&&(this.btn_start.active=!0)},t.prototype.hideReadyBtn=function(){this.btn_start.active=!1,this.toggle_ready.active=!1},t.prototype.showFriendBtn=function(){this.hideFriendBtn(),this.toggle_ready.active=!0,c.DataManager.isCreaterUser?(this.btn_dissolution.active=!0,this.btn_frined_start.active=!0,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6240\u6709\u73a9\u5bb6\u51c6\u5907\u5b8c\u6210\u540e\u81ea\u52a8\u5f00\u59cb",c.DataManager.roomType==p.RoomType.Club&&(this.btn_dissolution.active=!1,this.btn_club_invite.active=!0)):(this.btn_ready.active=6==s.default.MY_DATA.state,this.btn_cancel_ready.active=1==s.default.MY_DATA.state,this.toggle_ready.getChildByName("label").getComponent(cc.Label).string="\u6e38\u620f\u7ed3\u675f\u540e\u81ea\u52a8\u51c6\u5907",c.DataManager.roomType==p.RoomType.Club&&(this.btn_club_invite.active=!0))},t.prototype.showFriendReadyBtn=function(){this.btn_ready.active=!0,this.toggle_ready.active=!0,c.DataManager.roomType==p.RoomType.Club&&(this.btn_club_invite.active=!0)},t.prototype.hideFriendBtn=function(){this.btn_dissolution.active=!1,this.btn_frined_start.active=!1,this.btn_ready.active=!1,this.btn_cancel_ready.active=!1,this.toggle_ready.active=!1,this.btn_club_invite.active=!1},t.prototype.onSetStartCountDown=function(e){var t=this;if(void 0===e&&(e=!0),e){var n=5;this.label_startTime.node.active=!0,this.label_startTime.string=n+"",null!=this.onStartSchedule&&this.unschedule(this.onStartSchedule),this.onStartSchedule=function(){if(n--,d.LogWrap.log("\u5012\u8ba1\u65f6\u65f6\u95f4",n),t.label_startTime.string=n+"",n<=0){d.LogWrap.log("\u5012\u8ba1\u65f6\u7ed3\u675f, \u53d1\u9001\u597d\u53cb\u623f\u5f00\u59cb\u6e38\u620f\u6307\u4ee4");var e=c.DataManager.friendRoomId;return r.NetManager.protocolGameCommon.sendStartFriendGame(parseFloat(e)||null),t.label_startTime.node.active=!1,void t.unschedule(t.onStartSchedule)}},this.schedule(this.onStartSchedule,1,cc.macro.REPEAT_FOREVER)}else this.onStartSchedule&&(this.label_startTime.node.active=!1,this.unschedule(this.onStartSchedule))},t.prototype.hideBtnLook=function(){this.btn_look.active=!1},t.prototype.showBtnHandle=function(){this.node_btn.active=!0},t.prototype.hideBtnHandle=function(){this.node_btn.active=!1},t.prototype.hideRaiseNode=function(){this.node_chip.active=!1},t.prototype.showResultSpine=function(e,t){void 0===e&&(e=0),this.winSp.node.active=!e,this.failSp.node.active=!!e;var n=0==e?this.winSp:this.failSp,o=n.animation;n.setAnimation(0,o,!1)&&n.setCompleteListener(function(e,n){t&&t()})},a([_(cc.Node)],t.prototype,"cancel_click",void 0),a([_(cc.Node)],t.prototype,"btn_start",void 0),a([_(cc.Node)],t.prototype,"btn_dissolution",void 0),a([_(cc.Node)],t.prototype,"btn_frined_start",void 0),a([_(cc.Node)],t.prototype,"toggle_ready",void 0),a([_(cc.Node)],t.prototype,"btn_club_invite",void 0),a([_(cc.Node)],t.prototype,"btn_ready",void 0),a([_(cc.Node)],t.prototype,"btn_cancel_ready",void 0),a([_(cc.Label)],t.prototype,"label_startTime",void 0),a([_(cc.Node)],t.prototype,"node_btn",void 0),a([_(cc.Node)],t.prototype,"node_chip",void 0),a([_(cc.Node)],t.prototype,"node_sum",void 0),a([_(cc.Label)],t.prototype,"label_sum",void 0),a([_(cc.Node)],t.prototype,"node_round",void 0),a([_(cc.Label)],t.prototype,"label_round",void 0),a([_(cc.Node)],t.prototype,"btn_look",void 0),a([_(cc.Node)],t.prototype,"btn_fold",void 0),a([_(cc.Node)],t.prototype,"node_raise",void 0),a([_(cc.Node)],t.prototype,"btn_raise",void 0),a([_(cc.Node)],t.prototype,"node_battle",void 0),a([_(cc.Node)],t.prototype,"btn_battle",void 0),a([_(cc.Node)],t.prototype,"node_call",void 0),a([_(cc.Node)],t.prototype,"btn_call",void 0),a([_(cc.Node)],t.prototype,"btn_auto",void 0),a([_(cc.Node)],t.prototype,"btn_cancel_auto",void 0),a([_(sp.Skeleton)],t.prototype,"winSp",void 0),a([_(sp.Skeleton)],t.prototype,"failSp",void 0),a([_(cc.Material)],t.prototype,"normal_material",void 0),a([_(cc.Material)],t.prototype,"grey_material",void 0),t=a([h],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../../../Define":void 0,"../../../common/log/LogWrap":void 0,"../../../common/utils/Utils":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../model/CMD_ZJH":"CMD_ZJH"}],ZJHCmd:[function(e,t,n){"use strict";cc._RF.push(t,"3a405Is5sVEaqeOrnujiVmZ","ZJHCmd"),Object.defineProperty(n,"__esModule",{value:!0}),n.ZJHCmd="23_0",n.ProtocolZJHCmd={ErrorResp:n.ZJHCmd+"_err_res",GameStartNotify:n.ZJHCmd+"_game_start_notify",TurnWhoHandleNotify:n.ZJHCmd+"_turn_who_handle_notify",FoldResp:n.ZJHCmd+"_fold_res",RaiseChipResp:n.ZJHCmd+"_raise_chip_res",ChooseBattleResp:n.ZJHCmd+"_choose_battle_res",BattleNotify:n.ZJHCmd+"_battle_notify",CallResp:n.ZJHCmd+"_call_res",LookCardResp:n.ZJHCmd+"_look_card_res",GameConcludeNotify:n.ZJHCmd+"_game_conclude_notify",GameReconnectInfo:n.ZJHCmd+"_game_reconnect_info"},cc._RF.pop()},{}],ZJHGameScene:[function(e,t,n){"use strict";cc._RF.push(t,"c3c5cJ0lmFGd4eNekXg19ks","ZJHGameScene");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ZJHGameView"),r=e("./ZJHTool"),l=e("./model/CMD_ZJH"),s=e("../../manager/EventManager"),c=e("../../net/NetCmd"),d=e("../../manager/DataManager"),p=e("../../manager/UIManager"),u=e("./net/ZJHCmd"),h=e("../../Define"),_=cc._decorator,f=_.ccclass,v=_.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameView=null,t}return o(t,e),t.prototype.onLoad=function(){this.GameView.GameScene=this,this.initEvent(),p.UIManager.hideMarquee()},t.prototype.initEvent=function(){s.EventManager.on(this,c.ProtocolGameCmd.GameLoginResp,this.onGameLoginResp.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.LoginFriendRoomResp,this.onLoginFriendRoomResp.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.LoginFriendRoomNotify,this.onLoginFriendRoomNotify.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.DisconnectRoomNotify,this.onDisconnectRoomNotify.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.MatchResp,this.onMatchResp.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.CancelMatchResp,this.onCancelMatchResp.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.AdJustReadyResp,this.onAdJustReadyResp.bind(this)),s.EventManager.on(this,c.ProtocolGameCmd.ChangeCreaterRes,this.onChangeCreaterRes.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.GameStartNotify,this.onGameStartNotify.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.TurnWhoHandleNotify,this.onTurnWhoHandleNotify.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.FoldResp,this.onFoldResp.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.CallResp,this.onCallResp.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.RaiseChipResp,this.onRaiseChipResp.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.ChooseBattleResp,this.onChooseBattleResp.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.BattleNotify,this.onBattleNotify.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.LookCardResp,this.onLookCardResp.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.GameConcludeNotify,this.onGameConcludeNotify.bind(this)),s.EventManager.on(this,u.ProtocolZJHCmd.GameReconnectInfo,this.onGameReconnectInfo.bind(this)),s.EventManager.on(this,h.EventDef.UpdateUserGold,this.onUpdateUserScore.bind(this))},t.prototype.onGameLoginResp=function(e){this.GameView.resetGameView(),this.GameView.initPrePareGameView(e)},t.prototype.onLoginFriendRoomResp=function(e){var t=this;console.log("\u6548\u9a8c\u6210\u529f====>",e),this.GameView.gameType=1,this.GameView.topPanel.setRoomId(e.room_id),this.GameView.resetGameView(),l.default.PLAYER_DATAS=e.player_info,console.log("%c\u6240\u6709\u7528\u6237\u4fe1\u606f======>","color:green",l.default.PLAYER_DATAS),l.default.PLAYER_DATAS.forEach(function(e,t){e.player_id==d.DataManager.userInfo.userid&&(l.default.MY_DATA=e,l.default.MY_SEAT=e.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",e))});var n=JSON.parse(JSON.stringify(e));n.player_info=l.default.MY_DATA,this.GameView.initPrePareGameView(n),l.default.PLAYER_DATAS.forEach(function(e,n){var o=r.default.getInstance().getLocalIndex(e.seat_id);t.GameView.avatarPanel[o].setUserInfo(e),t.GameView.avatarPanel[o].setUserEvent(e.player_id)}),l.default.PLAYER_DATAS.forEach(function(e,n){var o=e.creater_state,a=r.default.getInstance().getLocalIndex(e.seat_id);t.GameView.avatarPanel[a].setRoomOwner(1==o)})},t.prototype.onLoginFriendRoomNotify=function(e){var t=r.default.getInstance().getLocalIndex(e.player_info.seat_id),n=e.player_info;if(e.is_add)console.log("\u6709\u4eba\u52a0\u5165"),l.default.PLAYER_DATAS=l.default.PLAYER_DATAS.concat(n),this.GameView.avatarPanel[t].setUserInfo(n),this.GameView.avatarPanel[t].setUserEvent(n.player_id),this.GameView.showFriendPlayerState(t,n.state);else if(e.is_offline){console.log("\u6709\u4eba\u6389\u7ebf\u56de\u6765");for(var o=0;o<l.default.PLAYER_DATAS.length;o++){if(l.default.PLAYER_DATAS[o].player_id==n.player_id){l.default.PLAYER_DATAS[o]=n;break}}this.GameView.avatarPanel[t].setUserInfo(n),this.GameView.showFriendPlayerState(t,n.state)}else if(e.is_leave){console.log("\u6709\u4eba\u79bb\u5f00\u6216\u8005\u88ab\u8e22");for(o=0;o<l.default.PLAYER_DATAS.length;o++){if(l.default.PLAYER_DATAS[o].player_id==n.player_id){l.default.PLAYER_DATAS.splice(o,1);break}}this.GameView.avatarPanel[t].initView(),this.GameView.cardPanel[t].initView()}},t.prototype.onDisconnectRoomNotify=function(e){if(console.log("\u597d\u53cb\u623f\u6709\u4eba\u6389\u7ebf\u4e86"),l.default.PLAYER_DATAS)for(var t=0;t<l.default.PLAYER_DATAS.length;t++){var n=l.default.PLAYER_DATAS[t];if(n.player_id==e.userid){n.state=2;var o=r.default.getInstance().getLocalIndex(n.seat_id);this.GameView.showFriendPlayerState(o,n.state);break}}},t.prototype.onAdJustReadyResp=function(e){if(l.default.PLAYER_DATAS)for(var t=0;t<l.default.PLAYER_DATAS.length;t++){var n=l.default.PLAYER_DATAS[t];if(n.player_id==e.player_id){var o=r.default.getInstance().getLocalIndex(n.seat_id);n.state=e.ret,this.GameView.showFriendPlayerState(o,n.state),0==o&&this.GameView.showReady();break}}},t.prototype.onChangeCreaterRes=function(e){if(0==e.ret){this.GameView.avatarPanel.forEach(function(e){e.setRoomOwner(!1)});var t=r.default.getInstance().getLocalIndex(e.creater_seat_id);if(this.GameView.avatarPanel[t].setRoomOwner(!0),this.GameView.avatarPanel[t].setReadyIcon(!1),l.default.PLAYER_DATAS){for(var n=0;n<l.default.PLAYER_DATAS.length;n++){if((o=l.default.PLAYER_DATAS[n]).player_id==e.creater_id){o.state=6;break}}for(n=0;n<l.default.PLAYER_DATAS.length;n++){var o;if((o=l.default.PLAYER_DATAS[n]).player_id==e.old_creater_id){o.state=6;break}}d.DataManager.userInfo.userid!=e.old_creater_id&&d.DataManager.userInfo.userid!=e.creater_id||(this.GameView.centerPanel.setChecked(!1),this.GameView.centerPanel.onSetStartCountDown(!1))}this.GameView.showReady()}},t.prototype.onMatchResp=function(e){1==e.status?(console.log("\u5339\u914d\u6210\u529f====>",e),this.GameView.is_Match=!1,p.UIManager.hideLoading()):2==e.status||4==e.status?(p.UIManager.showTips(2==e.status?"\u5339\u914d\u8d85\u65f6":"\u91d1\u5e01\u4e0d\u8db3"),this.GameView.is_Match=!1,this.GameView.showReady(),p.UIManager.hideLoading()):3==e.status?(console.log("\u5339\u914d\u88ab\u53d6\u6d88"),p.UIManager.hideLoading()):100==e.status&&(this.GameView.is_Match=!1,p.UIManager.showTips("\u5339\u914d\u5931\u8d25"),this.GameView.showReady(),p.UIManager.hideLoading())},t.prototype.onCancelMatchResp=function(e){p.UIManager.showTips(e.ok?"\u53d6\u6d88\u5339\u914d\u6210\u529f":"\u53d6\u6d88\u5339\u914d\u5931\u8d25"),e.ok&&this.GameView.showReady()},t.prototype.onGameStartNotify=function(e){console.log("%c \u6e38\u620f\u5f00\u59cb","font-size:24px;color:red;",e),this.GameView.resetGameView(),l.default.PLAYER_DATAS=e.player_list,console.log("%c\u6240\u6709\u7528\u6237\u4fe1\u606f======>","color:green",l.default.PLAYER_DATAS),l.default.PLAYER_DATAS.forEach(function(e,t){e.player_id==d.DataManager.userInfo.userid&&(l.default.MY_DATA=e,l.default.MY_SEAT=e.seat_id,console.log("\u6211\u7684\u7528\u6237\u4fe1\u606f======>",e))}),this.GameView.initGameView(),this.GameView.StartGame(e)},t.prototype.onTurnWhoHandleNotify=function(e){this.GameView.onSubTurnHandle(e)},t.prototype.onFoldResp=function(e){this.GameView.onSubFoldCard(e)},t.prototype.onCallResp=function(e){this.GameView.onSubCallChip(e)},t.prototype.onRaiseChipResp=function(e){this.GameView.onSubRaiseChip(e)},t.prototype.onChooseBattleResp=function(e){this.GameView.onSubBattleCan(e)},t.prototype.onBattleNotify=function(e){this.GameView.onSubBattleNotify(e)},t.prototype.onLookCardResp=function(e){this.GameView.onSubLookCard(e)},t.prototype.onGameConcludeNotify=function(e){this.GameView.onSubGameEnd(e)},t.prototype.onGameReconnectInfo=function(e){this.GameView.recoverGameView(e)},t.prototype.onUpdateUserScore=function(){this.GameView.onUpdateUserScore()},t.prototype.onDestroy=function(){s.EventManager.off(this)},a([v(i.default)],t.prototype,"GameView",void 0),t=a([f],t)}(cc.Component);n.default=m,cc._RF.pop()},{"../../Define":void 0,"../../manager/DataManager":void 0,"../../manager/EventManager":void 0,"../../manager/UIManager":void 0,"../../net/NetCmd":void 0,"./ZJHGameView":"ZJHGameView","./ZJHTool":"ZJHTool","./model/CMD_ZJH":"CMD_ZJH","./net/ZJHCmd":"ZJHCmd"}],ZJHGameView:[function(e,t,n){"use strict";cc._RF.push(t,"84a46RvQg1KK6tWm9sYW82X","ZJHGameView");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(a,i){function r(e){try{s(o.next(e))}catch(e){i(e)}}function l(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(r,l)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(a=2&i[0]?o.return:i[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("./model/CMD_ZJH"),s=e("./ui/ZJHTopPanel"),c=e("./ui/ZJHCenterPanel"),d=e("./ZJHTool"),p=e("./ui/ZJHAvatarPanel"),u=e("./ui/ZJHPokerPanel"),h=e("./ui/ZJHBattleAni"),_=e("./ZJHTest"),f=e("../../manager/AudioManager"),v=e("../../common/utils/Utils"),m=e("../../manager/DataManager"),y=e("../../manager/NetManager"),g=e("../../manager/ResManager"),b=e("../../view/common/GameChat"),P=e("../../manager/UIManager"),C=e("../../common/log/LogWrap"),w=cc._decorator,R=w.ccclass,A=w.property,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.avatarPanel=[],t.cardPanel=[],t.spr_bg=null,t.node_top=null,t.node_center=null,t.topPanel=null,t.centerPanel=null,t.node_ani=null,t.node_area=null,t.spr_jetton=null,t.UINode=null,t.gold_frame=null,t.battle_ani=null,t.start_game=null,t.GameScene=null,t.ZJHTest=null,t.is_Look=!1,t.is_Show=!1,t.is_Lose=!1,t.is_AllIn=!1,t.is_TurnMe=!1,t.is_Match=!1,t._isAutoCall=!1,t.chip_arr=[],t.limit_arr=[],t.gameType=0,t.isStartGame=!1,t.first_pos=null,t.IsCheck=!1,t}return o(t,e),t.prototype.onLoad=function(){f.AudioManager.playGameBGM("zjh_bgm.mp3"),this.initView(),this.initNode(),this.initChat()},t.prototype.initChat=function(){return i(this,void 0,void 0,function(){var e,t;return r(this,function(n){switch(n.label){case 0:return[4,g.ResManager.loadResAsync("prefabs/common/GameChat",cc.Prefab,!1)];case 1:return(e=n.sent())&&cc.isValid(this.node)&&!this.node.getChildByName("GameChat")&&(t=cc.instantiate(e),this.node.addChild(t),t.getComponent(b.default).setTalkPositionY(0)),[2]}})})},t.prototype.initView=function(){var e=this;this.spr_bg=cc.find("bg",this.node),this.node_top=cc.find("node_top",this.node),this.node_center=cc.find("node_center",this.node),this.topPanel.initzation(this),this.centerPanel.initzation(this),this.avatarPanel.forEach(function(t,n){t.initzation(e.centerPanel,e)}),this.cardPanel.forEach(function(t,n){t.initzation(e.centerPanel,e)})},t.prototype.initNode=function(){this.spr_jetton.active=!1},t.prototype.initPrePareGameView=function(e){var t=e.player_info,n={username:v.default.getSubStringLengTxt(t.username)||v.default.getReplaceStrToStar(t.player_id),gold:t.gold,headimg_id:t.headimg_id,vip_level:m.DataManager.userInfo.vip_level},o=e.room_info.room_base_note;this.topPanel.setBasicPot(o),this.avatarPanel[0].setUserInfo(n),this.showReady()},t.prototype.initGameView=function(){var e=this;l.default.PLAYER_DATAS.forEach(function(t,n){var o=d.default.getInstance().getLocalIndex(t.seat_id);e.avatarPanel[o].setUserInfo(t),e.avatarPanel[o].setUserEvent(t.player_id),e.avatarPanel[o].setViewPlayerStatus("weikanpai")})},t.prototype.initUserView=function(){this.avatarPanel.forEach(function(e,t){0!=t?e.initView():e.resetMyView()})},t.prototype.recoverGameView=function(e){var t=this;this.is_Match=!1,this.isStartGame=!0,this.centerPanel.hideReadyBtn();var n=e.game_start_notify;if(n){l.default.PLAYER_DATAS=n.player_list,l.default.PLAYER_DATAS.forEach(function(e,t){e.player_id==m.DataManager.userInfo.userid&&(l.default.MY_DATA=e,l.default.MY_SEAT=e.seat_id)}),this.initGameView();var o=n.room_info.room_code;this.topPanel.setRoomInfo(o),this.centerPanel.setViewRound(n.current_num_round,n.total_num_round),this.chip_arr=n.chip_arr,this.centerPanel.setRaiseChipEvent();var a=d.default.getInstance().getLocalIndex(n.first_seat_id);this.avatarPanel[a].setViewFirstSign(),this.centerPanel.setViewChipSum(n.total_chip_num),1==this.gameType&&(this.centerPanel.hideFriendBtn(),this.avatarPanel.forEach(function(e,t){e.setReadyIcon(!1)}))}this.centerPanel.setViewBtnLook(!0),e.player_info.forEach(function(e,n){var o=d.default.getInstance().getLocalIndex(e.seat_id),a=e.is_look,i=e.is_fold,r=e.is_lose;t.cardPanel[o].initCard(o),t.cardPanel[o].cardBackView(),a&&(C.LogWrap.log("\u5df2\u770b\u724c\u4f4d\u7f6e",o),0==o&&(t.is_Look=!0,t.is_Show=!0,t.cardPanel[o].showPoker(e.card_arr),t.cardPanel[o].setCardType(e.val_type),t.centerPanel.hideBtnLook()),t.avatarPanel[o].setViewPlayerStatus("kanpai")),i&&(0==o?(t.is_Lose=!0,t.centerPanel.hideBtnLook(),t.centerPanel.showReadyBtn(),t.cardPanel[o].showPoker(e.card_arr),t.cardPanel[o].setCardType(e.val_type)):t.cardPanel[o].removeCard(),t.avatarPanel[o].setViewPlayerStatus("qipai")),r&&(0==o&&(t.is_Lose=!0,t.centerPanel.hideBtnLook(),t.centerPanel.showReadyBtn()),t.cardPanel[o].setGreyCard(),t.avatarPanel[o].setViewPlayerStatus("lose"))}),this.recoverJetton(e.jetton_arr)},t.prototype.showReady=function(){0==this.gameType?this.centerPanel.showReadyBtn():1==this.gameType&&this.centerPanel.showFriendBtn()},t.prototype.resetGameView=function(){this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.UINode.destroyAllChildren(),this.topPanel.setRoomInfo(),this.centerPanel.initView(),this.avatarPanel.forEach(function(e,t){0!=t?e.initView():e.resetMyView()}),this.cardPanel.forEach(function(e,t){e.hideCardType(),e.removeCard()}),this.cardPanel.forEach(function(e){e.onKillTimer()}),this.node_area.destroyAllChildren(),this.initData()},t.prototype.initData=function(){this.is_Lose=!1,this.is_Look=!1,this.is_Show=!1,this.is_AllIn=!1,this.is_TurnMe=!1,this._isAutoCall=!1},t.prototype.StartGame=function(e){var t=this;P.UIManager.hideLoading(),0==this.gameType?this.centerPanel.hideReadyBtn():1==this.gameType&&this.centerPanel.hideFriendBtn(),y.NetManager.protocolGameCommon.needFlushGold=!1,this.isStartGame=!0,this.is_Match=!1;var n=e.room_info.room_code;this.topPanel.setRoomInfo(n),this.centerPanel.setViewRound(e.current_num_round,e.total_num_round),this.chip_arr=e.chip_arr,this.centerPanel.setRaiseChipEvent();var o=cc.instantiate(this.start_game);this.UINode.addChild(o),this.scheduleOnce(function(){t.dealCardsAni(function(){var n=d.default.getInstance().getLocalIndex(e.first_seat_id);t.first_pos=n,t.avatarPanel[n].setViewFirstSign(),t.centerPanel.setViewBattleAndCallNum(e.current_chip_num,!1,!1),t.centerPanel.setViewBtnLook(!0),t.centerPanel.setViewChipSum(e.total_chip_num),l.default.PLAYER_DATAS.forEach(function(n,o){var a=d.default.getInstance().getLocalIndex(n.seat_id);t.setViewCallAni(a,e.current_chip_num)})}),t.UINode.removeChild(o)},1),e.cards_test.length>0&&this.ZJHTest.testCardType(e.cards_test),f.AudioManager.playSFX("start_game"),1==this.gameType&&(this.centerPanel.hideFriendBtn(),this.avatarPanel.forEach(function(e,t){e.setReadyIcon(!1)}))},t.prototype.dealCardsAni=function(e){var t=this,n=l.default.DEAL_CARD_COUNT,o=this.node_center.convertToWorldSpaceAR(this.node_ani.position);if(l.default.PLAYER_DATAS.forEach(function(e,a){var i=d.default.getInstance().getLocalIndex(e.seat_id),r=t.cardPanel[i];r.initCard(i);for(var l=r.node.convertToNodeSpaceAR(o),s=function(e){var t=r.node_poker.children[e];t.opacity=0,t.scale=1.1,t.active=!0;var n=t.getPosition(),o=.5*e;t.setPosition(l),t.getComponent("createPoker").createPoker(0),t.runAction(cc.sequence(cc.delayTime(.15*o),cc.spawn(cc.moveTo(.15,n),cc.fadeIn(.15)),cc.callFunc(function(){t.setPosition(n)})))},c=0;c<n;c++)s(c)}),e){console.log("\u5ef6\u65f6\u65f6\u95f4CallBack->>>",.3),this.scheduleOnce(function(){e()},.3)}f.AudioManager.playSFX("licensing")},t.prototype.showCardAni=function(e){for(var t=this,n=l.default.MAX_CARD_COUNT,o=d.default.getInstance().getLocalIndex(e.seat_id),a=e.val_type,i=this.cardPanel[o],r=function(r){var s=i.node_poker.children[r];s.opacity=255,s.scale=1.1,s.active=!0,s.position=0==o?l.default.CARD_POS.MY_CARD_POS[0]:l.default.CARD_POS.OTHER_CARD_POS[0],s.getComponent("createPoker").createPoker(e.card_arr[r]),s.runAction(cc.sequence(cc.moveTo(.25,0==o?l.default.CARD_POS.MY_CARD_POS[r]:l.default.CARD_POS.OTHER_CARD_POS[r]),cc.callFunc(function(){r==n-1&&t.cardPanel[o].setCardType(a)})))},s=0;s<n;s++)r(s);0==o&&(this.is_Show=!0),f.AudioManager.playSFX("flop")},t.prototype.onSubTurnHandle=function(e){if(this.is_Match)C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px");else{var t=d.default.getInstance().getLocalIndex(e.turn_seat_id);0==t?(C.LogWrap.log("\u8f6e\u5230\u6211\u64cd\u4f5c"),this.is_TurnMe=!0):this.is_TurnMe=!1,this.is_Lose||(this.centerPanel.showBtnHandle(),0==t?(this.limit_arr=e.handle_status.limit_arr,this.centerPanel.setViewBtnHandle(e.handle_status)):this.centerPanel.hideViewBtnHandle()),this.is_AllIn=e.handle_status.can_allin,C.LogWrap.log("\u5f53\u524d\u6309\u94ae\u7b79\u7801\u6570\u636e\u503c",e.current_chip_num),C.LogWrap.log("\u662f\u5426\u5df2\u770b\u724c",this.is_Look),this.centerPanel.setViewBattleAndCallNum(e.current_chip_num,this.is_Look,this.is_AllIn),this.centerPanel.hideRaiseNode(),this.centerPanel.setViewRound(e.current_num_round,e.total_num_round),this.centerPanel.setViewChipSum(e.total_chip_num),this.cardPanel.forEach(function(e){e.onKillTimer()}),this.cardPanel[t].setGameTimer(e.time_out,t)}},t.prototype.onSubLookCard=function(e){if(this.is_Match)C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px");else{var t=d.default.getInstance().getLocalIndex(e.seat_id),n=d.default.getInstance().getUserSexByID(e.seat_id);0==t&&(C.LogWrap.log("\u6211\u770b\u724c\u4e86"),this.is_Look=!0,this.is_AllIn=e.handle_status.can_allin,this.limit_arr=e.handle_status.limit_arr,this.is_TurnMe&&this.centerPanel.setViewBtnHandleSpecial(e.handle_status),this.is_AllIn||this.centerPanel.setViewBattleAndCallNum(e.current_chip_num,this.is_Look,e.can_allin),this.showCardAni(e));var o=1==n?"male":"female";f.AudioManager.playGameSFX(o+"/kanpai"),this.avatarPanel[t].setViewPlayerStatus("kanpai")}},t.prototype.onSubFoldCard=function(e){if(this.is_Match)C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px");else{var t=d.default.getInstance().getLocalIndex(e.seat_id),n=d.default.getInstance().getUserSexByID(e.seat_id);0==t?(this.is_Lose=!0,this.centerPanel.hideBtnLook(),this.centerPanel.hideBtnHandle(),this.centerPanel.hideRaiseNode(),this.avatarPanel.forEach(function(e,t){e.hideBattleBlink()}),this.isStartGame=!1,0==this.gameType&&this.showReady(),this.is_Show||this.showCardAni(e)):(this.cardPanel[t].foldCardAni(),this.cardPanel[t].hideCardType()),this.cardPanel.forEach(function(e){e.onKillTimer()}),this.avatarPanel[t].setViewPlayerStatus("qipai");var o=1==n?"male":"female";f.AudioManager.playGameSFX(o+"/qipai")}},t.prototype.onSubCallChip=function(e){if(this.is_Match)C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px");else{var t=d.default.getInstance().getLocalIndex(e.seat_id),n=d.default.getInstance().getUserSexByID(e.seat_id);if(0==t){var o=e.can_allin;this.is_AllIn=o,o&&this.centerPanel.setViewBtnAllIn(),this.centerPanel.hideViewBtnHandle(),this.cardPanel.forEach(function(e){e.onKillTimer()})}var a=parseFloat(e.call_chip);C.LogWrap.log("%c \u8ddf\u6ce8\u7b79\u7801","color:red;",a),a>0&&this.setViewCallAni(t,a),this.avatarPanel[t].setUserScore(e.gold);var i=1==n?"male":"female";f.AudioManager.playGameSFX(i+"/genzhu")}},t.prototype.onSubRaiseChip=function(e){if(this.is_Match)C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px");else{var t=d.default.getInstance().getLocalIndex(e.seat_id),n=d.default.getInstance().getUserSexByID(e.seat_id);if(0==t){var o=e.can_allin;this.is_AllIn=o,o&&this.centerPanel.setViewBtnAllIn(),this.centerPanel.hideViewBtnHandle(),this.cardPanel.forEach(function(e){e.onKillTimer()})}var a=e.raise_chip;C.LogWrap.log("%c \u52a0\u6ce8\u7b79\u7801","color:red;",a),a>0&&this.setViewCallAni(t,a),this.avatarPanel[t].setUserScore(e.gold);var i=1==n?"male":"female";f.AudioManager.playGameSFX(i+"/jiazhu")}},t.prototype.setViewCallAni=function(e,t){var n=e,o=this.avatarPanel[n].getNodePosition(),a=cc.instantiate(this.spr_jetton);a.position=o,a.getChildByName("num").getComponent(cc.Label).string=t,a.active=!0;var i=this.getRandomInt(-230,230),r=this.getRandomInt(-40,40),l=this.getRandomInt(-360,360),s=cc.spawn(cc.moveTo(.2,cc.v2(i,r)),cc.rotateTo(.3,l));a.runAction(s),this.node_area.addChild(a)},t.prototype.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.prototype.onSubBattleCan=function(e){var t=this,n=e.battle_player_arr;if(1==n.length){var o=n[0].player_id;y.NetManager.getGameProtocol().sendBattleReq(o)}else n.forEach(function(e,n){var o=d.default.getInstance().getLocalIndex(e.seat_id);t.avatarPanel[o].setBattleEvent(e.player_id)});this.centerPanel.hideViewBtnHandle(),this.centerPanel.hideRaiseNode()},t.prototype.onSubBattleNotify=function(e){var t=this;if(this.is_Match)C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px");else{this.cardPanel.forEach(function(e){e.onKillTimer()}),this.avatarPanel.forEach(function(e,t){e.hideBattleBlink()});var n=d.default.getInstance().getLocalIndex(e.sponsor_seat_id),o=d.default.getInstance().getUserSexByID(e.sponsor_seat_id);0==n&&(this.centerPanel.hideViewBtnHandle(),this.is_AllIn&&this.centerPanel.hideBtnHandle());var a=cc.instantiate(this.battle_ani);this.UINode.addChild(a),a.getComponent(h.default).setBattleAni(e);var i=cc.sequence(cc.delayTime(2),cc.callFunc(function(){t.UINode.removeChild(a);var n=e.is_sponsor_win?e.passive_seat_id:e.sponsor_seat_id,o=d.default.getInstance().getLocalIndex(n);if(C.LogWrap.log("\u5931\u8d25\u8005\u4f4d\u7f6e->>>>>>>",o),t.avatarPanel[o].setViewPlayerStatus("lose"),0==o&&(t.is_Lose=!0,t.centerPanel.hideBtnLook(),t.centerPanel.hideBtnHandle(),t.centerPanel.hideRaiseNode(),t.isStartGame=!1,0==t.gameType&&t.showReady(),!t.is_Show)){var i={card_arr:e.card_arr,val_type:e.val_type,seat_id:n};t.showCardAni(i)}t.cardPanel[o].setGreyCard()}));this.node.runAction(i);var r=parseFloat(e.battle_chip);r>0&&(this.setViewCallAni(n,r),this.centerPanel.setViewChipSum(e.total_chip_num),this.avatarPanel[n].setUserScore(e.sponsor_gold));var l=1==o?"male":"female";f.AudioManager.playGameSFX(l+"/bipai")}},t.prototype.onSubGameEnd=function(e){var t=this;console.log("\u6536\u5230\u7ed3\u7b97\u65f6\u95f4",Date.now()),this.is_Match?C.LogWrap.log("%c \u6b63\u5728\u5339\u914d\u4e2d,\u6536\u5230\u56de\u5e94\u4e0d\u505a\u5904\u7406","color:red;font-size:40px"):(this.cardPanel.forEach(function(e){e.onKillTimer()}),this.avatarPanel.forEach(function(e,t){e.hideViewPlayerStatus()}),this.centerPanel.hideBtnHandle(),this.centerPanel.hideRaiseNode(),this.centerPanel.hideBtnLook(),this.centerPanel.hideViewChipSum(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.onGameEndAni(e)}))))},t.prototype.onGameEndAni=function(e){var t=this;this.isStartGame=!1;for(var n=0,o=e.game_conclude,a=e.win_seat_id,i=0,r=0;r<o.length;r++){var s=d.default.getInstance().getLocalIndex(o[r].seat_id),c=parseFloat(o[r].score);0==s&&c<0&&(i=1),0==s&&(n=c)}var p=!0;if(1!=this.is_Lose&&0!=i||(p=!1),0==this.gameType&&0==i){P.UIManager.popup("prefabs/game/ShareBalance",{btnCallback:function(){t.centerPanel.sendMatchReq()},winGold:n||0})}this.setJettonAnimation(a,function(){var e=[];y.NetManager.protocolGameCommon.needFlushGold&&y.NetManager.protocolGameCommon.flushPlayerInfo.forEach(function(t){var n=d.default.getInstance().getLocalIndex(t.seat_id);e[n]=t.gold});for(var n=function(n){var a=d.default.getInstance().getLocalIndex(o[n].seat_id),i=e[a]?e[a]:o[n].gold,r=parseFloat(o[n].score),s=l.default.FLutter_POS,c=o[n].card_arr;if(c.length>0){var u={seat_id:o[n].seat_id,val_type:o[n].val_type,card_arr:c};0==a&&t.is_Show||t.showCardAni(u)}t.avatarPanel[a].flutterScore(r,s,function(){if(t.avatarPanel[a].setUserScore(i),n==o.length-1&&(y.NetManager.protocolGameCommon.needFlushGold=!1,t.is_Lose||0!=t.gameType||(t.initData(),p&&t.showReady()),1==t.gameType)){t.initData();var e=t.IsCheck;m.DataManager.isCreaterUser?(t.centerPanel.showFriendBtn(),t.centerPanel.onSetStartCountDown(e)):(t.centerPanel.showFriendReadyBtn(),e&&y.NetManager.protocolGameCommon.sendFriendReadyReq(0))}})},a=0;a<o.length;a++)n(a)})},t.prototype.setJettonAnimation=function(e,t){for(var n=this,o=d.default.getInstance().getLocalIndex(e),a=this.avatarPanel[o].getNodePosition(),i=0,r=0;r<this.node_area.childrenCount;r++){var l=this.node_area.children[r];l.stopAllActions(),l.runAction(cc.sequence(cc.moveTo(.5,a),cc.callFunc(function(){(i+=1)==n.node_area.childrenCount&&(n.node_area.destroyAllChildren(),t&&t())})))}},t.prototype.recoverJetton=function(e){var t=this;e.forEach(function(e,n){var o=cc.instantiate(t.spr_jetton);o.getChildByName("num").getComponent(cc.Label).string=e;var a=t.getRandomInt(-230,230),i=t.getRandomInt(-40,40),r=t.getRandomInt(-360,360);o.setPosition(cc.v2(a,i)),o.angle=r,o.active=!0,t.node_area.addChild(o)})},t.prototype.onUpdateUserScore=function(){this.isStartGame||this.avatarPanel[0].setUserScore(m.DataManager.userInfo.gold)},t.prototype.showFriendPlayerState=function(e,t){this.avatarPanel[e].setReadyIcon(!1),this.avatarPanel[e].setOfflineIcon(!1),1==t?this.avatarPanel[e].setReadyIcon(!0):2==t?this.avatarPanel[e].setOfflineIcon(!0):3!=t&&6!=t||(this.avatarPanel[e].setReadyIcon(!1),this.avatarPanel[e].setOfflineIcon(!1))},a([A(p.default)],t.prototype,"avatarPanel",void 0),a([A(u.default)],t.prototype,"cardPanel",void 0),a([A(cc.Node)],t.prototype,"spr_bg",void 0),a([A(cc.Node)],t.prototype,"node_top",void 0),a([A(cc.Node)],t.prototype,"node_center",void 0),a([A(s.default)],t.prototype,"topPanel",void 0),a([A(c.default)],t.prototype,"centerPanel",void 0),a([A(cc.Node)],t.prototype,"node_ani",void 0),a([A(cc.Node)],t.prototype,"node_area",void 0),a([A(cc.Node)],t.prototype,"spr_jetton",void 0),a([A(cc.Node)],t.prototype,"UINode",void 0),a([A(cc.SpriteFrame)],t.prototype,"gold_frame",void 0),a([A(cc.Prefab)],t.prototype,"battle_ani",void 0),a([A(cc.Prefab)],t.prototype,"start_game",void 0),a([A(_.default)],t.prototype,"ZJHTest",void 0),t=a([R],t)}(cc.Component);n.default=S,cc._RF.pop()},{"../../common/log/LogWrap":void 0,"../../common/utils/Utils":void 0,"../../manager/AudioManager":void 0,"../../manager/DataManager":void 0,"../../manager/NetManager":void 0,"../../manager/ResManager":void 0,"../../manager/UIManager":void 0,"../../view/common/GameChat":void 0,"./ZJHTest":"ZJHTest","./ZJHTool":"ZJHTool","./model/CMD_ZJH":"CMD_ZJH","./ui/ZJHAvatarPanel":"ZJHAvatarPanel","./ui/ZJHBattleAni":"ZJHBattleAni","./ui/ZJHCenterPanel":"ZJHCenterPanel","./ui/ZJHPokerPanel":"ZJHPokerPanel","./ui/ZJHTopPanel":"ZJHTopPanel"}],ZJHPKAni:[function(e,t,n){"use strict";cc._RF.push(t,"aba2fKz9gRFLp92PpLYZdV6","ZJHPKAni");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("../ZJHTool"),r=e("../../../common/utils/Utils"),l=e("../../../common/UIHelper"),s=cc._decorator,c=s.ccclass,d=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.left_bg=null,t.left_head=null,t.left_vip_frame=null,t.left_vip_level=null,t.left_name=null,t.left_sign=null,t.right_bg=null,t.right_head=null,t.right_vip_frame=null,t.right_vip_level=null,t.right_name=null,t.right_sign=null,t.spine=null,t.spr_win=null,t.spr_lose=null,t}return o(t,e),t.prototype.setBattleAni=function(e){var t=this,n=e.sponsor_seat_id,o=e.passive_seat_id,a=i.default.getInstance().getPlayerInfoBySeat(n),s=i.default.getInstance().getPlayerInfoBySeat(o);this.left_name.string=r.default.getSubStringLengTxt(a.username)||r.default.getReplaceStrToStar(a.player_id),l.default.setHeadIcon(a.headimg_id,this.left_head.node),l.default.setHeadFrame(a.vip_level,this.left_vip_frame),l.default.setVipLevel(a.vip_level,this.left_vip_level),this.right_name.string=r.default.getSubStringLengTxt(s.username)||r.default.getReplaceStrToStar(s.player_id),l.default.setHeadIcon(s.headimg_id,this.right_head.node),l.default.setHeadFrame(s.vip_level,this.right_vip_frame),l.default.setVipLevel(s.vip_level,this.right_vip_level),this.left_sign.active=!1,this.right_sign.active=!1,this.spine.node.active=!0,this.spine.clearTracks(),this.spine.setToSetupPose(),this.spine.setAnimation(0,"animation",!1),this.spine.setCompleteListener(function(n,o){"animation"===(n.animation?n.animation.name:"")&&(t.spine.clearTracks(),t.spine.setToSetupPose(),t.spine.node.active=!1,t.left_sign.active=!e.is_sponsor_win,t.right_sign.active=e.is_sponsor_win)}),this.left_bg.position=cc.v2(-990,0),this.right_bg.position=cc.v2(990,0);var c=cc.moveTo(.17,cc.v2(-298,0)),d=cc.moveTo(.17,cc.v2(298,0));this.left_bg.runAction(c),this.right_bg.runAction(d);var p=cc.sequence(cc.scaleTo(.25,1.3,1.3),cc.scaleTo(.15,1,1)),u=cc.sequence(cc.scaleTo(.25,1.3,1.3),cc.scaleTo(.15,1,1));this.right_sign.getComponent(cc.Sprite).spriteFrame=e.is_sponsor_win?this.spr_lose:this.spr_win,this.left_sign.getComponent(cc.Sprite).spriteFrame=e.is_sponsor_win?this.spr_win:this.spr_lose,this.scheduleOnce(function(){t.left_sign.active=!0,t.right_sign.active=!0,e.is_sponsor_win||t.right_sign.runAction(p),e.is_sponsor_win&&t.left_sign.runAction(u)},1)},a([d(cc.Node)],t.prototype,"left_bg",void 0),a([d(cc.Sprite)],t.prototype,"left_head",void 0),a([d(cc.Node)],t.prototype,"left_vip_frame",void 0),a([d(cc.Node)],t.prototype,"left_vip_level",void 0),a([d(cc.Label)],t.prototype,"left_name",void 0),a([d(cc.Node)],t.prototype,"left_sign",void 0),a([d(cc.Node)],t.prototype,"right_bg",void 0),a([d(cc.Sprite)],t.prototype,"right_head",void 0),a([d(cc.Node)],t.prototype,"right_vip_frame",void 0),a([d(cc.Node)],t.prototype,"right_vip_level",void 0),a([d(cc.Label)],t.prototype,"right_name",void 0),a([d(cc.Node)],t.prototype,"right_sign",void 0),a([d(sp.Skeleton)],t.prototype,"spine",void 0),a([d(cc.SpriteFrame)],t.prototype,"spr_win",void 0),a([d(cc.SpriteFrame)],t.prototype,"spr_lose",void 0),t=a([c],t)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../common/UIHelper":void 0,"../../../common/utils/Utils":void 0,"../ZJHTool":"ZJHTool"}],ZJHPokerPanel:[function(e,t,n){"use strict";cc._RF.push(t,"394caWOnWdMTLZ1qdZmJP4L","ZJHPokerPanel");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(a,i){function r(e){try{s(o.next(e))}catch(e){i(e)}}function l(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(r,l)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,a,i,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(a=2&i[0]?o.return:i[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){r.label=i[1];break}if(6===i[0]&&r.label<a[1]){r.label=a[1],a=i;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(i);break}a[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../../../manager/ResManager"),s=e("../model/CMD_ZJH"),c=e("../../public/BorderTime"),d=e("../../public/createPoker"),p=cc._decorator,u=p.ccclass,h=p.property,_={1:"gaopai",2:"duizi",3:"shunzi",4:"jinhua",5:"tonghuashun",6:"baozi",235:"teshupai"},f={1:"gaopai_ditu",2:"duizi_ditu",3:"shunzi_ditu",4:"jinhua_ditu",5:"tonghuashun_ditu",6:"baozi_ditu",235:"gaopai_ditu"},v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.poker=null,t.node_poker=null,t.card_type=null,t.card_di=null,t.card_value=null,t.border_time=null,t.centerPanel=null,t.GameView=null,t}return o(t,e),t.prototype.initzation=function(e,t){this.centerPanel=e,this.GameView=t,this.initView()},t.prototype.initView=function(){this.card_type.active=!1,this.card_di.spriteFrame=null,this.card_value.spriteFrame=null,this.border_time.onKillTimer(),this.removeCard()},t.prototype.setGameTimer=function(e,t,n){this.border_time.setGameTimer({limit_time:e,all_limit_time:n||0,playAudio:0==t,vibrate:0==t})},t.prototype.onKillTimer=function(){this.border_time.onKillTimer()},t.prototype.setCardType=function(e){this.card_di.spriteFrame=null,this.card_value.spriteFrame=null,this.loadCardDi(e),this.loadCardValue(e),this.card_type.active=!0},t.prototype.hideCardType=function(){this.card_type.active=!1},t.prototype.loadCardDi=function(e){return i(this,void 0,void 0,function(){var t;return r(this,function(n){switch(n.label){case 0:return[4,l.ResManager.loadResAsync("game/zjh/res/type/"+f[e],cc.SpriteFrame)];case 1:return t=n.sent(),this.card_di.spriteFrame=t,[2]}})})},t.prototype.loadCardValue=function(e){return i(this,void 0,void 0,function(){var t;return r(this,function(n){switch(n.label){case 0:return[4,l.ResManager.loadResAsync("game/zjh/res/type/"+_[e],cc.SpriteFrame)];case 1:return t=n.sent(),this.card_value.spriteFrame=t,[2]}})})},t.prototype.initCard=function(e){for(var t=s.default.MAX_CARD_COUNT,n=0;n<t;n++){var o=cc.instantiate(this.poker);o.position=s.default.CARD_POS.MY_CARD_POS[n],o.scale=1.1,o.active=!1,this.node_poker.addChild(o)}},t.prototype.showPoker=function(e){for(var t=0;t<s.default.MAX_CARD_COUNT;t++){var n=this.node_poker.children[t];n.active=!0,n.getComponent("createPoker").createPoker(e[t])}},t.prototype.cardBackView=function(){for(var e=0;e<s.default.MAX_CARD_COUNT;e++){var t=this.node_poker.children[e];t.active=!0,t.getComponent("createPoker").createPoker()}},t.prototype.turnCardAni=function(e){if(e)for(var t=0;t<e.length;t++){this.node_poker.children[t].getComponent("createPoker").setCardAni(e[t])}else console.log("\u672a\u6709\u724c\u7684\u6570\u636esetTurnCardAni")},t.prototype.setGreyCard=function(){for(var e=0;e<this.node_poker.childrenCount;e++){this.node_poker.children[e].getComponent(d.default).setGrey(!0,100)}},t.prototype.foldCardAni=function(){for(var e,t,n,o=this,a=this.GameView.node_center.convertToWorldSpaceAR(this.GameView.node_ani.position),i=function(i){e=r.node_poker.children[i],t=r.node_poker.convertToNodeSpaceAR(a),n=cc.sequence(cc.spawn(cc.moveTo(.5,cc.v2(t.x,t.y)),cc.scaleTo(.5,0,0),cc.fadeOut(.5)),cc.callFunc(function(){4==i&&o.removeCard()})),e.runAction(n)},r=this,l=0;l<s.default.MAX_CARD_COUNT;l++)i(l)},t.prototype.removeCard=function(){this.node_poker.children.forEach(function(e,t){e.stopAllActions()}),this.node_poker.destroyAllChildren()},a([h(cc.Prefab)],t.prototype,"poker",void 0),a([h(cc.Node)],t.prototype,"node_poker",void 0),a([h(cc.Node)],t.prototype,"card_type",void 0),a([h(cc.Sprite)],t.prototype,"card_di",void 0),a([h(cc.Sprite)],t.prototype,"card_value",void 0),a([h(c.default)],t.prototype,"border_time",void 0),t=a([u],t)}(cc.Component);n.default=v,cc._RF.pop()},{"../../../manager/ResManager":void 0,"../../public/BorderTime":void 0,"../../public/createPoker":void 0,"../model/CMD_ZJH":"CMD_ZJH"}],ZJHTest:[function(e,t,n){"use strict";cc._RF.push(t,"8b3835LDztDo5ZSlYhytQOd","ZJHTest");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ZJHTool"),r=cc._decorator,l=r.ccclass,s=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.test_label=[],t}return o(t,e),t.prototype.onLoad=function(){this.node.active=!1},t.prototype.testCardType=function(e){this.node.active=!0;for(var t=0;t<e.length;t++){var n=i.default.getInstance().getLocalIndex(e[t].seat_id);this.test_label[n].string=e[t].card_val}},a([s(cc.Label)],t.prototype,"test_label",void 0),t=a([l],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./ZJHTool":"ZJHTool"}],ZJHTool:[function(e,t,n){"use strict";cc._RF.push(t,"759bd0JSNJC0Iu3e1zsXQ/C","ZJHTool");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./model/CMD_ZJH"),r=cc._decorator,l=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return o(t,e),n=t,t.getInstance=function(){return null==this.instance&&(this.instance=new n),this.instance},t.prototype.getLocalIndex=function(e){var t=i.default.MY_SEAT,n=e,o=i.default.GAME_PLAYER;return(n-t+o)%o},t.prototype.getPlayerInfoBySeat=function(e){for(var t=0;t<i.default.PLAYER_DATAS.length;t++){var n=i.default.PLAYER_DATAS[t];if(n.seat_id==e)return n}},t.prototype.UserisExist=function(){return!(i.default.MY_SEAT<0||i.default.MY_SEAT>i.default.GAME_PLAYER)},t.prototype.getPlayerCount=function(e){for(var t=0,n=0;n<i.default.GAME_PLAYER;n++)e[n]&&void 0!=e[n]&&(t+=1);return t},t.prototype.getUserSexByID=function(e){for(var t=0;t<i.default.PLAYER_DATAS.length;t++){var n=i.default.PLAYER_DATAS[t];if(n.seat_id==e)return n.sex}},t=n=a([l],t)}(cc.Component));n.default=s,cc._RF.pop()},{"./model/CMD_ZJH":"CMD_ZJH"}],ZJHTopPanel:[function(e,t,n){"use strict";cc._RF.push(t,"9a841ThN59E/LmMqdnKP4YC","ZJHTopPanel");var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../../common/utils/Utils"),r=e("../../../manager/UIManager"),l=e("../../../manager/DataManager"),s=cc._decorator,c=s.ccclass,d=s.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btn_cardType=null,t.pot_num=null,t.table_num=null,t.room_id=null,t.room_id_node=null,t._gameView=null,t}return o(t,e),t.prototype.initzation=function(e){this._gameView=e,this.initView(),this.addEvenListener()},t.prototype.initView=function(){this.pot_num.string="",this.table_num.string=""},t.prototype.addEvenListener=function(){i.default.addClickEventEND(this.btn_cardType,this.onEvenClickButton.bind(this))},t.prototype.setRoomInfo=function(e){this.table_num.string=e||""},t.prototype.setRoomId=function(e){void 0===e&&(e=""),this.room_id_node.active=!0,this.room_id.string=e},t.prototype.setBasicPot=function(e){this.pot_num.string=e},t.prototype.onEvenClickButton=function(e){"btn_cardType"==e.name&&r.UIManager.popup("prefabs/game/CardTypeList",l.DataManager.gameType)},a([d(cc.Node)],t.prototype,"btn_cardType",void 0),a([d(cc.Label)],t.prototype,"pot_num",void 0),a([d(cc.Label)],t.prototype,"table_num",void 0),a([d(cc.Label)],t.prototype,"room_id",void 0),a([d(cc.Node)],t.prototype,"room_id_node",void 0),t=a([c],t)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/DataManager":void 0,"../../../manager/UIManager":void 0}]},{},["ZJHGameScene","ZJHGameView","ZJHTest","ZJHTool","CMD_ZJH","ProtocolZJH","ZJHCmd","ZJHAvatarPanel","ZJHBattleAni","ZJHCenterPanel","ZJHPKAni","ZJHPokerPanel","ZJHTopPanel"]);