window.__require=function t(e,o,n){function i(s,a){if(!o[s]){if(!e[s]){var l=s.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!a&&c)return c(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var h=o[s]={exports:{}};e[s][0].call(h.exports,function(t){return i(e[s][1][t]||t)},h,h.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({BYBattery:[function(t,e,o){"use strict";cc._RF.push(e,"411c50RXkFFZoy0A+tNYyvw","BYBattery");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/utils/Utils"),s=t("../../../manager/NetManager"),a=cc._decorator,l=a.ccclass,c=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.self_tips=null,e.add_btn=null,e.reduce_btn=null,e.cannon_level=null,e.cannon_sp_list=[],e.cur_level=0,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.initData=function(t,e){var o=this;t?(this.add_btn.active=!0,this.reduce_btn.active=!0,this.cur_level=e.bullet_cur_level,this.updateLevel(),this.self_tips.active=!0,this.self_tips.runAction(cc.sequence(cc.scaleTo(1,1.3),cc.scaleTo(1,1),cc.callFunc(function(){o.self_tips.active=!1})))):(e.level=e.bullet_cur_level,this.updateOtherData(e))},e.prototype.addEvenListener=function(){r.default.addClickEventEND(this.add_btn,this.onEvenClickButton.bind(this)),r.default.addClickEventEND(this.reduce_btn,this.onEvenClickButton.bind(this))},e.prototype.onEvenClickButton=function(t,e){1==e?(this.cur_level=this.cur_level+1,this.cur_level>s.NetManager.getGameProtocol().BULLET_LEVEL_LIST.length-1?this.cur_level=s.NetManager.getGameProtocol().BULLET_LEVEL_LIST.length-1:s.NetManager.getGameProtocol().sendBulletChangeReq(this.cur_level),this.updateLevel()):0==e&&(this.cur_level=this.cur_level-1,this.cur_level<0?this.cur_level=0:s.NetManager.getGameProtocol().sendBulletChangeReq(this.cur_level),this.updateLevel())},e.prototype.updateLevel=function(){var t=Number(s.NetManager.getGameProtocol().BULLET_LEVEL_LIST[this.cur_level]);s.NetManager.getGameProtocol().BULLET_CUR_LEVEL=this.cur_level,this.cannon_level.string=t.toFixed(1)+"",this.changeSkin(this.cur_level)},e.prototype.updateOtherData=function(t){this.cannon_level.string=s.NetManager.getGameProtocol().BULLET_LEVEL_LIST[t.level]+"",this.changeSkin(t.level)},e.prototype.updateCannonAngle=function(t){this.cannon_sp_list.forEach(function(e,o){e.angle=t})},e.prototype.changeSkin=function(t){t<=3?(this.cannon_sp_list[0].active=!0,this.cannon_sp_list[1].active=!1,this.cannon_sp_list[2].active=!1):t<=7?(this.cannon_sp_list[0].active=!1,this.cannon_sp_list[1].active=!0,this.cannon_sp_list[2].active=!1):t<=11&&(this.cannon_sp_list[0].active=!1,this.cannon_sp_list[1].active=!1,this.cannon_sp_list[2].active=!0)},e.prototype.showLight=function(){var t=this;this.cannon_sp_list.forEach(function(e,o){e.stopAllActions(),e.x=0,e.y=-33;var n=cc.v2(0,0);n=t.calculateCoordinatePoint(cc.v2(0,-33),90-e.angle,10),e.runAction(cc.sequence(cc.moveTo(.05,n),cc.moveTo(.05,cc.v2(0,-33))));var i=e.getChildByName("paokou");i.active=!0,t.scheduleOnce(function(){i.active=!1},.1)})},e.prototype.calculateCoordinatePoint=function(t,e,o){var n=e%360,i={x:o,y:0},r=this.calculateRotate(i,n);return this.calculateCoordinateRelativePoint(t,r)},e.prototype.calculateRotate=function(t,e){var o=t.x*Math.cos(e*Math.PI/180)+t.y*Math.sin(e*Math.PI/180),n=-t.x*Math.sin(e*Math.PI/180)+t.y*Math.cos(e*Math.PI/180);return{x:Math.round(100*o)/100,y:Math.round(100*n)/100}},e.prototype.calculateCoordinateRelativePoint=function(t,e){var o=e.x+t.x,n=e.y+t.y,i={x:Math.round(100*o)/100,y:Math.round(100*n)/100};return cc.v2(i.x,i.y)},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([c(cc.Node)],e.prototype,"self_tips",void 0),i([c(cc.Node)],e.prototype,"add_btn",void 0),i([c(cc.Node)],e.prototype,"reduce_btn",void 0),i([c(cc.Label)],e.prototype,"cannon_level",void 0),i([c(cc.Node)],e.prototype,"cannon_sp_list",void 0),e=i([l],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0}],BYBulletMgr:[function(t,e,o){"use strict";cc._RF.push(e,"a7aa3ZcH9tIgIzwdx2u9yXE","BYBulletMgr");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BYBullet"),s=t("../../../manager/NetManager"),a=t("./BYPool"),l=cc._decorator,c=l.ccclass,h=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bullet=null,e.bullet_node=null,e.Player=null,e.GameView=null,e.bulletNum_Byseat=[0,0,0,0,0],e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.createBullet=function(t,e,o,n,i,s){var l,c=a.BYPool.getBullet(t);return void 0!=c&&cc.isValid(c)?((l=c.getComponent(r.default)).setBulletTag(o),l.setBulletByPlayer(e),l.initBulletSkin(t),l.setBulletPopTimes(0),l.setBulletLockState(n),l.setBulletLockFishID(i),l.setBulletBySeat(s),c.opacity=255,cc.log("\u62ff\u4e4b\u524d\u7684\u5b50\u5f39",t),c):(c=cc.instantiate(this.bullet),cc.log("\u521b\u5efa\u65b0\u5b50\u5f39",t),(l=c.getComponent(r.default)).setBulletTag(o),l.setBulletByPlayer(e),l.initBulletSkin(t),l.setBulletPopTimes(0),l.setBulletLockState(n),l.setBulletLockFishID(i),l.setBulletBySeat(s),this.bullet_node.addChild(c),c)},e.prototype.clearBullet=function(t){(t=t||this.bullet_node.children[0]).x=9999,t.y=0,t.angle=0,t.stopAllActions(),a.BYPool.putBullet(t.getComponent("BYBullet").getBulletType(),t)},e.prototype.clearAllBullet=function(){for(var t=[],e=this.bullet_node.childrenCount-1;e>=0;e--){var o=this.bullet_node.children[e];if(void 0==s.NetManager.getGameProtocol())return;t.push(o.getComponent("BYBullet").getBullstTag()+""),this.clearBullet(o)}s.NetManager.getGameProtocol().sendDisappearBulletReq(t)},e.prototype.getBulletNode=function(){return this.bullet_node},e.prototype.getDistance=function(t,e){var o=cc.v2(t.x-e.x,t.y-e.y);return Math.sqrt(o.x*o.x+o.y*o.y)},e.prototype.addBullet=function(t,e,o,n){var i=this.Player.getLocalPosBySeatID(),r=this.createBullet(t,!0,e,this.GameView.lock_shot,this.GameView.lock_shotmonsterid,s.NetManager.getGameProtocol().MY_SEATID);s.NetManager.getGameProtocol().ROTATION_STATE,r.x=1*i.x,r.y=1*i.y,r.angle=o;var a=cc.v2(r.x,r.y),l=this.getDistance(a,n)/2e3,c=cc.moveBy(l,cc.v2(n.x-r.x,n.y-r.y));r.runAction(cc.repeatForever(c)),s.NetManager.getGameProtocol().MY_bullet=s.NetManager.getGameProtocol().MY_bullet+1,console.log("\u5f53\u524d\u53d1\u5c04\u5b50\u5f39\u7684\u6570\u91cf",s.NetManager.getGameProtocol().MY_bullet)},e.prototype.addOtherBullet=function(t,e,o,n,i,r,s){var a=this.Player.getLocalPosBySeatID(t),l=this.createBullet(e,!1,o,r,s,t);l.x=a.x,l.y=a.y,l.angle=n;var c=cc.v2(l.x,l.y),h=this.getDistance(c,i)/2e3,u=cc.moveBy(h,cc.v2(i.x-l.x,i.y-l.y));l.runAction(cc.repeatForever(u)),this.bulletNum_Byseat[t]=this.bulletNum_Byseat[t]+1},e.prototype.setOhterBulletCollior=function(t,e){void 0===e&&(e=1),this.bulletNum_Byseat[t]=1==e?this.bulletNum_Byseat[t]-1:e},e.prototype.getOhterBulletCollior=function(t){return this.bulletNum_Byseat[t]<0&&(this.bulletNum_Byseat[t]=0),this.bulletNum_Byseat[t]},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([h(cc.Prefab)],e.prototype,"bullet",void 0),i([h(cc.Node)],e.prototype,"bullet_node",void 0),e=i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../manager/NetManager":void 0,"./BYBullet":"BYBullet","./BYPool":"BYPool"}],BYBullet:[function(t,e,o){"use strict";cc._RF.push(e,"db703QAQEFFcKn1eqjEhepv","BYBullet");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../manager/ResManager"),l=cc._decorator,c=l.ccclass,h=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bullet_node=null,e.bullet_id=0,e.bullet_type=0,e.bulletMgr=null,e.is_my=!0,e.is_ball=0,e.is_lock=!1,e.fishid_lock=0,e.player_seat=0,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.initBulletSkin=function(t){return r(this,void 0,void 0,function(){var e,o,n;return s(this,function(i){switch(i.label){case 0:return this.bullet_type=t,e=1,t<=3?e=1:t<=7?e=2:t<=11&&(e=3),[4,a.ResManager.loadResAsync("game/by/effect/bullet/"+e+"/zidan"+e,sp.SkeletonData)];case 1:return void 0==(o=i.sent())||void 0==this.bullet_node?[2]:((n=this.bullet_node.getComponent(sp.Skeleton)).clearTracks(),n.setToSetupPose(),n.skeletonData=o,n.animation="animation",n.node.active=!0,n.premultipliedAlpha=!1,[2])}})})},e.prototype.setBulletTag=function(t){this.bullet_id=t},e.prototype.getBullstTag=function(){return this.bullet_id},e.prototype.setBulletByPlayer=function(t){this.is_my=t},e.prototype.getBulletByPlayer=function(){return this.is_my},e.prototype.setBulletPopTimes=function(t){this.is_ball=t},e.prototype.getBulletPopTimes=function(){return this.is_ball},e.prototype.getBulletType=function(){return this.bullet_type},e.prototype.setBulletLockState=function(t){this.is_lock=t},e.prototype.getBulletLockState=function(){return this.is_lock},e.prototype.setBulletLockFishID=function(t){this.fishid_lock=t},e.prototype.getBulletLockFishID=function(){return this.fishid_lock},e.prototype.setBulletBySeat=function(t){this.player_seat=t},e.prototype.getBulletBySeat=function(){return this.player_seat},i([h(cc.Node)],e.prototype,"bullet_node",void 0),e=i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../manager/ResManager":void 0}],BYCmd:[function(t,e,o){"use strict";cc._RF.push(e,"f2128o0Bz1DK7+WX3CgS7xO","BYCmd"),Object.defineProperty(o,"__esModule",{value:!0}),o.BYCmd="228_0",o.ProtocolBYCmd={GameBulletCreateRes:o.BYCmd+"_game_bullet_create_res",GameBulletDisappearRes:o.BYCmd+"_game_bullet_disappear_res",GameFishFreshNotify:o.BYCmd+"_game_fish_fresh_notify",GameFishDiedNotify:o.BYCmd+"_game_fish_died_notify",GameReconnectInfo:o.BYCmd+"_game_reconnect_info",GameErrRes:o.BYCmd+"_game_err_res",GameOtherJoin:o.BYCmd+"_game_other_join",GameOtherLeave:o.BYCmd+"_game_other_leave",GameBulletChangeRes:o.BYCmd+"_game_bullet_change_res",GameBulletAttackRes:o.BYCmd+"_game_bullet_attack_res",NewGameFishFreshNotify:o.BYCmd+"_new_game_reconnect_info",PlayerDisConnect:o.BYCmd+"_player_dis_connect",SendStatus:o.BYCmd+"_send_status",FreshGold:o.BYCmd+"_fresh_gold",GetBYGameInofRep:"11_0_get_mfwzgame_info_res"},cc._RF.pop()},{}],BYDefine:[function(t,e,o){"use strict";var n,i,r,s,a,l,c;cc._RF.push(e,"ccd8c5RqQdCsLpBRnMmyEpk","BYDefine"),Object.defineProperty(o,"__esModule",{value:!0}),o.BYEffectUrl="game/by/effect/fish/",function(t){t[t.PLIST=0]="PLIST",t[t.SPINE=1]="SPINE",t[t.OTHER=2]="OTHER"}(c=o.BYEffectType||(o.BYEffectType={})),o.SpecilUrl20=[o.BYEffectUrl+"fishpic10",o.BYEffectUrl+"fishpic11",o.BYEffectUrl+"fishpic12",o.BYEffectUrl+"fishpic13"],o.SpecilUrl26=[o.BYEffectUrl+"fishpic19",o.BYEffectUrl+"fishpic20",o.BYEffectUrl+"fishpic21",o.BYEffectUrl+"fishpic22"],o.FishUrl=((n={})[0]=o.BYEffectUrl+"fishpic1",n[1]=o.BYEffectUrl+"fishpic1",n[2]=o.BYEffectUrl+"fishpic1",n[3]=o.BYEffectUrl+"fishpic1",n[4]=o.BYEffectUrl+"fishpic1",n[5]=o.BYEffectUrl+"fishpic1",n[6]=o.BYEffectUrl+"fishpic1",n[7]=o.BYEffectUrl+"fishpic1",n[8]=o.BYEffectUrl+"fishpic1",n[9]=o.BYEffectUrl+"fishpic2",n[10]=o.BYEffectUrl+"fishpic2",n[11]=o.BYEffectUrl+"fishpic2",n[12]=o.BYEffectUrl+"fishpic5",n[13]=o.BYEffectUrl+"fishpic4",n[14]=o.BYEffectUrl+"fishpic5",n[15]=o.BYEffectUrl+"fishpic6",n[16]=o.BYEffectUrl+"fishpic6",n[17]=o.BYEffectUrl+"fishpic4",n[18]=o.BYEffectUrl+"fishpic7",n[19]=o.BYEffectUrl+"fishpic8",n[20]=o.BYEffectUrl+"21/21",n[21]=o.BYEffectUrl+"32/32",n[22]=o.BYEffectUrl+"33/33",n[23]=o.BYEffectUrl+"34/34",n[24]=o.BYEffectUrl+"35/35",n[25]=o.BYEffectUrl+"36/36",n[26]=o.BYEffectUrl+"37/37",n[27]=o.BYEffectUrl+"38/38",n[121]=o.BYEffectUrl+"fishpic2",n[122]=o.BYEffectUrl+"23/23",n[123]=o.BYEffectUrl+"24/24",n[124]=o.BYEffectUrl+"25/25",n[125]=o.BYEffectUrl+"26/26",n[126]=o.SpecilUrl26,n[127]=o.BYEffectUrl+"fishpic24",n[128]=o.BYEffectUrl+"fishpic25",n[129]=o.BYEffectUrl+"fishpic27",n[130]=o.BYEffectUrl+"31/31",n),o.SoureType=((i={})[0]=c.PLIST,i[1]=c.PLIST,i[2]=c.PLIST,i[3]=c.PLIST,i[4]=c.PLIST,i[5]=c.PLIST,i[6]=c.PLIST,i[7]=c.PLIST,i[8]=c.PLIST,i[9]=c.PLIST,i[10]=c.PLIST,i[11]=c.PLIST,i[12]=c.PLIST,i[13]=c.PLIST,i[14]=c.PLIST,i[15]=c.PLIST,i[16]=c.PLIST,i[17]=c.PLIST,i[18]=c.PLIST,i[19]=c.PLIST,i[20]=c.SPINE,i[21]=c.SPINE,i[22]=c.SPINE,i[23]=c.SPINE,i[24]=c.SPINE,i[25]=c.SPINE,i[26]=c.SPINE,i[27]=c.SPINE,i[121]=c.PLIST,i[122]=c.SPINE,i[123]=c.SPINE,i[124]=c.SPINE,i[125]=c.SPINE,i[126]=c.OTHER,i[127]=c.PLIST,i[128]=c.PLIST,i[129]=c.PLIST,i[130]=c.SPINE,i),o.FrameName=((r={})[0]="hot",r[1]="02_000",r[2]="03_000",r[3]="04_000",r[4]="05_000",r[5]="xiaochou",r[6]="06_000",r[7]="07_000",r[8]="08_000",r[9]="hetun_",r[10]="12_000",r[11]="000",r[12]="hm_swim000",r[13]="lamb_swim",r[14]="swim_000",r[15]="turtle_swim",r[16]="devil_swim0",r[17]="shark_swim",r[18]="swim",r[19]="swim1_",r[20]="00",r[21]="",r[22]="",r[23]="",r[24]="",r[25]="",r[26]="",r[27]="",r[121]="10_000",r[122]="",r[123]="",r[124]="",r[125]="",r[126]="fish",r[127]="swim2_",r[128]="swim",r[129]="00",r[130]="",r),o.SpecilFrameNum=[4,4,4,3],o.FrameNum=((s={})[0]=13,s[1]=13,s[2]=13,s[3]=13,s[4]=22,s[5]=14,s[6]=13,s[7]=13,s[8]=13,s[9]=12,s[10]=13,s[11]=13,s[12]=13,s[13]=13,s[14]=14,s[15]=13,s[16]=14,s[17]=13,s[18]=14,s[19]=13,s[20]="",s[21]="",s[22]="",s[23]="",s[24]="",s[25]="",s[26]="",s[27]="",s[121]=13,s[122]="",s[123]="",s[124]="",s[125]="",s[126]=o.SpecilFrameNum,s[127]=10,s[128]=13,s[129]=13,s[130]="",s),o.FishSizeList={w:(a={},a[0]=33,a[1]=40,a[2]=74,a[3]=40,a[4]=55,a[5]=51,a[6]=36,a[7]=44,a[8]=53,a[9]=83,a[10]=53,a[11]=65,a[12]=41,a[13]=122,a[14]=151,a[15]=107,a[16]=201,a[17]=315,a[18]=278,a[19]=330,a[20]=674,a[21]=84,a[22]=197,a[23]=248,a[24]=101,a[25]=198,a[26]=59,a[27]=54,a[121]=84,a[122]=308,a[123]=100,a[124]=400,a[125]=399,a[126]=545,a[127]=188,a[128]=318,a[129]=430,a[130]=475,a),h:(l={},l[0]=23,l[1]=21,l[2]=49,l[3]=21,l[4]=33,l[5]=33,l[6]=40,l[7]=26,l[8]=72,l[9]=36,l[10]=26,l[11]=29,l[12]=87,l[13]=72,l[14]=161,l[15]=67,l[16]=119,l[17]=101,l[18]=95,l[19]=133,l[20]=381,l[21]=101,l[22]=110,l[23]=147,l[24]=72,l[25]=79,l[26]=49,l[27]=42,l[121]=71,l[122]=328,l[123]=100,l[124]=365,l[125]=428,l[126]=342,l[127]=283,l[128]=109,l[129]=215,l[130]=200,l)},cc._RF.pop()},{}],BYFishMgr:[function(t,e,o){"use strict";cc._RF.push(e,"2b357nesDRDmI6yXN8Cgrxo","BYFishMgr");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./BYFish"),l=t("../../../manager/ResManager"),c=t("../../../manager/NetManager"),h=t("../../by/protocol/BYDefine"),u=t("./BYPool"),p=cc._decorator,d=p.ccclass,f=p.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fish=null,e.fish_node=null,e.fish_shoul_node=null,e.init_pos=[],e.GameView=null,e.fish_size={w:{},h:{}},e.fishid_test=0,e.fish_pool=null,e.fish_new_pool={},e.fish_id=0,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.fish_size=h.FishSizeList},e.prototype.createFish=function(t,e,o,n){void 0===o&&(o=!1),void 0===n&&(n=null);var i=u.BYPool.getFish(t);if(void 0!=i&&cc.isValid(i))return(r=i.getComponent(a.default)).setFishTag(e),r.setFishLiveState(o),r.setFishRotateState(o),i.opacity=255,cc.log("\u62ff\u4e4b\u524d\u7684\u9c7c",t),i;cc.log("\u62ff\u4e4b\u524d\u7684\u9c7c\u6ca1\u53d6\u5230",t),i=cc.instantiate(this.fish),cc.log("\u521b\u5efa\u65b0\u9c7c",t);var r=i.getComponent(a.default),s=cc.size(this.fish_size.w[t-1],this.fish_size.h[t-1]);return r.createFish(t,s,this.GameView.lock_shot,this.setectMonster.bind(this),n),r.setFishTag(e),r.setFishLiveState(o),r.setFishRotateState(o),i.opacity=255,this.fish_node.addChild(i),i},e.prototype.clearFish=function(t,e){var o=this;void 0===e&&(e=0),0==e?((t=t||this.fish_node.children[0]).x=2e4,t.y=0,t.scale=1,t.angle=0,t.stopAllActions(),u.BYPool.putFish(t.getComponent("BYFish").getFishType(),t)):this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(){(t=t||o.fish_node.children[0]).x=2e4,t.y=0,t.scale=1,t.angle=0,t.stopAllActions(),u.BYPool.putFish(t.getComponent("BYFish").getFishType(),t)})))},e.prototype.clearAllFish=function(){for(var t=this.fish_node.childrenCount,e=0;e<t;e++){var o=this.fish_node.children[e];cc.isValid(o)&&this.clearFish(o)}},e.prototype.addRunAllFish=function(){for(var t=this,e=this.fish_node.childrenCount,o=function(e){var o=n.fish_node.children[e];o.stopAllActions(),o.getComponent(a.default).setFishDi(!1);var i=-1e3;c.NetManager.getGameProtocol().ROTATION_STATE&&(i=1e3),o.runAction(cc.sequence(cc.moveBy(.5,cc.v2(i,0)),cc.callFunc(function(){t.clearFish(o)})))},n=this,i=0;i<e;i++)o(i)},e.prototype.getDistance=function(t,e){var o=cc.v2(t.x-e.x,t.y-e.y);return Math.sqrt(o.x*o.x+o.y*o.y)},e.prototype.initRouteData=function(t,e,o){return r(this,void 0,void 0,function(){var n,i,r,h,u,p,d,f,_,y=this;return s(this,function(s){switch(s.label){case 0:return[4,l.ResManager.loadResAsync("game/by/res/txt/route"+e,cc.Asset)];case 1:return void 0==(n=s.sent())?[2]:(i=JSON.parse(n.text)).speed<o?((_=t.getComponent(a.default)).setBekPos(void 0),_.setFishLiveState(!1),this.clearFish(t),[2]):(r=i.speed/i.points.length,h=Math.round(o/r),u=i.speed-r*h,i.points.splice(0,h),i.points.length>1?(c.NetManager.getGameProtocol().ROTATION_STATE?i.points[0].x>i.points[i.points.length-1].x&&(t.scaleY=-t.scale):i.points[0].x<i.points[i.points.length-1].x&&(t.scaleY=-t.scale),t.opacity=255,p=cc.cardinalSplineBy(u,i.points,0),_=t.getComponent(a.default),d=cc.sequence(p,cc.callFunc(function(){void 0!=t&&(y.GameView.touch_monster&&y.GameView.lock_shotmonsterid==_.getFishTag()&&(_.setFishDi(!1),y.GameView.stopLockShot()),_.setBekPos(void 0),y.clearFish(t))})),t.runAction(d),this.scheduleOnce(function(){_.setFishLiveState(!0)},.1),f=cc.v2(i.points[0].x,i.points[0].y),_.setBekPos(f),_.delayAddFishTips()):((_=t.getComponent(a.default)).setBekPos(void 0),_.setFishLiveState(!1),this.clearFish(t)),[2])}})})},e.prototype.addFish=function(t,e,o){void 0===o&&(o=!1);var n=t.fish_type,i=e.line,r=null;if(o){var s={fishtype:[],fishid:[]},a=[],l=[];e.fish_info.forEach(function(t,e){t.fish_type<100&&t.fish_id.forEach(function(e,o){a.push(t.fish_type),l.push(e)})}),s.fishtype=a,s.fishid=l,r=this.createFish(n,t.fish_id[0],!1,s)}else r=this.createFish(n,t.fish_id[0]);r.scale=e.fish_size,this.setFishSize(r,e.fish_size);var c=this.fish_size.w[n-1],h=this.fish_size.h[n-1];r.width=c*e.fish_size,r.height=h*e.fish_size,r.x=0,r.y=0,r.opacity=0,this.initRouteData(r,i+1,e.time)},e.prototype.setectMonster=function(t){this.GameView.touch_monster=!0,this.GameView.lockShotBack(t)},e.prototype.getFishNode=function(){return this.fish_node},e.prototype.getInitPosList=function(){return this.init_pos},e.prototype.onDestroy=function(){this.fish_new_pool=[],this.unscheduleAllCallbacks()},e.prototype.initShoulRouteData=function(t){return r(this,void 0,void 0,function(){var e,o,n,i,r,a,c,h,u=this;return s(this,function(s){switch(s.label){case 0:return e=t.form+1,[4,l.ResManager.loadResAsync("game/by/res/txt/routeshoul"+e,cc.Asset)];case 1:return void 0==(o=s.sent())?[2]:(n=JSON.parse(o.text),0!=t.time&&(i=0,i=n.points[0].x>n.points[1].x?1:-1,r=(n.points[0].x-n.points[1].x)*i,a=r/n.speed,c=n.speed-t.time,h=c*a,n.points[0].x=n.points[1].x+h*i,n.speed=c),n.shoul.forEach(function(e,o){for(var i={speed:n.speed,points:n.points},r=0;r<e.length;r++)void 0==t.fish_info[o]&&(t.fish_info[o]={fish_id:[],fish_type:0},t.fish_info[o].fish_id[r]=1154,t.fish_info[o].fish_type=3),u.addShouFish(t.fish_info[o].fish_id[r],t.fish_info[o].fish_type,cc.v2(e[r].x,e[r].y),i,t.fish_size)}),[2])}})})},e.prototype.addShouFish=function(t,e,o,n,i){var r=this;if(0!=t){var s=e,l=this.createFish(s,t,!0),h=this.fish_size.w[s-1],u=this.fish_size.h[s-1];l.scale=i,this.setFishSize(l,i),l.width=h*i,l.height=u*i,l.x=o.x,l.y=o.y,l.opacity=0,n.points[0].x<n.points[1].x&&(l.angle=180),c.NetManager.getGameProtocol().ROTATION_STATE?n.points[0].x>n.points[1].x&&(l.scaleY=-1*i):n.points[0].x<n.points[1].x&&(l.scaleY=-1*i);var p=cc.cardinalSplineBy(n.speed,n.points,0),d=cc.sequence(p,cc.callFunc(function(){var t=l.getComponent(a.default);t.setFishDi(!1),r.GameView.touch_monster&&r.GameView.lock_shotmonsterid==t.getFishTag()&&r.GameView.stopLockShot(),t.setBekPos(void 0),r.clearFish(l)}));l.opacity=255,l.runAction(d)}},e.prototype.setFishSize=function(t,e){t.getComponent(a.default).setFishSize(e)},e.prototype.setInit=function(){for(var t=1;t<29;t++)this.initFishPos(t);for(t=122;t<132;t++)this.initFishPos(t)},e.prototype.initFishPos=function(t){return r(this,void 0,void 0,function(){var e,o;return s(this,function(n){switch(n.label){case 0:return[4,l.ResManager.loadResAsync("game/by/res/posfish/fishcircle"+t,cc.Asset)];case 1:return void 0==(e=n.sent())?[2]:(o=JSON.parse(e.text),c.NetManager.getGameProtocol().INSTER_DATA[t]=o,[2])}})})},i([f(cc.Prefab)],e.prototype,"fish",void 0),i([f(cc.Node)],e.prototype,"fish_node",void 0),i([f(cc.Node)],e.prototype,"fish_shoul_node",void 0),e=i([d],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0,"../../by/protocol/BYDefine":"BYDefine","./BYFish":"BYFish","./BYPool":"BYPool"}],BYFish:[function(t,e,o){"use strict";cc._RF.push(e,"f88c89v8itA0LS1EX5xoTAR","BYFish");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../common/utils/Utils"),l=t("../../../manager/ResManager"),c=t("../../../manager/NetManager"),h=t("../../by/protocol/BYDefine"),u=t("./BYPool"),p=cc._decorator,d=p.ccclass,f=p.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.yel_bmfont=null,e.black_bmfont=null,e.fish_node=null,e.fish_id=0,e.fish_type=0,e.monster_skintype=0,e.live_state=!0,e.rotate_state=!0,e.click_call=null,e.dot1=null,e.bek_pos=cc.v2(0,0),e.click_pos=[],e.route_fish=null,e.fish_size=null,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.createFish=function(t,e,o,n,i){var r=this;void 0===i&&(i=null),this.clearAddNode(),this.click_pos=[],this.node.scale=1,this.fish_id=0,this.click_call=n,this.fish_type=t,this.initFishEffect(t);var s=new cc.Node;s.addComponent(cc.Button),s.width=e.width,s.height=e.height,s.active=o,this.node.addChild(s,0,"click");var l=this;if(a.default.addClickEventEND(s,function(){l.click_call(l.fish_id),l.setFishDi(!0)}),this.dot1=e,null!=i){var c=[];1==i.fishtype.length?c[0]=cc.v2(0,0):3==i.fishtype.length?(c[0]=cc.v2(-82,124),c[1]=cc.v2(137,5),c[2]=cc.v2(-79,-126)):4==i.fishtype.length&&(c[0]=cc.v2(-110,93),c[1]=cc.v2(110,93),c[2]=cc.v2(-110,-93),c[3]=cc.v2(110,-93)),i.fishtype.forEach(function(t,e){r.addMoreFish(t,c[e],e)})}},e.prototype.initFishEffect=function(t){return r(this,void 0,void 0,function(){var e,o,n,i,r,a,c;return s(this,function(s){switch(s.label){case 0:return 0!=h.SoureType[t-1]?[3,2]:((o=new cc.Node).addComponent(cc.Animation),o.addComponent(cc.Sprite),n=o.getComponent(cc.Sprite),this.fish_node=o.getComponent(cc.Animation),n.sizeMode=cc.Sprite.SizeMode.RAW,n.trim=!1,this.node.addChild(o,1,"fish"),o.removeAllChildren(),[4,l.ResManager.loadResAsync(h.FishUrl[t-1],cc.SpriteAtlas)]);case 1:return i=s.sent(),this.creatorAnimation(o.getComponent(cc.Animation),i,"move",h.FrameNum[t-1],h.FrameName[t-1]),129==t&&this.addTurnTable(),[3,9];case 2:return 1!=h.SoureType[t-1]?[3,4]:[4,l.ResManager.loadResAsync(h.FishUrl[t-1],sp.SkeletonData)];case 3:return e=s.sent(),(o=new cc.Node).addComponent(sp.Skeleton),this.node.addChild(o,1,"fish"),this.fish_node=o.getComponent(sp.Skeleton),void 0==e||void 0==this.fish_node?[2]:(this.fish_node.clearTracks(),this.fish_node.setToSetupPose(),this.fish_node.skeletonData=e,this.fish_node.animation="animation",this.fish_node.node.active=!0,this.fish_node.premultipliedAlpha=!1,this.fish_node.enableBatch=!0,124==t&&this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){}))),[3,9]);case 4:(o=new cc.Node).addComponent(cc.Animation),o.addComponent(cc.Sprite),n=o.getComponent(cc.Sprite),this.fish_node=o.getComponent(cc.Animation),n.sizeMode=cc.Sprite.SizeMode.RAW,n.trim=!1,this.node.addChild(o,1,"fish"),o.removeAllChildren(),i=[],r=0,s.label=5;case 5:return r<h.FrameNum[t-1].length?(a=i,c=r,[4,l.ResManager.loadResAsync(h.FishUrl[t-1][r],cc.SpriteAtlas)]):[3,8];case 6:a[c]=s.sent(),s.label=7;case 7:return r++,[3,5];case 8:this.creatorAnimation(this.fish_node,i,"move",h.FrameNum[t-1],h.FrameName[t-1]),s.label=9;case 9:return[2]}})})},e.prototype.creatorAnimation=function(t,e,o,n,i){if(void 0!=t){var r=[];if(void 0!=e.length)for(var s=0;s<e.length;s++)for(var a=1;a<=n[s];a++){var l=this.PrefixInteger(s*n[s]+a,2);(c=e[s].getSpriteFrame(i+l))&&r.push(c)}else for(a=1;a<=n;a++){var c;l=this.PrefixInteger(a,2);(c=e.getSpriteFrame(i+l))&&r.push(c)}var h=cc.AnimationClip.createWithSpriteFrames(r,r.length);h.wrapMode=cc.WrapMode.Loop,h.name=o,t.addClip(h),t.play(o)}},e.prototype.PrefixInteger=function(t,e){return(Array(e).join("0")+t).slice(-e)},e.prototype.setBekPos=function(t){this.bek_pos=t},e.prototype.getBekPos=function(){return this.bek_pos},e.prototype.getPosList=function(){return this.click_pos},e.prototype.setFishDi=function(t){return r(this,void 0,void 0,function(){var e,o,n,i,r;return s(this,function(s){switch(s.label){case 0:return t?(r=this.node.getChildByName("miaozhun"))?(r.opacity=255,[2]):(e=c.NetManager.getGameProtocol().INSTER_DATA[this.fish_type],[4,l.ResManager.loadResAsync("game/by/effect/sceneef/miaozhun",sp.SkeletonData)]):[3,2];case 1:return void 0==(o=s.sent())?[2]:((n=new cc.Node).addComponent(sp.Skeleton),n.x=e[0].x,n.y=e[0].y,n.scale=1/this.node.scale*.7,(i=n.getComponent(sp.Skeleton)).skeletonData=o,this.node.addChild(n,999,"miaozhun"),i.loop=!0,i.animation="animation",i.premultipliedAlpha=!1,[3,3]);case 2:(r=this.node.getChildByName("miaozhun"))&&(r.opacity=0),s.label=3;case 3:return[2]}})})},e.prototype.setFishTag=function(t){this.fish_id=t},e.prototype.getFishTag=function(){return this.fish_id},e.prototype.setFishRotateState=function(t){this.rotate_state=t},e.prototype.getFishRotateState=function(){return this.rotate_state},e.prototype.setFishLiveState=function(t){this.live_state=t},e.prototype.getFishLiveState=function(){return this.live_state},e.prototype.getFishType=function(){return this.fish_type},e.prototype.setFishSize=function(t){this.fish_size=t},e.prototype.getFishSize=function(){return this.fish_size},e.prototype.setRouteData=function(t){this.route_fish=t},e.prototype.getRouteData=function(){return this.route_fish},e.prototype.addTurnTable=function(){return r(this,void 0,void 0,function(){var t,e,o,n;return s(this,function(i){switch(i.label){case 0:return[4,l.ResManager.loadResAsync("game/by/effect/game/fanbzp",sp.SkeletonData)];case 1:return t=i.sent(),e=c.NetManager.getGameProtocol().INSTER_DATA[this.fish_type],void 0==t?[2]:((o=new cc.Node).addComponent(sp.Skeleton),(n=o.getComponent(sp.Skeleton)).skeletonData=t,this.node.addChild(o,0,"fanbzp"),n.loop=!0,n.animation="fanbzp",n.premultipliedAlpha=!1,n.enableBatch=!0,o.scale=.5,o.x=e[0].x,o.y=e[0].y,[2])}})})},e.prototype.playBoom=function(t,e){return r(this,void 0,void 0,function(){return s(this,function(t){return u.BYPool.playBoom(this.fish_type,e,this.node),[2]})})},e.prototype.setFishTouchState=function(t){this.node.getChildByName("click").active=t},e.prototype.setFishColor=function(){null!=this.fish_node&&void 0!=this.fish_node&&(this.fish_node.node.color=cc.color(170,88,88),this.scheduleOnce(function(){this.fish_node.node.color=cc.color(255,255,255)},.3))},e.prototype.delayAddFishTips=function(){124==this.fish_type&&this.addFishTips(124)},e.prototype.addFishTips=function(t){return r(this,void 0,void 0,function(){var e,o,n,i;return s(this,function(r){switch(r.label){case 0:return e=null,void 0!=(e=this.node.getChildByName("fishtxt"))&&cc.isValid(e)?[3,3]:[3,1];case 1:return[4,l.ResManager.loadResAsync("game/by/res/fish_add"+t,cc.SpriteFrame)];case 2:o=r.sent(),(e=new cc.Node).addComponent(cc.Sprite),(n=e.getComponent(cc.Sprite)).sizeMode=cc.Sprite.SizeMode.RAW,n.trim=!1,n.spriteFrame=o,e.scale=.32,e.y=40,this.node.addChild(e,20,"fishtxt"),r.label=3;case 3:return i=1,this.node.scaleY<0&&(i=-1),e.scaleX=.32*i,[2]}})})},e.prototype.updateFishAction=function(t){return void 0===t&&(t=null),r(this,void 0,void 0,function(){var e,o,n,i,r;return s(this,function(s){switch(s.label){case 0:return this.node.removeChild(this.node.getChildByName("fish")),e=this.fish_type,o=t||h.FrameName[e-1],(n=new cc.Node).addComponent(cc.Animation),n.addComponent(cc.Sprite),i=n.getComponent(cc.Sprite),this.fish_node=n.getComponent(cc.Animation),i.sizeMode=cc.Sprite.SizeMode.RAW,i.trim=!1,this.node.addChild(n,1,"fish"),n.removeAllChildren(),[4,l.ResManager.loadResAsync(h.FishUrl[e-1],cc.SpriteAtlas)];case 1:return r=s.sent(),this.creatorAnimation(this.fish_node,r,"move",h.FrameNum[e-1],o),[2]}})})},e.prototype.addMoreFish=function(t,e,o){return r(this,void 0,void 0,function(){var n,i,r,a;return s(this,function(s){switch(s.label){case 0:return(n=new cc.Node).addComponent(cc.Animation),n.addComponent(cc.Sprite),i=n.getComponent(cc.Sprite),r=n.getComponent(cc.Animation),i.sizeMode=cc.Sprite.SizeMode.RAW,i.trim=!1,this.node.addChild(n,20,"fish"+o),n.position=e,n.removeAllChildren(),[4,l.ResManager.loadResAsync(h.FishUrl[t-1],cc.SpriteAtlas)];case 1:return a=s.sent(),this.creatorAnimation(r,a,"move",h.FrameNum[t-1],h.FrameName[t-1]),[2]}})})},e.prototype.clearAddNode=function(){this.node&&this.node.removeAllChildren()},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([f(cc.Font)],e.prototype,"yel_bmfont",void 0),i([f(cc.Font)],e.prototype,"black_bmfont",void 0),e=i([d],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0,"../../by/protocol/BYDefine":"BYDefine","./BYPool":"BYPool"}],BYGameScene:[function(t,e,o){"use strict";cc._RF.push(e,"3a07bKpAQNPFqoc1dqlYtXR","BYGameScene");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BYGameView"),s=t("../../../manager/EventManager"),a=t("../../../net/NetCmd"),l=t("../protocol/BYCmd"),c=t("../../../Define"),h=t("../../../manager/NetManager"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GameView=null,e}return n(e,t),e.prototype.onLoad=function(){cc.sys.os!=cc.sys.OS_IOS&&(cc.dynamicAtlasManager.enabled=!0),this.GameView.GameScene=this,this.initData()},e.prototype.initData=function(){s.EventManager.on(this,a.ProtocolGameCmd.GameLoginResp,this.onGameLoginResp.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameReconnectInfo,this.onGameReconnectInfo.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameBulletCreateRes,this.onGameBulletCreateRes.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameBulletDisappearRes,this.onGameBulletDisappearRes.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameFishFreshNotify,this.onGameFishFreshNotify.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameFishDiedNotify,this.onGameFishDiedNotify.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameErrRes,this.onGameErrRes.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameOtherJoin,this.onGameOtherJoin.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameOtherLeave,this.onGameOtherLeave.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameBulletChangeRes,this.onGameBulletChangeRes.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.GameBulletAttackRes,this.onGameBulletAttackRes.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.NewGameFishFreshNotify,this.onNewGameFishFreshNotify.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.PlayerDisConnect,this.onPlayerDisConnect.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.SendStatus,this.onSendStatus.bind(this)),s.EventManager.on(this,l.ProtocolBYCmd.FreshGold,this.onFreshGold.bind(this)),s.EventManager.on(this,c.EventDef.UpdateUserGold,this.onUpdateUserScore.bind(this)),s.EventManager.on(this,c.EventDef.GameHide,this.onGameHide.bind(this)),s.EventManager.on(this,c.EventDef.GameShow,this.onGameShow.bind(this))},e.prototype.onGameHide=function(){this.GameView.StopAllCall()},e.prototype.onGameShow=function(){console.log("\u91cd\u8fde\u56de\u5230\u524d\u53f0====>")},e.prototype.onGameLoginResp=function(t){null!=t.room_info&&(h.NetManager.getGameProtocol().GAME_ROOM_LIMITE=t.room_info.room_base_note,console.log("\u6548\u9a8c\u6210\u529f====>",t))},e.prototype.onGameReconnectInfo=function(t){console.log("\u52a0\u5165\u623f\u95f4\u901a\u77e51111",t),this.GameView.onSubJoinRoom(t),this.GameView.initUserInfo()},e.prototype.onGameBulletCreateRes=function(t){console.log("\u5b50\u5f39\u521b\u5efa\u901a\u77e5",t),this.GameView.onGameBulletCreateRes(t)},e.prototype.onGameBulletDisappearRes=function(t){console.log("\u5b50\u5f39\u6d88\u5931\u901a\u77e5",t),this.GameView.onGameBulletDisappearRes(t)},e.prototype.onGameFishFreshNotify=function(t){console.log("\u5237\u65b0\u901a\u77e5",t),this.GameView.onGameFishFreshNotify(t)},e.prototype.onGameBulletAttackRes=function(t){console.log("\u5b50\u5f39\u51fb\u4e2d\u56de\u5e94",t),this.GameView.onGameBulletAttackRes(t)},e.prototype.onGameFishDiedNotify=function(t){console.log("\u6b7b\u4ea1\u901a\u77e5",t),this.GameView.onGameFishDiedNotify(t)},e.prototype.onGameErrRes=function(t){console.log("\u6e38\u620f\u81ea\u8eab\u5185\u90e8\u9519\u8bef",t)},e.prototype.onGameOtherJoin=function(t){console.log("\u5176\u4ed6\u73a9\u5bb6\u52a0\u5165\u623f\u95f4\u901a\u77e5",t),this.GameView.onGameOtherJoin(t)},e.prototype.onGameOtherLeave=function(t){console.log("\u5176\u4ed6\u73a9\u5bb6\u79bb\u5f00\u623f\u95f4\u901a\u77e5",t),this.GameView.onGameOtherLeave(t)},e.prototype.onGameBulletChangeRes=function(t){console.log("\u66f4\u6362\u5b50\u5f39\u7b49\u7ea7\u901a\u77e5",t),this.GameView.onGameBulletChangeRes(t)},e.prototype.onNewGameFishFreshNotify=function(t){var e=this;console.log("\u6279\u91cf\u5237\u65b0\u901a\u77e5",t),t.fishs.forEach(function(t,o){e.GameView.onGameFishFreshNotify(t)})},e.prototype.onPlayerDisConnect=function(t){console.log("\u73a9\u5bb6\u6389\u7ebf",t),this.GameView.onPlayerDisConnect(t)},e.prototype.onSendStatus=function(t){console.log("\u540c\u6b65\u73a9\u5bb6\u72b6\u6001",t),this.GameView.onSendStatus(t)},e.prototype.onUpdateUserScore=function(){this.GameView.onUpdateUserScore()},e.prototype.onFreshGold=function(t){console.log("\u5b9a\u65f6\u66f4\u65b0\u73a9\u5bb6\u91d1\u5e01",t),this.GameView.onUpdateUserScore(t)},e.prototype.onDestroy=function(){s.EventManager.off(this)},i([d(r.default)],e.prototype,"GameView",void 0),e=i([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../Define":void 0,"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../net/NetCmd":void 0,"../protocol/BYCmd":"BYCmd","./BYGameView":"BYGameView"}],BYGameView:[function(t,e,o){"use strict";cc._RF.push(e,"9f00cLihsxO+JHgJY1TpL56","BYGameView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/utils/Utils"),s=t("../../../manager/UIManager"),a=t("./BYPlayers"),l=t("../../../manager/NetManager"),c=t("./BYFishMgr"),h=t("./BYBulletMgr"),u=t("./BYRightPanel"),p=t("../../../manager/DataManager"),d=t("./BYSpecialTips"),f=t("./BYGoldAni"),_=t("../../../manager/AudioManager"),y=cc._decorator,g=y.ccclass,m=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BYPlayers=null,e.BYFishMgr=null,e.BYBulletMgr=null,e.BYRightPanel=null,e.BYSpecialTips=null,e.BYGoldAni=null,e.GameScene=null,e.winFrame=cc.v2(0,0),e.lock_shot=!1,e.auto_shot=!1,e.touch_monster=!1,e.lock_shotmonsterid=-1,e.collision_bullet=0,e.lockShotUpdate=null,e.room_bg1=null,e.room_bg2=null,e}return n(e,t),e.prototype.onLoad=function(){var t=r.default.getRandomInt(1,4);_.AudioManager.playGameBGM("by_bgm"+t),this.BYFishMgr.GameView=this,this.BYBulletMgr.GameView=this,this.BYPlayers.GameView=this,this.BYRightPanel.GameView=this;var e=cc.director.getWinSize();this.winFrame.x=e.width,this.winFrame.y=e.height},e.prototype.start=function(){this.room_bg1=this.node.getChildByName("movebg").getChildByName("room_bg"),this.room_bg2=this.node.getChildByName("movebg").getChildByName("room_bg1"),this.room_bg1.width=this.winFrame.x,this.room_bg2.width=this.winFrame.x,this.room_bg2.x=this.room_bg1.x+this.room_bg1.width},e.prototype.initUserInfo=function(){},e.prototype.getXMaxByBullet=function(t,e){var o=0,n=0,i=Math.PI/180,r=1;Math.abs(t.angle)>90?(n=this.winFrame.y/2+t.y,o=Math.tan((180-Math.abs(t.angle))*i)*n,r=-1):(n=this.winFrame.y/2-t.y,o=Math.tan(Math.abs(t.angle)*i)*n);var s=o/2e3+n/2e3,a=cc.moveBy(s,cc.v2(-o*e,n*r));0==n&&0==o||(t.stopAllActions(),t.runAction(cc.repeatForever(a)),t.angle=-t.angle)},e.prototype.getYMaxByBullet=function(t,e){var o=Math.PI/180,n=1,i=1,r=0,s=this.winFrame.y;t.angle>0?i=-1:n=-1;var a=(r=1==e?Math.tan(Math.abs(t.angle)*o)*s:Math.tan((180-Math.abs(t.angle))*o)*s)/2e3+s/2e3,l=cc.moveBy(a,cc.v2(r*i,-s*e));0==s&&0==r||(t.angle=180*n-t.angle,t.stopAllActions(),t.runAction(cc.repeatForever(l)))},e.prototype.getAngle=function(t,e){var o=e.x-t.x,n=e.y-t.y,i=cc.v2(o,n);return 0==o||0==n?0:-(i.signAngle(cc.v2(1,0))/Math.PI*180)-180},e.prototype.killFish=function(t,e){for(var o=this.BYFishMgr.getFishNode(),n=o.childrenCount-1;n>=0;n--){var i=o.children[n];if(0!=i.opacity&&t.killfishid==i.getComponent("BYFish").getFishTag()){if(i.getComponent("BYFish").getFishType()>=124&&i.getComponent("BYFish").getFishType()<=126?t.fish_times=15:122==i.getComponent("BYFish").getFishType()&&(t.fish_times=44),t.fish_times>=10&&t.fish_times<30)this.BYPlayers.updateGetTiips(t,!0,i.getComponent("BYFish").getFishType(),0),this.BYSpecialTips.playBigBoom(!1,i.position);else if(t.fish_times>=30&&t.fish_times<50)this.BYPlayers.updateGetTiips(t,!0,i.getComponent("BYFish").getFishType(),1),this.BYSpecialTips.shockEffect(),this.BYSpecialTips.playBigBoom(!1,i.position);else if(t.fish_times>=50)if(this.BYSpecialTips.shockEffect(),5==t.skill_info.id)if(e){this.BYSpecialTips.playBigBoom(!1,i.position);var r={tag:t.skill_info.mul,fishtype:i.getComponent("BYFish").getFishType(),gold:t.score,state:!0};this.BYSpecialTips.addTurntable(r)}else this.BYSpecialTips.playBigBoom(!0,i.position,i.getComponent("BYFish").getFishType(),t.score,!0);else this.BYSpecialTips.playBigBoom(!0,i.position,i.getComponent("BYFish").getFishType(),t.score,!0);this.lock_shotmonsterid==t.killfishid&&(i.getComponent("BYFish").setFishDi(!1),this.stopLockShot()),i.getComponent("BYFish").setFishLiveState(!1),14==i.getComponent("BYFish").getFishType()?_.AudioManager.playGameSFX("fish14"):18==i.getComponent("BYFish").getFishType()?_.AudioManager.playGameSFX("fish18"):20==i.getComponent("BYFish").getFishType()?_.AudioManager.playGameSFX("fish20"):129==i.getComponent("BYFish").getFishType()?_.AudioManager.playGameSFX("fish29"):130==i.getComponent("BYFish").getFishType()&&_.AudioManager.playGameSFX("fish30");var s=cc.v2(0,0),a=cc.v2(i.x,i.y);s=this.getPosBySeat(t.seat_id),l.NetManager.getGameProtocol().ROTATION_STATE&&(a=cc.v2(-i.x,-i.y)),this.BYSpecialTips.playMonsterActs(i,t.score,i.position),this.BYGoldAni.playAnim(a,s,!0),i.getComponent("BYFish").getFishType()>=124&&i.getComponent("BYFish").getFishType()<=126&&(t.fish_times=0),this.BYFishMgr.clearFish(i,.6)}}},e.prototype.getPosBySeat=function(t){var e=this.BYPlayers.getTrueSeatId(t),o=this.node.getChildByName("UINode").getChildByName("userinfo_node").getChildByName("info"+e);return cc.v2(o.x-89,o.y-18)},e.prototype.clearFish=function(){for(var t=this.BYFishMgr.getFishNode(),e=t.childrenCount,o=0;o<e;o++){var n=t.children[o];void 0!=n&&(n.x>this.winFrame.x/2+n.width/2||(n.x,this.winFrame.x,n.width))}},e.prototype.lockShotBack=function(t){var e=this;this.BYPlayers.first_lock=0,this.lock_shotmonsterid=t,null!=this.lockShotUpdate&&(this.unschedule(this.lockShotUpdate),this.lockShotUpdate=null),this.lockShotUpdate=function(){for(var t=null,o=e.BYFishMgr.getFishNode(),n=o.childrenCount,i=0;i<n;i++)0!=o.children[i].opacity&&(e.lock_shotmonsterid==o.children[i].getComponent("BYFish").getFishTag()?t=o.children[i]:o.children[i].getComponent("BYFish").setFishDi(!1));if(null!=t)if(e.lock_shot){var r=cc.v3(0,0,0);if((r=t.getPosition()).x>e.winFrame.x/2+t.width/4||r.x<-e.winFrame.x/2-t.width/4||r.y>e.winFrame.y/2+t.height/4||r.y<-e.winFrame.y/2-t.height/4)t.getComponent("BYFish").setFishDi(!1),e.stopLockShot();else{var s=l.NetManager.getGameProtocol().INSTER_DATA[t.getComponent("BYFish").getFishType()],a=null;if(l.NetManager.getGameProtocol().ROTATION_STATE)t.scaleY<0?(a=e.calculateRotate(cc.v2(0,0),cc.v2(s[0].x,-s[0].y),-t.angle),e.BYPlayers.lockShotBullet(cc.v3(t.x+a.x-t.width/15,t.y+a.y,0))):(a=e.calculateRotate(cc.v2(0,0),cc.v2(s[0].x,s[0].y),-t.angle),e.BYPlayers.lockShotBullet(cc.v3(t.x+a.x-t.width/25,t.y+a.y,0)));else{var c=1;t.scaleY<0&&(c=-1),a=e.calculateRotate(cc.v2(0,0),cc.v2(s[0].x,s[0].y*c),-t.angle),e.BYPlayers.lockShotBullet(cc.v3(t.x+a.x-t.width/25*c,t.y+a.y,0))}}}else e.stopLockShot()},this.lockShotUpdate(),this.touch_monster&&this.schedule(this.lockShotUpdate,.2,cc.macro.REPEAT_FOREVER)},e.prototype.setFishClick=function(){for(var t=this.BYFishMgr.getFishNode(),e=t.childrenCount,o=0;o<e;o++){var n=t.children[o];void 0!=n&&(n.getComponent("BYFish").setFishTouchState(this.lock_shot),this.lock_shot||n.getComponent("BYFish").setFishDi(!1))}},e.prototype.cancelLockIcon=function(){for(var t=this.BYFishMgr.getFishNode(),e=t.childrenCount,o=0;o<e;o++)t.children[o].getComponent("BYFish").setFishDi(!1)},e.prototype.stopLockShot=function(t){void 0===t&&(t=!0),this.touch_monster=!1,this.lock_shotmonsterid=-1,this.lock_shot&&(t&&this.BYPlayers.cancelSkill(!0),null!=this.lockShotUpdate&&(this.unschedule(this.lockShotUpdate),this.lockShotUpdate=null))},e.prototype.cancelShotClick=function(t){this.BYRightPanel.lockClick(t),this.BYRightPanel.autoClick(t)},e.prototype.clearBullet=function(t){for(var e=this.BYBulletMgr.getBulletNode(),o=e.childrenCount-1;o>=0;o--){var n=e.children[o];if(void 0!=n&&n.getComponent("BYBullet").getBullstTag()==t)return void this.BYBulletMgr.clearBullet(n)}},e.prototype.update=function(t){var e=this.BYBulletMgr.getBulletNode(),o=this.BYFishMgr.getFishNode();this.bulletBounce(e),this.fishChangeAngle(o),this.lockFishLine(o),this.CollisionFish(e,o),this.lockBulletState(e,o)},e.prototype.lockBulletState=function(t,e){for(var o=t.childrenCount-1;o>=0;o--){var n=t.children[o];if(0!=n.opacity)if(n.getComponent("BYBullet").getBulletLockState()){for(var i=0,r=n.getComponent("BYBullet").getBulletLockFishID(),s=e.childrenCount-1;s>=0;s--){if(e.children[s].getComponent("BYFish").getFishTag()==r&&255==e.children[s].opacity)return;i+=1}i==e.childrenCount&&n.getComponent("BYBullet").setBulletLockState(!1)}}},e.prototype.lockFishLine=function(t){if(this.touch_monster)for(var e=0;e<t.childrenCount;e++){var o=t.children[e].getComponent("BYFish").getFishTag(),n=t.children[e].getComponent("BYFish").getFishLiveState();if(this.lock_shotmonsterid==o){if(!n)return void this.BYPlayers.updateLine(!1,null);var i=t.children[e];if(i.x>(this.winFrame.x+i.width)/2||i.x<-(this.winFrame.x+i.width)/2||i.y>(this.winFrame.y+i.height)/2||i.y<-(this.winFrame.y+i.height)/2)return void this.BYPlayers.updateLine(!1,null);var r=l.NetManager.getGameProtocol().INSTER_DATA[t.children[e].getComponent("BYFish").getFishType()],s=null;s=t.children[e].scaleY<0?this.calculateRotate(cc.v2(0,0),cc.v2(r[0].x,-r[0].y),-t.children[e].angle):this.calculateRotate(cc.v2(0,0),cc.v2(r[0].x,r[0].y),-t.children[e].angle),this.BYPlayers.updateLine(!0,cc.v2(t.children[e].x+s.x,t.children[e].y+s.y))}}else this.BYPlayers.updateLine(!1,null)},e.prototype.CollisionFish=function(t,e){var o=10;if(this.collision_bullet=this.collision_bullet+o,t.childrenCount<1)this.collision_bullet=0;else{t.childrenCount<5&&(this.collision_bullet=t.childrenCount,o=t.childrenCount),this.collision_bullet>t.childrenCount&&(this.collision_bullet==t.childrenCount+o?this.collision_bullet=o:this.collision_bullet=t.childrenCount);for(var n=this.collision_bullet-1;n>=this.collision_bullet-o;n--)if(cc.isValid(t.children[n])&&0!=t.children[n].opacity)for(var i={position:cc.v2(t.children[n].x,t.children[n].y),radius:30},r=0;r<e.childrenCount;r++)if(cc.isValid(e.children[r])&&0!=e.children[r].opacity){var s=e.children[r].getComponent("BYFish").getFishLiveState(),a=e.children[r].getComponent("BYFish").getFishTag(),c=t.children[n].getComponent("BYBullet").getBullstTag();if(void 0==l.NetManager.getGameProtocol())return;if(!(e.children[r].x>t.children[n].x+150||e.children[r].x<t.children[n].x-150||e.children[r].y>t.children[n].y+150||e.children[r].y<t.children[n].y-150)){var h=l.NetManager.getGameProtocol().INSTER_DATA[e.children[r].getComponent("BYFish").getFishType()];if(void 0==h)return;for(var u=e.children[r].getComponent("BYFish").getFishSize(),p=0;p<h.length;p++){1;var d=null;d=e.children[r].scaleY<0?this.calculateRotate(cc.v2(0,0),cc.v2(h[p].x,-h[p].y),-e.children[r].angle):this.calculateRotate(cc.v2(0,0),cc.v2(h[p].x,h[p].y),-e.children[r].angle);var f={position:cc.v2(e.children[r].x+d.x,e.children[r].y+d.y),radius:h[p].r*u},_=t.children[n].getComponent("BYBullet").getBulletByPlayer(),y=t.children[n].getComponent("BYBullet").getBulletLockState();if(_&&(this.touch_monster||(y=!1,t.children[n].getComponent("BYBullet").setBulletLockState(!1))),y){if(a==t.children[n].getComponent("BYBullet").getBulletLockFishID()&&cc.Intersection.circleCircle(f,i)&&s)return e.children[r].getComponent("BYFish").playBoom(e.children[r].x,1),e.children[r].getComponent("BYFish").setFishColor(),_?(l.NetManager.getGameProtocol().sendBulletAttackReq(c+"",a),l.NetManager.getGameProtocol().MY_bullet_send=l.NetManager.getGameProtocol().MY_bullet_send+1,console.log("\u5f53\u524d\u78b0\u649e\u5b50\u5f39\u7684\u6570\u91cf",l.NetManager.getGameProtocol().MY_bullet_send)):this.BYBulletMgr.setOhterBulletCollior(t.children[n].getComponent("BYBullet").getBulletBySeat()),void this.BYBulletMgr.clearBullet(t.children[n])}else if(cc.Intersection.circleCircle(f,i)&&s)return e.children[r].getComponent("BYFish").playBoom(e.children[r].x,1),e.children[r].getComponent("BYFish").setFishColor(),_?(l.NetManager.getGameProtocol().sendBulletAttackReq(c+"",a),l.NetManager.getGameProtocol().MY_bullet_send=l.NetManager.getGameProtocol().MY_bullet_send+1,console.log("\u5f53\u524d\u78b0\u649e\u5b50\u5f39\u7684\u6570\u91cf",l.NetManager.getGameProtocol().MY_bullet_send)):this.BYBulletMgr.setOhterBulletCollior(t.children[n].getComponent("BYBullet").getBulletBySeat()),void this.BYBulletMgr.clearBullet(t.children[n])}}}}},e.prototype.calculateRotate=function(t,e,o){var n=(e.x-t.x)*Math.cos(o*Math.PI/180)+(e.y-t.y)*Math.sin(o*Math.PI/180),i=-(e.x-t.x)*Math.sin(o*Math.PI/180)+(e.y-t.y)*Math.cos(o*Math.PI/180);return{x:Math.round(100*n)/100,y:Math.round(100*i)/100}},e.prototype.bulletBounce=function(t){for(var e=0;e<t.childrenCount;e++)if(0!=t.children[e].opacity){t.children[e].getComponent("BYBullet");t.children[e].x>this.winFrame.x/2&&(t.children[e].x=t.children[e].x-40,this.getXMaxByBullet(t.children[e],1)),t.children[e].x<-this.winFrame.x/2&&(t.children[e].x=t.children[e].x+40,this.getXMaxByBullet(t.children[e],-1)),t.children[e].y>this.winFrame.y/2&&(t.children[e].y=t.children[e].y-40,this.getYMaxByBullet(t.children[e],1)),t.children[e].y<-this.winFrame.y/2&&(t.children[e].y=t.children[e].y+40,this.getYMaxByBullet(t.children[e],-1))}},e.prototype.fishChangeAngle=function(t){for(var e=0;e<t.childrenCount;e++){var o=t.children[e].getComponent("BYFish").getFishLiveState(),n=t.children[e].getComponent("BYFish").getFishRotateState();if(0!=t.children[e].opacity&&(o&&!n)){var i=0,r=cc.v2(0,0);if(void 0==(r=t.children[e].getComponent("BYFish").getBekPos())?r=cc.v2(0,0):i=this.getAngle(cc.v2(r.x,r.y),cc.v2(t.children[e].x,t.children[e].y)),0==i){if(void 0==l.NetManager.getGameProtocol())return;t.children[e].scaleY<0?l.NetManager.getGameProtocol().ROTATION_STATE?t.children[e].angle=0:t.children[e].angle=-180:l.NetManager.getGameProtocol().ROTATION_STATE?t.children[e].angle=-180:t.children[e].angle=0}else t.children[e].angle=i;t.children[e].getComponent("BYFish").setBekPos(cc.v2(t.children[e].x,t.children[e].y))}}},e.prototype.moveBg=function(t){this.room_bg1.x-=10*t,this.room_bg2.x-=10*t,this.room_bg1.x<=-this.winFrame.x&&(this.room_bg1.x=this.room_bg2.x+this.room_bg2.width),this.room_bg2.x<=-this.winFrame.x&&(this.room_bg2.x=this.room_bg1.x+this.room_bg1.width)},e.prototype.stopMonsterMove=function(){for(var t=this.BYFishMgr.getFishNode(),e=t.childrenCount,o=0;o<e;o++){var n=t.children[o];0!=n.opacity&&n.pauseAllActions()}},e.prototype.resumeMonsterMove=function(){for(var t=this.BYFishMgr.getFishNode(),e=t.childrenCount,o=0;o<e;o++){var n=t.children[o];0!=n.opacity&&n.resumeAllActions()}},e.prototype.getPosByFishID=function(t){cc.v2(0,0);for(var e=this.BYFishMgr.getFishNode(),o=e.childrenCount-1;o>=0;o--){var n=e.children[o];if(n.getComponent("BYFish").getFishTag()==t)return n.position}},e.prototype.onSubJoinRoom=function(t){var e=this;this.BYBulletMgr.clearAllBullet(),this.BYPlayers.setUIRotation(0),this.BYFishMgr.setInit(),this.cancelShotClick(!1),this.BYPlayers.removeAllPlayer(),this.BYFishMgr.clearAllFish(),t.monster_times.sort(function(t,e){return t.times-e.times}),l.NetManager.getGameProtocol().FISH_TIMES=t.monster_times,l.NetManager.getGameProtocol().BULLET_LEVEL_LIST=t.bullet_level,l.NetManager.getGameProtocol().MY_SEATID=t.player_info.seat_id,console.log("\u5f53\u524d\u73a9\u5bb6\u7684\u5ea7\u4f4dID",l.NetManager.getGameProtocol().MY_SEATID,t.player_info.seat_id),this.BYPlayers.initSelfPlayer(t.player_info),t.other_player_info.forEach(function(t,o){e.BYPlayers.addPlayer(t)});for(var o=0;o<t.fishs.length;o++)if(2==t.fishs[o].special)return!1,void this.onGameFishFreshNotify(t.fishs[o],!1);t.fishs.forEach(function(t,o){e.onGameFishFreshNotify(t,!0)})},e.prototype.onGameBulletCreateRes=function(t){0==t.res?(_.AudioManager.playGameSFX("bullet"),t.seat_id==l.NetManager.getGameProtocol().MY_SEATID?p.DataManager.userInfo.gold=t.gold:(0!=t.fish_id&&(t.point=this.getPosByFishID(t.fish_id)),this.BYPlayers.otherCreateBullet(t))):2==t.res&&(s.UIManager.showTips("\u91d1\u5e01\u4e0d\u8db3"),t.seat_id==l.NetManager.getGameProtocol().MY_SEATID&&(this.cancelShotClick(!1),this.BYPlayers.stopShotBullet(),p.DataManager.userInfo.gold=t.gold)),this.BYPlayers.updateUserInfo(t.seat_id,t.gold)},e.prototype.onPlayerDisConnect=function(t){var e=this.BYPlayers.getSeatIdByPlayerID(t.player_id);t.lock_shot=3,t.seat_id=this.BYPlayers.getTrueSeatId(e),this.BYPlayers.otherCreateBullet(t),this.BYBulletMgr.setOhterBulletCollior(t.seat_id,0),this.BYPlayers.otherStopShotBullet(t.seat_id)},e.prototype.onSendStatus=function(t){console.log("\u72b6\u6001\u540c\u6b65\u5f00\u59cb");for(var e=0;e<t.status.length;e++){var o=this.BYPlayers.getSeatIdByPlayerID(t.status[e].player_id);t.status[e].bullets.seat_id=this.BYPlayers.getTrueSeatId(o),t.status[e].bullets.seat_id!=l.NetManager.getGameProtocol().MY_SEATID&&(t.status[e].bullets.lock_shot=t.status[e].status,this.BYPlayers.otherCreateBullet(t.status[e].bullets))}console.log("\u72b6\u6001\u540c\u6b65\u5b8c\u6210")},e.prototype.onGameBulletDisappearRes=function(t){0==t.res&&(p.DataManager.userInfo.gold=t.gold,this.BYPlayers.updateUserInfo(t.seat_id,t.gold))},e.prototype.onGameFishDiedNotify=function(t){var e=this,o=!1;if(t.player_id==p.DataManager.userInfo.userid?(_.AudioManager.playGameSFX("get_gold1"),p.DataManager.userInfo.gold=t.gold,o=!0):(_.AudioManager.playGameSFX("get_gold2"),o=!1),this.BYPlayers.updateUserInfo(t.seat_id,t.gold),1==t.skill_info.id)_.AudioManager.playGameSFX("boom"),this.BYSpecialTips.initTipsSkin(1);else if(2==t.skill_info.id)_.AudioManager.playGameSFX("by_frozen"),this.BYSpecialTips.initTipsSkin(2),this.stopMonsterMove(),this.scheduleOnce(function(){e.resumeMonsterMove()},t.skill_info.time_out);else if(3==t.skill_info.id);else{if(4==t.skill_info.id)return void this.upGradeFish(t.skill_info.id,t.fish_id[0]);if(8==t.skill_info.id)return void this.upGradeFish(t.skill_info.id,t.fish_id[0],t.score,o)}t.fish_id.forEach(function(n,i){t.killfishid=n,e.killFish(t,o)})},e.prototype.onGameFishFreshNotify=function(t,e){var o=this;void 0===e&&(e=!1),2==t.special?(_.AudioManager.playGameSFX("fish_shoul"),this.BYSpecialTips.initTipsSkin(3),this.BYFishMgr.addRunAllFish(),this.stopLockShot(),this.node.runAction(cc.sequence(cc.delayTime(.51),cc.callFunc(function(){o.BYFishMgr.clearAllFish()}),cc.delayTime(.5),cc.callFunc(function(){o.BYFishMgr.initShoulRouteData(t)})))):t.fish_info.length>1?t.fish_info.forEach(function(e,n){e.fish_type>100&&o.BYFishMgr.addFish(e,t,!0)}):t.fish_info.forEach(function(e,n){o.BYFishMgr.addFish(e,t)})},e.prototype.onGameBulletAttackRes=function(t){t.player_id==p.DataManager.userInfo.userid||(this.clearBullet(t.bullet_id),this.upGradeFish(9999,t.fish_id))},e.prototype.onGameOtherJoin=function(t){this.BYPlayers.addPlayer(t.player_info)},e.prototype.onGameOtherLeave=function(t){this.BYPlayers.removePlayer(t.player_info.seat_id)},e.prototype.onGameBulletChangeRes=function(t){t.player_id==p.DataManager.userInfo.userid||this.BYPlayers.changeCannonLevel(t)},e.prototype.onUpdateUserScore=function(t){if(void 0===t&&(t=null),null==t)this.BYPlayers.updateUserInfo(l.NetManager.getGameProtocol().MY_SEATID,p.DataManager.userInfo.gold);else for(var e=0;e<t.gold_info.length;e++)t.gold_info[e].seat_id==l.NetManager.getGameProtocol().MY_SEATID&&(p.DataManager.userInfo.gold=t.gold_info[e].gold),this.BYPlayers.updateUserInfo(t.gold_info[e].seat_id,t.gold_info[e].gold)},e.prototype.onDestroy=function(){this.unschedule(this.lockShotUpdate),this.lockShotUpdate=null},e.prototype.StopAllCall=function(){this.unscheduleAllCallbacks(),this.BYPlayers.onDestroy(),this.auto_shot=!1,this.lock_shot=!1,this.touch_monster=!1,this.unschedule(this.lockShotUpdate),this.lockShotUpdate=null,this.setFishClick(),this.BYBulletMgr.clearAllBullet()},e.prototype.upGradeFish=function(t,e,o,n){void 0===o&&(o=0),void 0===n&&(n=!1);for(var i=this.BYFishMgr.getFishNode(),r=i.childrenCount-1;r>=0;r--){var s=i.children[r];0!=s.opacity&&(e==s.getComponent("BYFish").getFishTag()&&(4==t?s.getComponent("BYFish").updateFishAction("11_000"):8==t?(this.BYSpecialTips.flutterScore(o,cc.v2(0,100),s.position),this.BYSpecialTips.playBigBoom(!1,s.position)):9999==t&&s.getComponent("BYFish").playBoom(0,1)))}},i([m(a.default)],e.prototype,"BYPlayers",void 0),i([m(c.default)],e.prototype,"BYFishMgr",void 0),i([m(h.default)],e.prototype,"BYBulletMgr",void 0),i([m(u.default)],e.prototype,"BYRightPanel",void 0),i([m(d.default)],e.prototype,"BYSpecialTips",void 0),i([m(f.default)],e.prototype,"BYGoldAni",void 0),e=i([g],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/AudioManager":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"./BYBulletMgr":"BYBulletMgr","./BYFishMgr":"BYFishMgr","./BYGoldAni":"BYGoldAni","./BYPlayers":"BYPlayers","./BYRightPanel":"BYRightPanel","./BYSpecialTips":"BYSpecialTips"}],BYGoldAni:[function(t,e,o){"use strict";cc._RF.push(e,"e805atY/WFN9ZgHVYZRt3q9","BYGoldAni");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BYPool"),s=cc._decorator,a=s.ccclass,l=s.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goldPrefab=null,e.coinPool=null,e}return n(e,t),e.prototype.onLoad=function(){this.coinPool=new cc.NodePool},e.prototype.createCoin=function(){var t=null;return void 0!=(t=r.BYPool.getGold())&&cc.isValid(t)?(console.log("\u8001\u83b7\u5f97\u91d1\u5e01"),t.opacity=255,t):(console.log("\u65b0\u83b7\u5f97\u91d1\u5e01"),t=cc.instantiate(this.goldPrefab),this.node.addChild(t),t)},e.prototype.clearCoin=function(t){(t=t||this.node.children[0]).stopAllActions(),r.BYPool.putGold(t)},e.prototype.playAnim=function(t,e,o){console.log("playAnim\u64ad\u653e\u83b7\u5f97\u91d1\u5e01\u63d0\u793a\u5f00\u59cb");var n=3*Math.random()+2;this.playCoinFlyAnim(n,t,e,o),console.log("playAnim\u64ad\u653e\u83b7\u5f97\u91d1\u5e01\u63d0\u793a\u7ed3\u675f")},e.prototype.playCoinFlyAnim=function(t,e,o,n,i){var r=this;void 0===i&&(i=130);var s=this.getCirclePoints(i,e,t).map(function(t){var n=r.createCoin(),i=n.getComponent(sp.Skeleton);return i.clearTracks(),i.setToSetupPose(),i.animation="rotation",i.node.active=!0,n.setPosition(e),{node:n,stPos:e,mdPos:t,edPos:o,dis:t.sub(o).mag()}});(s=s.sort(function(t,e){return t.dis-e.dis>0?1:t.dis-e.dis<0?-1:0})).forEach(function(t,e){t.node.runAction(cc.sequence(cc.moveTo(.3,t.mdPos),cc.delayTime(.05*e),cc.moveTo(.5,t.edPos),cc.callFunc(function(){r.clearCoin(t.node)})))})},e.prototype.getCirclePoints=function(t,e,o,n){void 0===n&&(n=60);for(var i=[],r=Math.PI/180*Math.round(360/o),s=0;s<o;s++){var a=e.x+t*Math.sin(r*s),l=e.y+t*Math.cos(r*s);i.unshift(cc.v3(a+Math.random()*n,l+Math.random()*n,0))}return i},i([l(cc.Prefab)],e.prototype,"goldPrefab",void 0),e=i([a],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./BYPool":"BYPool"}],BYKillBossTips:[function(t,e,o){"use strict";cc._RF.push(e,"48f7cKZxAZC8aYdL5inf7LJ","BYKillBossTips");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../manager/ResManager"),l=cc._decorator,c=l.ccclass,h=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipsSp=null,e.yel_bmfont=null,e.black_bmfont=null,e.gold_num=null,e.fish_img=null,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.initTipsSkin=function(t,e,o){return r(this,void 0,void 0,function(){var n,i,r=this;return s(this,function(s){switch(s.label){case 0:return this.node.active=!0,[4,a.ResManager.loadResAsync("game/by/res/fish"+t,cc.SpriteFrame)];case 1:return n=s.sent(),this.fish_img.spriteFrame=n,this.fish_img.node.active=!0,this.tipsSp.node.active=!0,this.tipsSp.clearTracks(),this.tipsSp.setToSetupPose(),this.tipsSp.animation="animation",i=this.tipsSp,i.setAnimation(0,"animation",!1)&&i.setCompleteListener(function(t,e){r.node.active=!1}),this.gold_num.node.active=!0,this.gold_num.font=o?this.yel_bmfont:this.black_bmfont,this.gold_num.string="+"+e,[2]}})})},e.prototype.PrefixInteger=function(t,e){return(Array(e).join("0")+t).slice(-e)},e.prototype.setState=function(t){this.node.active=t},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([h(sp.Skeleton)],e.prototype,"tipsSp",void 0),i([h(cc.Font)],e.prototype,"yel_bmfont",void 0),i([h(cc.Font)],e.prototype,"black_bmfont",void 0),i([h(cc.Label)],e.prototype,"gold_num",void 0),i([h(cc.Sprite)],e.prototype,"fish_img",void 0),e=i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../manager/ResManager":void 0}],BYLeftPanel:[function(t,e,o){"use strict";cc._RF.push(e,"543d5vA2bpGyIUUt7vyBWgR","BYLeftPanel");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/utils/Utils"),s=t("../../../manager/NetManager"),a=t("../../../manager/UIManager"),l=t("../../../manager/DataManager"),c=t("../../../Define"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn_cancel=null,e.btn_menu=null,e.menuPanel=null,e.menubg=null,e.btn_back=null,e.btn_rule=null,e.btn_set=null,e.pop_MenuState=!1,e}return n(e,t),e.prototype.onLoad=function(){this.addEvenListener()},e.prototype.addEvenListener=function(){r.default.addClickEventEND(this.btn_cancel,this.onEvenClickButton.bind(this)),r.default.addClickEventEND(this.btn_menu,this.onEvenClickButton.bind(this)),r.default.addClickEventEND(this.btn_back,this.onEvenClickButton.bind(this)),r.default.addClickEventEND(this.btn_rule,this.onEvenClickButton.bind(this)),r.default.addClickEventEND(this.btn_set,this.onEvenClickButton.bind(this))},e.prototype.onEvenClickButton=function(t){var e=t.name;"btn_back"==e?(console.log("quit game"),s.NetManager.protocolGameCommon.sendLeaveGame(),Number(s.NetManager.getGameProtocol().GAME_ROOM_LIMITE)>l.DataManager.userInfo.gold&&this.scheduleOnce(function(){s.NetManager.close(c.SocketType.Game),a.UIManager.open("game/by/BYRoomView",l.DataManager.gameType)},.2)):"btn_menu"==e?(this.pop_MenuState=!this.pop_MenuState,this.btn_cancel.active=this.pop_MenuState,this.popMenu(this.pop_MenuState)):"btn_rule"==e?a.UIManager.popup("game/by/prefab/BYRuleView",s.NetManager.getGameProtocol().FISH_TIMES):"btn_set"==e?a.UIManager.popup("game/by/prefab/BYSetting"):"btn_cancel"==e&&(this.pop_MenuState=!1,this.popMenu(!1),this.btn_cancel.active=!1)},e.prototype.popMenu=function(t){t?(this.btn_menu.angle=0,this.menuPanel.runAction(cc.moveBy(.2,cc.v2(0,-350))),this.menubg.runAction(cc.moveBy(.2,cc.v2(0,-350)))):(this.btn_menu.angle=180,this.menuPanel.runAction(cc.moveBy(.2,cc.v2(0,350))),this.menubg.runAction(cc.moveBy(.2,cc.v2(0,350))))},i([p(cc.Node)],e.prototype,"btn_cancel",void 0),i([p(cc.Node)],e.prototype,"btn_menu",void 0),i([p(cc.Node)],e.prototype,"menuPanel",void 0),i([p(cc.Node)],e.prototype,"menubg",void 0),i([p(cc.Node)],e.prototype,"btn_back",void 0),i([p(cc.Node)],e.prototype,"btn_rule",void 0),i([p(cc.Node)],e.prototype,"btn_set",void 0),e=i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../Define":void 0,"../../../common/utils/Utils":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0}],BYPlayers:[function(t,e,o){"use strict";cc._RF.push(e,"46c0e3cdcVLEYdFg1GWz4IX","BYPlayers");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/utils/Utils"),s=t("../../../manager/UIManager"),a=t("../../../manager/NetManager"),l=t("../../../manager/DataManager"),c=t("./BYBulletMgr"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.node_UI=null,e.touch_layer=null,e.player_nodelist=[],e.userinfo_nodelist=[],e.battery_item=null,e.usernode_item=null,e.BYBulletMgr=null,e.dot_item=null,e.get_item=null,e.GameView=null,e.touch_pos=cc.v2(0,0),e.touch_angle="",e.my_Seatid=0,e.userseat_byplayer=[],e.userbattery_js=[],e.useget_js=[],e.can_bullet=!0,e.dotlock=null,e.interVal=null,e.otherInterVal=[],e.interValAuto=null,e.first_lock=0,e.first_auto=0,e}return n(e,t),e.prototype.start=function(){this.BYBulletMgr.Player=this,this.initTouch()},e.prototype.initSelfPlayer=function(t){var e=this;this.my_Seatid=t.seat_id-1,this.setTipsAngle(0),this.my_Seatid>1&&(a.NetManager.getGameProtocol().ROTATION_STATE=!0,this.setUIRotation(180),console.log("TTTTTTT",a.NetManager.getGameProtocol().MY_SEATID,a.NetManager.getGameProtocol().ROTATION_STATE),this.setTipsAngle(180)),this.addPlayer(t),this.interValAuto=function(){e.can_bullet=!0},this.schedule(this.interValAuto,.2,cc.macro.REPEAT_FOREVER)},e.prototype.setUIRotation=function(t){this.node_UI.rotation=t},e.prototype.setTipsAngle=function(t){for(var e=1;e<=4;e++)this.node.getChildByName("wait"+e).angle=t},e.prototype.initTouch=function(){this.touch_layer.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touch_layer.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touch_layer.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){if(!this.GameView.lock_shot){var e=t.getLocation(),o=this.touch_layer.convertToNodeSpaceAR(e),n=this.commonGetAngle(cc.v2(o.x,o.y),25);this.changeCannonRotation(n,this.my_Seatid+1),this.createBullet(),this.autoShotBullet()}},e.prototype.onTouchMove=function(t){if(!this.GameView.lock_shot){var e=t.getLocation(),o=this.touch_layer.convertToNodeSpaceAR(e);(e.x>this.GameView.winFrame.x||e.x<0||e.y>this.GameView.winFrame.y||e.y<0)&&this.stopShotBullet();var n=this.commonGetAngle(cc.v2(o.x,o.y),25);this.changeCannonRotation(n,this.my_Seatid+1),this.first_auto=0}},e.prototype.onTouchEnd=function(t){void 0!=a.NetManager.getGameProtocol()?(this.GameView.auto_shot||this.GameView.lock_shot||this.stopShotBullet(),a.NetManager.getGameProtocol().MY_bullet-a.NetManager.getGameProtocol().MY_bullet_send>10&&s.UIManager.showTips("\u5b50\u5f39\u8d85\u8fc7\u9650\u5236\u6570\u91cf\uff0c\u7a0d\u540e\u518d\u8bd5"),this.first_auto=0):this.stopShotBullet()},e.prototype.autoShotBullet=function(){var t=this;this.stopShotBullet(),this.interVal=function(){t.createBullet()},this.schedule(this.interVal,.2,cc.macro.REPEAT_FOREVER)},e.prototype.stopShotBullet=function(){this.unschedule(this.interVal),this.interVal=null},e.prototype.cancelSkill=function(t){void 0===t&&(t=!1),t&&this.createBullet(t)},e.prototype.getDistance=function(t,e){var o=cc.v2(t.x-e.x,t.y-e.y);return Math.sqrt(o.x*o.x+o.y*o.y)},e.prototype.lockShotBullet=function(t){var e=this.commonGetAngle(cc.v2(t.x,t.y),25);this.changeCannonRotation(e,this.my_Seatid+1),this.createBullet()},e.prototype.updateLine=function(t,e){if(null!=this.dotlock)if(t){var o=this.getDistance(cc.v2(this.player_nodelist[this.my_Seatid].x,this.player_nodelist[this.my_Seatid].y),cc.v2(e.x,e.y));this.dotlock.getChildByName("mask").height=o-70;var n=this.commonGetAngle(e,33);this.dotlock.active=!0,this.dotlock.angle=n}else this.dotlock.active=!1},e.prototype.commonGetAngle=function(t,e){var o=0,n=1;a.NetManager.getGameProtocol().ROTATION_STATE&&(o=1,n=-1);var i=t.y-this.player_nodelist[this.my_Seatid].y+e*n,r=t.x-this.player_nodelist[this.my_Seatid].x,s=57.29577951*Math.atan2(r,i);return this.touch_pos=cc.v2(t.x,t.y),this.touch_angle=-s+"",180*o-s},e.prototype.createBullet=function(t){if(void 0===t&&(t=!1),void 0!=a.NetManager.getGameProtocol()&&null!=l.DataManager.userInfo&&(this.can_bullet||t)){if(a.NetManager.getGameProtocol().MY_bullet-a.NetManager.getGameProtocol().MY_bullet_send>10)return;Number(a.NetManager.getGameProtocol().BULLET_LEVEL_LIST[a.NetManager.getGameProtocol().BULLET_CUR_LEVEL])>l.DataManager.userInfo.gold&&(s.UIManager.showTips("\u91d1\u5e01\u4e0d\u8db3"),this.GameView.cancelLockIcon(),this.GameView.stopLockShot(!1),this.GameView.cancelShotClick(!1),t=!0),this.can_bullet=!1;var e=l.DataManager.userInfo.userid+""+a.NetManager.getGameProtocol().MY_bullet,o={bullet_id:e,point:this.touch_pos,angle:this.touch_angle,speed:100,bullet_level:a.NetManager.getGameProtocol().BULLET_CUR_LEVEL},n=0,i=1,r=1;t?(this.first_lock=0,this.first_auto=0,r=1,i=3):(this.BYBulletMgr.addBullet(a.NetManager.getGameProtocol().BULLET_CUR_LEVEL,Number(e),this.touch_angle,this.touch_pos),this.userbattery_js[this.my_Seatid].showLight(),this.GameView.auto_shot&&(i=2,this.first_auto=this.first_auto+1),this.GameView.lock_shot&&(i=0,n=this.GameView.lock_shotmonsterid,this.first_lock=this.first_lock+1),(this.GameView.lock_shot||this.GameView.auto_shot)&&(0==n?1!=this.first_auto&&(r=0):1!=this.first_lock&&(r=0))),a.NetManager.getGameProtocol().sendCreateBulletReq(o,i,n,r)}},e.prototype.serverCreateBullet=function(t){},e.prototype.otherAutoShotBullet=function(t){var e=this;this.otherStopShotBullet(t.seat_id),this.otherInterVal[t.seat_id]=function(){t.bullet_id=Number(t.bullet_id)+1+"",0!=t.fish_id&&(t.point=e.GameView.getPosByFishID(t.fish_id)),e.otherCreateBullet(t)},this.schedule(this.otherInterVal[t.seat_id],.2,cc.macro.REPEAT_FOREVER)},e.prototype.otherStopShotBullet=function(t){this.unschedule(this.otherInterVal[t]),this.otherInterVal[t]=null},e.prototype.otherCreateBullet=function(t){if(cc.log("\u6d4b\u8bd5\u540c\u6b65\u95ee\u9898other",t),void 0!=a.NetManager.getGameProtocol()){if(0==t.lock_shot)t.lock_shot=1,this.otherAutoShotBullet(t);else if(2==t.lock_shot)t.lock_shot=1,this.otherAutoShotBullet(t);else if(3==t.lock_shot)return void this.otherStopShotBullet(t.seat_id);var e=this.otherGetAngle(cc.v2(t.point.x,t.point.y),25,t.seat_id-1);a.NetManager.getGameProtocol().ROTATION_STATE&&(e-=180),cc.log("\u83b7\u53d6\u7684\u5b50\u5f39\u6570\u91cf"+t.seat_id,this.BYBulletMgr.getOhterBulletCollior(t.seat_id),this.userbattery_js),this.BYBulletMgr.getOhterBulletCollior(t.seat_id)<10&&(this.BYBulletMgr.addOtherBullet(t.seat_id,t.bullet_level,Number(t.bullet_id),e,cc.v2(t.point.x,t.point.y),0!=t.fish_id,t.fish_id),void 0!=this.userbattery_js[t.seat_id-1]&&this.userbattery_js[t.seat_id-1].showLight()),this.changeCannonRotation(e,t.seat_id),t.seat_id<3?this.changeCannonRotation(e,t.seat_id):this.changeCannonRotation(e-180,t.seat_id)}},e.prototype.otherGetAngle=function(t,e,o){var n=0,i=-1;a.NetManager.getGameProtocol().ROTATION_STATE&&(n=1,i=1);var r=t.y-this.player_nodelist[o].y+e*i,s=t.x-this.player_nodelist[o].x;return 180*n-57.29577951*Math.atan2(s,r)},e.prototype.addPlayer=function(t){this.node.getChildByName("wait"+t.seat_id).active=!1;var e=cc.instantiate(this.battery_item);this.userbattery_js[t.seat_id-1]=e.getComponent("BYBattery"),this.userbattery_js[t.seat_id-1].initData(t.seat_id-1==this.my_Seatid,t),this.player_nodelist[t.seat_id-1].addChild(e),t.seat_id-1==this.my_Seatid&&(this.touch_pos=cc.v2(this.player_nodelist[t.seat_id-1].x,this.player_nodelist[t.seat_id-1].y+500));var o=this.getTrueSeatId(t.seat_id);(this.addPlayerInfo(t,o),t.seat_id-1==this.my_Seatid)&&(this.dotlock=cc.instantiate(this.dot_item),e.getChildByName("linenode").addChild(this.dotlock),this.dotlock.x=10,this.dotlock.active=!1);this.addGetTips(t.seat_id)},e.prototype.addGetTips=function(t){var e=cc.instantiate(this.get_item);e.y=165,a.NetManager.getGameProtocol().ROTATION_STATE?t<=2&&(e.angle=180):t>2&&(e.angle=180),this.useget_js[t-1]=e.getComponent("BYSpecialGet"),this.useget_js[t-1].setState(!1),this.player_nodelist[t-1].addChild(e)},e.prototype.updateGetTiips=function(t,e,o,n){this.useget_js[t.seat_id-1].initTipsSkin(n,o,t.score,e)},e.prototype.getTrueSeatId=function(t){return a.NetManager.getGameProtocol().ROTATION_STATE&&(t=1==t?4:2==t?3:3==t?2:1),t},e.prototype.getSeatIdByPlayerID=function(t){return this.userseat_byplayer[t]},e.prototype.addPlayerInfo=function(t,e){var o=r.default.getSubStringLengTxt(t.username)||r.default.getReplaceStrToStar(t.player_id);t.username=o;var n=cc.instantiate(this.usernode_item);n.getComponent("BYUserNode").initSelfMsg(t,e),this.userinfo_nodelist[e-1].addChild(n),this.userseat_byplayer[t.player_id]=e},e.prototype.updateUserInfo=function(t,e){var o=this.getTrueSeatId(t),n=this.userinfo_nodelist[o-1].getChildByName("userinfo");n&&(n.getChildByName("gold").getComponent(cc.Label).string=e)},e.prototype.changeCannonLevel=function(t){this.userbattery_js[t.seat_id-1].updateOtherData(t)},e.prototype.removePlayer=function(t){this.node.getChildByName("wait"+t).active=!0,this.player_nodelist[t-1].removeAllChildren();var e=this.getTrueSeatId(t);this.userinfo_nodelist[e-1].removeAllChildren(),this.BYBulletMgr.setOhterBulletCollior(t,0),this.otherStopShotBullet(t)},e.prototype.removeAllPlayer=function(){this.touch_angle="0",this.touch_pos=cc.v2(0,0);for(var t=1;t<=4;t++)this.node.getChildByName("wait"+t).active=!0;this.player_nodelist.forEach(function(t,e){t.removeAllChildren()}),this.userinfo_nodelist.forEach(function(t,e){t.removeAllChildren()})},e.prototype.changeCannonRotation=function(t,e){this.userbattery_js[e-1]&&this.userbattery_js[e-1].updateCannonAngle(t)},e.prototype.getSelfPlayerBySeatID=function(){return this.player_nodelist[this.my_Seatid]},e.prototype.getOtherPlayerBySeatID=function(t){return this.player_nodelist[t-1]},e.prototype.getLocalPosBySeatID=function(t){return void 0===t&&(t=this.my_Seatid+1),this.node.getChildByName("wait"+t)},e.prototype.onDestroy=function(){var t=this;this.stopShotBullet(),this.unscheduleAllCallbacks(),this.unschedule(this.interValAuto),this.interVal=null,this.otherInterVal.forEach(function(e,o){t.otherStopShotBullet(o)}),this.interValAuto=null,this.can_bullet=!1},i([p(cc.Node)],e.prototype,"node_UI",void 0),i([p(cc.Node)],e.prototype,"touch_layer",void 0),i([p(cc.Node)],e.prototype,"player_nodelist",void 0),i([p(cc.Node)],e.prototype,"userinfo_nodelist",void 0),i([p(cc.Prefab)],e.prototype,"battery_item",void 0),i([p(cc.Prefab)],e.prototype,"usernode_item",void 0),i([p(c.default)],e.prototype,"BYBulletMgr",void 0),i([p(cc.Prefab)],e.prototype,"dot_item",void 0),i([p(cc.Prefab)],e.prototype,"get_item",void 0),e=i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"./BYBulletMgr":"BYBulletMgr"}],BYPool:[function(t,e,o){"use strict";cc._RF.push(e,"ca9adKl2FpLF5Y2bL+Jn2eq","BYPool");var n=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../manager/ResManager"),a=t("../../../manager/NetManager"),l=cc._decorator,c=l.ccclass,h=(l.property,function(){function t(){this.pool_fish={},this.pool_bullet={},this.pool_bool=[],this.pool_txt=[],this.pool_gold=[],this.pool_goldboom=[]}var e;return e=t,t.prototype.putFish=function(t,e){this.pool_fish[t]||(this.pool_fish[t]=[]),0!=e.opacity?(e.opacity=0,this.pool_fish[t].push(e)):console.log("fish\u5df2\u7ecf\u88ab\u56de\u6536")},t.prototype.getFish=function(t){return this.pool_fish[t]||(this.pool_fish[t]=[]),this.pool_fish[t].pop()},t.prototype.putBullet=function(t,e){this.pool_bullet[t]||(this.pool_bullet[t]=[]),0!=e.opacity?(e.opacity=0,this.pool_bullet[t].push(e)):console.log("bullet\u5df2\u7ecf\u88ab\u56de\u6536")},t.prototype.getBullet=function(t){return this.pool_bullet[t]||(this.pool_bullet[t]=[]),this.pool_bullet[t].pop()},t.prototype.putBoomAct=function(t){this.pool_bool||(this.pool_bool=[]),0!=t.opacity?(t.opacity=0,this.pool_bool.push(t)):console.log("boom\u5df2\u7ecf\u88ab\u56de\u6536")},t.prototype.getBoomAct=function(){return this.pool_bool||(this.pool_bool=[]),this.pool_bool.pop()},t.prototype.putGoldTxt=function(t){this.pool_txt||(this.pool_txt=[]),0!=t.opacity?(t.opacity=0,this.pool_txt.push(t)):console.log("txt\u5df2\u7ecf\u88ab\u56de\u6536")},t.prototype.getGoldTxt=function(){return this.pool_txt||(this.pool_txt=[]),this.pool_txt.pop()},t.prototype.putGold=function(t){this.pool_gold||(this.pool_gold=[]),0!=t.opacity?(t.opacity=0,this.pool_gold.push(t)):console.log("gold\u5df2\u7ecf\u88ab\u56de\u6536")},t.prototype.getGold=function(){return this.pool_gold||(this.pool_gold=[]),this.pool_gold.pop()},t.prototype.putGoldBoom=function(t){this.pool_goldboom||(this.pool_goldboom=[]),0!=t.opacity?(t.opacity=0,this.pool_goldboom.push(t)):console.log("gold\u5df2\u7ecf\u88ab\u56de\u6536")},t.prototype.gutGoldBoom=function(){return this.pool_goldboom||(this.pool_goldboom=[]),this.pool_goldboom.pop()},t.prototype.playBoom=function(t,e,o){return i(this,void 0,void 0,function(){var n,i,l,c,h,u=this;return r(this,function(r){switch(r.label){case 0:return n=this.getBoomAct(),i=null,void 0!=n&&cc.isValid(n)?(console.log("\u8001\u7206\u70b8"),i=n.getComponent(sp.Skeleton),n.opacity=255,[3,3]):[3,1];case 1:return console.log("\u65b0\u7206\u70b8"),l="attack/bao"+e+"/bz"+e,[4,s.ResManager.loadResAsync("game/by/effect/"+l,sp.SkeletonData)];case 2:if(void 0==(c=r.sent()))return[2];(n=new cc.Node).addComponent(sp.Skeleton),(i=n.getComponent(sp.Skeleton)).skeletonData=c,r.label=3;case 3:return h=a.NetManager.getGameProtocol().INSTER_DATA[t],n.x=h[0].x,n.y=h[0].y,n.scale=1/o.scale,n.zIndex=99,n.parent=o,i.loop=!1,i.animation="animation",i.premultipliedAlpha=!1,i.enableBatch=!0,i.setCompleteListener(function(){u.putBoomAct(n)}),[2]}})})},t.prototype.flutterScore=function(t,e,o,n){return i(this,void 0,void 0,function(){var i,l,c,h,u,p,d,f=this;return r(this,function(r){switch(r.label){case 0:return i=this.getGoldTxt(),l=null,void 0!=i&&cc.isValid(i)?(console.log("\u8001\u6587\u5b57"),l=i.getComponent(cc.Label),i.opacity=255,[3,3]):[3,1];case 1:return console.log("\u65b0\u6587\u5b57"),[4,s.ResManager.loadResAsync("game/by/font/common_yelfnt",cc.BitmapFont)];case 2:c=r.sent(),(i=new cc.Node).addComponent(cc.Label),(l=i.getComponent(cc.Label)).font=c,r.label=3;case 3:return i.position=n,a.NetManager.getGameProtocol().ROTATION_STATE&&(i.angle=180,o.y=-o.y),h="+",u=Math.abs(e),l.string=h+parseFloat(u+"").toFixed(2),p=cc.moveBy(.5,o),d=cc.sequence(p,cc.delayTime(.5),cc.callFunc(function(){f.putGoldTxt(i)})),i.runAction(d),i.zIndex=2,i.parent=t,[2]}})})},t.instance=new e,t=e=n([c],t)}());o.BYPool=h.instance,cc._RF.pop()},{"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0}],BYRightPanel:[function(t,e,o){"use strict";cc._RF.push(e,"f32109X6qFFW7k50oHG34Hj","BYRightPanel");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/utils/Utils"),s=cc._decorator,a=s.ccclass,l=s.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn_lock=null,e.btn_auto=null,e.GameView=null,e.auto_shot=!1,e}return n(e,t),e.prototype.onLoad=function(){this.initView()},e.prototype.initView=function(){this.addEvenListener()},e.prototype.addEvenListener=function(){r.default.addClickEventEND(this.btn_lock,this.onEvenClickButton.bind(this)),r.default.addClickEventEND(this.btn_auto,this.onEvenClickButton.bind(this))},e.prototype.onEvenClickButton=function(t){var e=t.name;"btn_lock"==e?(this.GameView.lock_shot=!this.GameView.lock_shot,this.auto_shot=!1,this.lockClick(this.GameView.lock_shot),this.autoClick(this.auto_shot),this.GameView.BYPlayers.cancelSkill(!0)):"btn_auto"==e&&(this.auto_shot=!this.auto_shot,this.GameView.lock_shot=!1,this.lockClick(this.GameView.lock_shot),this.autoClick(this.auto_shot),this.GameView.BYPlayers.cancelSkill(!0))},e.prototype.lockClick=function(t){this.GameView.lock_shot=t;var e=this.btn_lock.getChildByName("light");this.GameView.lock_shot?(e.active=!0,e.runAction(cc.repeatForever(cc.rotateBy(.5,180)))):(e.active=!1,e.stopAllActions()),this.GameView.setFishClick()},e.prototype.autoClick=function(t){this.GameView.auto_shot=t,this.auto_shot=t;var e=this.btn_auto.getChildByName("light");this.auto_shot?(e.active=!0,e.runAction(cc.repeatForever(cc.rotateBy(.5,180))),this.GameView.BYPlayers.autoShotBullet()):(e.active=!1,e.stopAllActions(),this.GameView.BYPlayers.stopShotBullet())},i([l(cc.Node)],e.prototype,"btn_lock",void 0),i([l(cc.Node)],e.prototype,"btn_auto",void 0),e=i([a],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../common/utils/Utils":void 0}],BYRoomView:[function(t,e,o){"use strict";cc._RF.push(e,"20379hBl6tNwphOetHh4ZQJ","BYRoomView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../view/RoomView"),s=t("../../../view/common/componet/ButtonEx"),a=t("../../../manager/EventManager"),l=t("../protocol/BYCmd"),c=t("../../../manager/UIManager"),h=t("../../../manager/NetManager"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ScrollView=null,e}return n(e,t),e.prototype.initEvent=function(){t.prototype.initEvent.call(this),a.EventManager.on(this,l.ProtocolBYCmd.GetBYGameInofRep,this.onGetMFWZGameInofRep.bind(this))},e.prototype.scrollLeft=function(){var t=this.node_top.getChildByName("tips_left"),e=this.node_top.getChildByName("tips_right");t.active=!1,e.active=!0},e.prototype.scrollRight=function(){var t=this.node_top.getChildByName("tips_left"),e=this.node_top.getChildByName("tips_right");t.active=!0,e.active=!1},e.prototype.onClickSet=function(){c.UIManager.popup("game/by/prefab/BYSetting")},e.prototype.onClickHelp=function(){h.NetManager.protocolHall.sendGetMFWZGameInof(28)},e.prototype.onGetGameRecordDetailResp=function(t){c.UIManager.popup("game/by/prefab/BYGameRecord",t)},e.prototype.showRoomList=function(t){this.getItem("label_title").string=t.game_info.game_name;var e=this.ScrollView.content;e.children.forEach(function(t){t.active=!1});for(var o=t.game_room_lists.length,n=0;n<o;n++){var i=t.game_room_lists[n],r=(Math.floor(n/6),e.children[(t.game_room_lists[n].room_level-1)%6]);if(!r)break;r.opacity=255,r.active=!0;var a=r.getChildByName("pot_num").getComponent(cc.Label);i.bet_limit.length>0?a.string=i.bet_limit[0]+"-"+i.bet_limit[1]:12==this.data?a.string="\u5927\u76f2\u6ce8: "+i.room_base_note:a.string=""+i.room_base_note,r.getChildByName("permit_num").getComponent(cc.Label).string=""+i.room_min_entrance,r.getComponent(s.default).disabledScale(),r.getComponent(s.default).registerClick(this.onChooseGameRoom.bind(this,i))}o>4&&(this.ScrollView.horizontal=!0)},e.prototype.onGetMFWZGameInofRep=function(t){t.monster_times.sort(function(t,e){return Number(t.times)-Number(e.times)});var e=t.monster_times;console.log("\u83b7\u53d6\u5230\u6355\u9c7c\u7684\u4fe1\u606f\u662f\uff1a",e),c.UIManager.popup("game/by/prefab/BYRuleView",e)},i([d(cc.ScrollView)],e.prototype,"ScrollView",void 0),e=i([p],e)}(r.default);o.default=f,cc._RF.pop()},{"../../../manager/EventManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../../view/RoomView":void 0,"../../../view/common/componet/ButtonEx":void 0,"../protocol/BYCmd":"BYCmd"}],BYRuleView:[function(t,e,o){"use strict";cc._RF.push(e,"9a639a8J5VEaqU0/oW6AeGY","BYRuleView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../view/base/PopupView"),l=t("../../../common/utils/Utils"),c=t("../../../manager/ResManager"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn_close=null,e.btn_monsterdetail=null,e.btn_gamerule=null,e.btn_resultrule=null,e.btn_sysrule=null,e.context_node=[],e.select_sp=[],e.normal_txtsp=[],e.select_txtsp=[],e.ScrollView=null,e.monster_item=null,e.idcard=null,e.frameSp=null,e.frameSp1=null,e.SCENE_TYPE=3,e}return n(e,t),e.prototype.initComponent=function(){l.default.addClickEventEND(this.btn_close,this.onTouchClickEvent.bind(this)),l.default.addClickEventEND(this.btn_monsterdetail,this.onTouchClickEvent.bind(this)),l.default.addClickEventEND(this.btn_gamerule,this.onTouchClickEvent.bind(this)),l.default.addClickEventEND(this.btn_resultrule,this.onTouchClickEvent.bind(this)),l.default.addClickEventEND(this.btn_sysrule,this.onTouchClickEvent.bind(this))},e.prototype.initData=function(t){return r(this,void 0,void 0,function(){var e,o,n,i,r,a,l,h,u;return s(this,function(s){switch(s.label){case 0:return e=this,[4,c.ResManager.loadResAsync("game/by/res/help/buyu_btn_bangzhu",cc.SpriteFrame)];case 1:e.frameSp1=s.sent(),(o=cc.find("view/content",this.ScrollView)).removeAllChildren(),n=0,s.label=2;case 2:return n<t.length?(i=cc.instantiate(this.monster_item),void 0==t[n].fish_types&&(t[n].fish_types=t[n].fish_type),[4,c.ResManager.loadResAsync("game/by/res/help/buyu_img_fish"+t[n].fish_types,cc.SpriteFrame)]):[3,8];case 3:return r=s.sent(),a=i.getChildByName("fish"),l=i.getChildByName("times"),h=i.getChildByName("name"),a.getComponent(cc.Sprite).spriteFrame=r,0!=t[n].times?[3,5]:[4,c.ResManager.loadResAsync("game/by/res/help/fish_txt_"+t[n].fish_types,cc.SpriteFrame)];case 4:return u=s.sent(),h.getComponent(cc.Sprite).spriteFrame=u,l.active=!1,h.active=!0,[3,6];case 5:l.active=!0,h.active=!1,l.getComponent(cc.Label).string=t[n].times,s.label=6;case 6:o.addChild(i),s.label=7;case 7:return n++,[3,2];case 8:return[2]}})})},e.prototype.onTouchClickEvent=function(t){var e=t.name;"btn_monsterdetail"==e?this.selectFrame(0):"btn_gamerule"==e?this.selectFrame(1):"btn_resultrule"==e?this.selectFrame(2):"btn_sysrule"==e?this.selectFrame(3):"btn_close"==e&&this.node.destroy()},e.prototype.selectFrame=function(t){this.btn_monsterdetail.getComponent(cc.Sprite).spriteFrame=this.frameSp,this.btn_gamerule.getComponent(cc.Sprite).spriteFrame=this.frameSp,this.btn_resultrule.getComponent(cc.Sprite).spriteFrame=this.frameSp,this.btn_sysrule.getComponent(cc.Sprite).spriteFrame=this.frameSp,0==t?this.btn_monsterdetail.getComponent(cc.Sprite).spriteFrame=this.frameSp1:1==t?this.btn_gamerule.getComponent(cc.Sprite).spriteFrame=this.frameSp1:2==t?this.btn_resultrule.getComponent(cc.Sprite).spriteFrame=this.frameSp1:3==t&&(this.btn_sysrule.getComponent(cc.Sprite).spriteFrame=this.frameSp1);for(var e=0;e<4;e++)e==t?(this.context_node[t].active=!0,this.select_sp[t].spriteFrame=this.select_txtsp[t]):(this.context_node[e].active=!1,this.select_sp[e].spriteFrame=this.normal_txtsp[e])},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([p(cc.Node)],e.prototype,"btn_close",void 0),i([p(cc.Node)],e.prototype,"btn_monsterdetail",void 0),i([p(cc.Node)],e.prototype,"btn_gamerule",void 0),i([p(cc.Node)],e.prototype,"btn_resultrule",void 0),i([p(cc.Node)],e.prototype,"btn_sysrule",void 0),i([p(cc.Node)],e.prototype,"context_node",void 0),i([p(cc.Sprite)],e.prototype,"select_sp",void 0),i([p(cc.SpriteFrame)],e.prototype,"normal_txtsp",void 0),i([p(cc.SpriteFrame)],e.prototype,"select_txtsp",void 0),i([p(cc.Node)],e.prototype,"ScrollView",void 0),i([p(cc.Prefab)],e.prototype,"monster_item",void 0),e=i([u],e)}(a.default);o.default=d,cc._RF.pop()},{"../../../common/utils/Utils":void 0,"../../../manager/ResManager":void 0,"../../../view/base/PopupView":void 0}],BYSpecialGet:[function(t,e,o){"use strict";cc._RF.push(e,"5777bv8KZ1M1KNZJ/SumpdO","BYSpecialGet");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../manager/ResManager"),l=cc._decorator,c=l.ccclass,h=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipsSp=null,e.yel_bmfont=null,e.black_bmfont=null,e.gold_num=null,e.tipsSpList=[],e.fish_img=null,e.ani_name=["newAnimation","newAnimation","animation"],e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.initTipsSkin=function(t,e,o,n){return r(this,void 0,void 0,function(){var i,r,l=this;return s(this,function(s){switch(s.label){case 0:return this.node.stopAllActions(),this.node.y=165,0==t&&(this.node.y=this.node.y-30),this.node.active=!0,[4,a.ResManager.loadResAsync("game/by/res/fish"+e,cc.SpriteFrame)];case 1:return i=s.sent(),this.fish_img.spriteFrame=i,this.fish_img.node.active=!0,this.tipsSp.node.active=!0,this.tipsSp.clearTracks(),this.tipsSp.setToSetupPose(),this.tipsSp.skeletonData=this.tipsSpList[t],this.tipsSp.animation=this.ani_name[t],r=this.tipsSp,r.setAnimation(0,this.ani_name[t],!1)&&r.setCompleteListener(function(t,e){l.node.active=!1}),this.gold_num.node.active=!0,this.gold_num.font=n?this.yel_bmfont:this.black_bmfont,this.gold_num.string="+"+o,this.node.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){l.setState(!1)}))),[2]}})})},e.prototype.PrefixInteger=function(t,e){return(Array(e).join("0")+t).slice(-e)},e.prototype.setState=function(t){this.node.active=t},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([h(sp.Skeleton)],e.prototype,"tipsSp",void 0),i([h(cc.Font)],e.prototype,"yel_bmfont",void 0),i([h(cc.Font)],e.prototype,"black_bmfont",void 0),i([h(cc.Label)],e.prototype,"gold_num",void 0),i([h(sp.SkeletonData)],e.prototype,"tipsSpList",void 0),i([h(cc.Sprite)],e.prototype,"fish_img",void 0),e=i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../manager/ResManager":void 0}],BYSpecialTips:[function(t,e,o){"use strict";cc._RF.push(e,"ca0b0o+AcdOMJclrf5gWiYu","BYSpecialTips");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):new o(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../manager/ResManager"),l=t("../../../manager/NetManager"),c=t("./BYPool"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipsSp=null,e.killboss_item=null,e.bg_node=null,e.fihs_node=null,e.turntable_pre=null,e.ani_name=["","animation","animation","newAnimation","hailang","animation"],e.path_name=["","zhakai","bingdong","yuchaolaixi","hailang"],e.killboss_ts=null,e.killfish_gold=null,e}return n(e,t),e.prototype.onLoad=function(){this.killfish_gold=this.fihs_node.getChildByName("fishui_node").getChildByName("fish_gold")},e.prototype.initTipsSkin=function(t){return r(this,void 0,void 0,function(){var e,o,n,i,r=this;return s(this,function(s){switch(s.label){case 0:return e=!1,o=.4,3==t?(e=!0,o=2):4==t&&(o=2),[4,a.ResManager.loadResAsync("game/by/effect/game/"+this.path_name[t],sp.SkeletonData)];case 1:return void 0==(n=s.sent())||null==this.tipsSp?[2]:(this.tipsSp.node.active=!0,this.tipsSp.clearTracks(),this.tipsSp.setToSetupPose(),this.tipsSp.skeletonData=n,this.tipsSp.animation=this.ani_name[t],this.tipsSp.timeScale=o,i=this.tipsSp,i.setAnimation(0,this.ani_name[t],!1)&&i.setCompleteListener(function(o,n){i.node.active=!1,e&&r.initTipsSkin(t+1)}),[2])}})})},e.prototype.addTurntable=function(t){var e=cc.instantiate(this.turntable_pre);e.getComponent("BYTurntable").initresult(t,this.playTurntableResult.bind(this)),this.node.addChild(e,99)},e.prototype.playTurntableResult=function(t){return r(this,void 0,void 0,function(){var e,o,n,i,r=this;return s(this,function(s){switch(s.label){case 0:return(e=this.node.getChildByName("fanbeizhuanpX"))&&(e.stopAllActions(),e.active=!1,e.removeFromParent()),[4,a.ResManager.loadResAsync("game/by/effect/game/fanbeizhuanp",sp.SkeletonData)];case 1:return void 0==(o=s.sent())?[2]:((n=new cc.Node).addComponent(sp.Skeleton),(i=n.getComponent(sp.Skeleton)).skeletonData=o,this.node.addChild(n,0,"fanbeizhuanpX"),i.loop=!1,i.animation="fanbeizhuanpX"+t.tag+"_1",i.premultipliedAlpha=!1,i.enableBatch=!0,i.setCompleteListener(function(){n.active=!1,n.removeFromParent(),r.addKillBoss(t.fishtype,t.gold,t.state)}),[2])}})})},e.prototype.addKillBoss=function(t,e,o){var n=this;if(null==this.killboss_ts){var i=cc.instantiate(this.killboss_item);this.killboss_ts=i.getComponent("BYKillBossTips"),this.killboss_ts.setState(!1),this.node.addChild(i),this.killboss_ts.initTipsSkin(t,e,o)}else this.killboss_ts.initTipsSkin(t,e,o);this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){n.killboss_ts.setState(!1)})))},e.prototype.playBigBoom=function(t,e,o,n,i){return void 0===e&&(e=cc.v2(0,0)),void 0===o&&(o=0),void 0===n&&(n=null),void 0===i&&(i=!1),r(this,void 0,void 0,function(){var r,h,u,p=this;return s(this,function(s){switch(s.label){case 0:return r=c.BYPool.gutGoldBoom(),h=null,void 0!=r&&cc.isValid(r)?(r.opacity=255,h=r.getComponent(sp.Skeleton),console.log("\u8001\u91d1\u5e01\u7206\u70b8"),[3,3]):[3,1];case 1:return console.log("\u65b0\u91d1\u6bd4\u7206\u70b8"),[4,a.ResManager.loadResAsync("game/by/effect/game/jinbibengchu",sp.SkeletonData)];case 2:if(void 0==(u=s.sent()))return[2];(r=new cc.Node).addComponent(sp.Skeleton),(h=r.getComponent(sp.Skeleton)).skeletonData=u,this.node.addChild(r),s.label=3;case 3:return l.NetManager.getGameProtocol().ROTATION_STATE?(r.x=-e.x,r.y=-e.y):r.position=e,h.loop=!1,h.animation="animation",h.premultipliedAlpha=!1,h.enableBatch=!0,h.setCompleteListener(function(){c.BYPool.putGoldBoom(r),t&&p.addKillBoss(o,n,i)}),[2]}})})},e.prototype.shockEffect=function(){this.bg_node.stopAllActions(),this.fihs_node.stopAllActions(),this.bg_node.position=cc.v2(0,0),this.fihs_node.position=cc.v2(0,0);var t=cc.repeat(cc.sequence(cc.moveBy(.02,cc.v2(12,12)),cc.moveBy(.04,cc.v2(-24,-24)),cc.moveBy(.02,cc.v2(12,12))),2),e=cc.repeat(cc.sequence(cc.moveBy(.02,cc.v2(-12,-12)),cc.moveBy(.04,cc.v2(24,24)),cc.moveBy(.02,cc.v2(-12,-12))),2);this.bg_node.runAction(e),this.fihs_node.runAction(t)},e.prototype.playMonsterActs=function(t,e,o){t.stopAllActions(),this.flutterScore(e,cc.v2(0,100),o)},e.prototype.flutterScore=function(t,e,o){return r(this,void 0,void 0,function(){return s(this,function(n){return c.BYPool.flutterScore(this.killfish_gold,t,e,o),[2]})})},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([p(sp.Skeleton)],e.prototype,"tipsSp",void 0),i([p(cc.Prefab)],e.prototype,"killboss_item",void 0),i([p(cc.Node)],e.prototype,"bg_node",void 0),i([p(cc.Node)],e.prototype,"fihs_node",void 0),i([p(cc.Prefab)],e.prototype,"turntable_pre",void 0),e=i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../manager/NetManager":void 0,"../../../manager/ResManager":void 0,"./BYPool":"BYPool"}],BYTopPanel:[function(t,e,o){"use strict";cc._RF.push(e,"7b5444aVG5AjbuCznXsg+DN","BYTopPanel");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,a=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.table_num=null,e}return n(e,t),e.prototype.onLoad=function(){this.initView()},e.prototype.initView=function(){this.table_num.string=""},e.prototype.setRoomInfo=function(t){this.table_num.string=t||""},i([a(cc.Label)],e.prototype,"table_num",void 0),e=i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BYTurntable:[function(t,e,o){"use strict";cc._RF.push(e,"0c11elIOGhFupIe6LUuI09A","BYTurntable");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../common/utils/Utils"),s=cc._decorator,a=s.ccclass,l=s.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.start_btn=null,e.turntable_sp=null,e.light_sp=null,e.time_label=null,e.start_time=5,e.resulttag={tag:0,fishtype:0,gold:0,state:!0},e.callfunc=null,e.onlyonce=!0,e}return n(e,t),e.prototype.onLoad=function(){this.addEvenListener()},e.prototype.addEvenListener=function(){r.default.addClickEventEND(this.start_btn,this.onEvenClickButton.bind(this))},e.prototype.initresult=function(t,e){this.resulttag=t,this.callfunc=e,this.time_label.string=this.start_time+"s",this.schedule(this.updateTimes.bind(this),1)},e.prototype.updateTimes=function(){this.start_time=this.start_time-1,this.start_time<=0&&(this.time_label.node.active=!1,this.onEvenClickButton("",""),this.updateTimes&&this.unschedule(this.updateTimes)),this.time_label.string=this.start_time+"s"},e.prototype.onEvenClickButton=function(t,e){var o,n=this;if(this.time_label.node.active=!1,this.onlyonce){this.onlyonce=!this.onlyonce;var i=((o={})[2]=0,o[4]=240,o[6]=120,o[10]=300,o[20]=180,o[30]=60,o),r=Number(this.resulttag.tag),s=cc.rotateBy(1.5,1440),a=cc.rotateBy(1,720),l=cc.rotateBy(1,360+i[r]);this.turntable_sp.runAction(cc.sequence(s,a,l,cc.callFunc(function(){n.light_sp.active=!0}),cc.delayTime(.5),cc.callFunc(function(){n.callfunc(n.resulttag),n.node.destroy()})))}},i([l(cc.Node)],e.prototype,"start_btn",void 0),i([l(cc.Node)],e.prototype,"turntable_sp",void 0),i([l(cc.Node)],e.prototype,"light_sp",void 0),i([l(cc.Label)],e.prototype,"time_label",void 0),e=i([a],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../../common/utils/Utils":void 0}],BYUserNode:[function(t,e,o){"use strict";cc._RF.push(e,"808edY0Vg1F8aFYc9lLBFbY","BYUserNode");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,a=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.user_name=null,e.user_gold=null,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.initOtherMsg=function(t){},e.prototype.initSelfMsg=function(t,e){this.user_gold.string=parseFloat(t.gold).toFixed(2),this.user_name.string=t.username},e.prototype.updateUserInfo=function(t){this.user_gold.string=parseFloat(t).toFixed(2)},e.prototype.hideSelfGold=function(){},e.prototype.onDestroy=function(){this.unscheduleAllCallbacks()},i([a(cc.Label)],e.prototype,"user_name",void 0),i([a(cc.Label)],e.prototype,"user_gold",void 0),e=i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],ProtocolBY:[function(t,e,o){"use strict";cc._RF.push(e,"8e324o0U1tNSZfHSmrDSzuX","ProtocolBY");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../manager/DataManager"),r=t("../../../net/ProtocolBase"),s=t("../../../manager/NetManager"),a=t("../../../manager/UIManager"),l=t("../../../Define"),c=t("./BYCmd"),h=function(t){function e(){var e=t.call(this,"game/by/pb")||this;return e.cmd=c.BYCmd,e.type=l.SocketType.Game,e.pbName="BY",e.MY_SEATID=0,e.MY_bullet=0,e.MY_bullet_send=0,e.MY_bullet_disp=0,e.GAME_ROOM_LIMITE=0,e.INSTER_DATA=[],e.ROTATION_STATE=!1,e.BULLET_LEVEL_LIST=[],e.BULLET_CUR_LEVEL=0,e.FISH_TIMES=[],e}return n(e,t),e.prototype.sendCreateBulletReq=function(t,e,o,n){if(!this.boolOut()){var r={player_id:i.DataManager.userInfo.userid,theBullet:t,lock_shot:e,fish_id:o,is_return:n};console.log("============>\u53d1\u9001\u521b\u5efa\u5b50\u5f39\u8bf7\u6c42"),this.send(r,"game_bullet_create_req")}},e.prototype.sendDisappearBulletReq=function(t){if(!this.boolOut()){var e={player_id:i.DataManager.userInfo.userid,bullet_id:t};console.log("============>\u5b50\u5f39\u6d88\u5931\u8bf7\u6c42"),this.send(e,"game_bullet_disappear_req")}},e.prototype.sendBulletAttackReq=function(t,e,o){if(void 0===o&&(o=!0),!this.boolOut()){var n={player_id:i.DataManager.userInfo.userid,bullet_id:t,fish_id:e,is_my_bullet:o};console.log("============>\u5b50\u5f39\u51fb\u4e2d\u8bf7\u6c42"),this.send(n,"game_bullet_attack_req")}},e.prototype.sendBulletChangeReq=function(t){if(!this.boolOut()){var e={player_id:i.DataManager.userInfo.userid,level:t};console.log("============>\u5b50\u5f39\u5207\u6362"),this.send(e,"game_bullet_change_req")}},e.prototype.boolOut=function(){return!i.DataManager.userInfo||!i.DataManager.userInfo.userid},e.prototype.dealError=function(t){a.UIManager.showTipsPopup(t.err_msg)},e}(r.default);o.default=h,s.NetManager.protocolCache.ProtocolBY=h,cc._RF.pop()},{"../../../Define":void 0,"../../../manager/DataManager":void 0,"../../../manager/NetManager":void 0,"../../../manager/UIManager":void 0,"../../../net/ProtocolBase":void 0,"./BYCmd":"BYCmd"}]},{},["BYCmd","BYDefine","ProtocolBY","BYBattery","BYBullet","BYBulletMgr","BYFish","BYFishMgr","BYGameScene","BYGameView","BYGoldAni","BYKillBossTips","BYLeftPanel","BYPlayers","BYPool","BYRightPanel","BYRoomView","BYRuleView","BYSpecialGet","BYSpecialTips","BYTopPanel","BYTurntable","BYUserNode"]);